- [自动驾驶之高精度地图（四）为什么自动驾驶离不开高精度地图 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/369228078)

首先咱们来看看自动驾驶的主要技术分为三大类，分别是感知层，决策层，控制层。



![img](https://pic2.zhimg.com/80/v2-c725476f3966c9f8d6fddb19696de395_720w.jpg)

如上图可以看到高精度技术位于感知层和决策层，为自动驾驶系统提供底层支持，自动驾驶是一个庞大而复杂的技术体系，类比于人类驾驶行为。

人的感知就是通过眼睛和耳朵；

自动驾驶感知层：主要由激光雷达、 摄像头、高精度地图、IMU/GPS等部分构成，主要负责搜集车身周边信息；

人的决策层就是通过对比记忆做出决策，比如是方向盘控制，加减速、变道、刹车等等；

自动驾驶决策层：以感知信息数据为基础，根高算力的计中心获取经过优化的驾驶决策；

执行层：基于决策层给出的驾驶决策，对制动系统、发机转向等控下达指令，负责驾驶执行；

高精度定位涉及感知层和决策层，为自动驾驶汽车提供车辆的空间坐标和当前场景下的相对位置坐标，以及位置相关信息，包括速度、加速度、车辆姿态、航向角等。向上延伸，高精度定位涉及车辆速度控制、路径规划、障碍物检测与避让、车辆行为决策等决策层与控制层内容。

## 1 ADAS自动驾驶对于地图的精度要求

自动驾驶常常提到定位精度问题，很多厂商对外宣称的定位精度基本上差不多，很多人士在还没有进入汽车行业领域，反正就希望自动驾驶是非常安全，整车被动安全非常安全，这个具体指标就不太清楚，反正能做到极限最好。

而汽车开发呢，需要兼顾成本与安全一起的，就好比造汽车不能都用装甲车的这么厚钢板去造车，这样虽然被动安全做的非常牛掰，但是无论是价格、油耗、加速度都不能做好，消费者体验不好，就不会买单，如果我们都去做的那么多安全都是毫无意义的，如同下面这些产品：

一架永不起降的飞机；

一列永不出站的火车；

一辆永不发动的汽车；

一台永不运行的X光机

所以目前做自动驾驶的，都会涉及到功能安全，以功能安全的指标为依据，制定合理的安全措施，达到这个指标之内就可以运行。最近发现ford汽车的一篇文章通过统计学推导的方式，得出了结论，参考论文是“Localization Requirements for Autonomous Vehicles”。具体的文章连接可以看：

[基于功能安全的车道级定位精度分析](https://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s%3F__biz%3DMzU5ODQ5ODQ1Mw%3D%3D%26mid%3D2247519309%26idx%3D5%26sn%3Dd6b9825a9134c9074ecbfbfe90cdef87%26scene%3D21%23wechat_redirect)

对于L3级别以上的自动驾驶的定位误差是0.39米，则对应的误差0.39米。这个数值要求对于现代GNSS来说，只要提供PPP，RTK纠偏服务，绝大多数都能满足，并且置信度很高。同理，对于高精度地图，0.39米的误差，大部分公司也能满足。

我们就从简单的实际驾驶场景来看，一般情况下驾驶车辆距离道路一侧路牙的安全距离是25cm，假设自动驾驶汽车最高时速为90km/h，行驶25cm距离用时0.01s，对应的频率就是100HZ，因此我们就用最简单的实际驾驶环境来看，如果要支持自动驾驶汽车的高精度技术，应该要≤25cm的精度，定位信息更新频率在100HZ及以上，才能有效确保自动驾驶车辆的行驶安全。

我们还是先来看看自动驾驶级别的分类

![img](https://pic4.zhimg.com/80/v2-d80627840f300a44512de073a8b2aebf_720w.jpg)

目前多数车企都可以提供L2 级别的系统。L0 级别驾驶员完全掌控车辆（hands on, eyeson）；L1 级别自动系统有时能够辅助驾驶员完成某些驾驶任务（hands on，eyes on）；L2级别自动系统能够完成某些驾驶任务，但驾驶员需要监控驾驶环境，完成剩余部分，同时保证出现问题，随时进行接管，在这个层级，自动系统的错误感知和判断有驾驶员随时纠正，大多数车企都能提供这个系统，简单来说驾驶员的手和眼可暂时离开(hands temp off,eyes temp off)。

美国的L3 级别要求略高于国内版本，L3 是自动驾驶的分水岭。L3 级别要求自动系统既能完成某些驾驶任务，也能在某些情况下监控驾驶环境，但驾驶员必须准备好重新取得驾驶控制权（自动系统发出请求时）。所以在该层级下，驾驶者仍无法进行睡觉或者深度的休息。简单来说，在L3 级别下可以放开手、放开眼，但是不能深度休息（hands off, eyesoff）。国内的自动驾驶分级标准择是在某些特定场景下，可以放开手、放开眼。

所以高精度地图在自动驾驶的路径上，基本是服务于L3以上的，自动驾驶分级从L0到L5，技术难度不断升级，从导航、ADAS这类应用，演进到有条件的自动驾驶如Autopilot，到更高级的自动驾驶如Robotaxi。不同阶段自动驾驶产品形态，对于定位的精度要求是不一样的，对于地图的要求也是不一样的。

![img](https://pic2.zhimg.com/80/v2-1c153e4d02a4c19f5237547c4896a865_720w.jpg)

通过上图可以看到，L1级别的普通电子地图就可以满足需求，定位精度也就是正常的2-5米，对于L3 及以上级别的自动驾驶，高精度地图是标配。对于L3 及以上级别的自动驾驶功能，高精度地图所能提供的实时、准确的自定位信息以及动态道路信息都是不可或缺的，这一点目前已经成为市场共识。

我们可以看到真正意义上的L2辅助驾驶，这部分对于地图的精度要求还是蛮高的，这里需要50cm-1m的精度，这部分传统地图是无法做到的，只是这个时候的高精度地图里面的信息和L3的信息要求程度不同而已，但是精度要求相对于L1已经高了10倍。

我们可以看到L3级别以上对于地图的精度要求都是10-30cm之间，同上面功能安全提到的提到的≤25cm基本上是吻合的，这个时候的地图普通地图是完全不能满足的。

## 2 高精度地图是安全冗余，降低算力

也许有的杠精会抬杠了，特斯拉图像识别这么牛掰，也可以做自动驾驶，不需要激光雷达，不需要高精度地图，依旧可以做的非常好。

虽然我也是特斯拉的铁粉，对于图像识别的能力的算法我不怀疑，但是如果没有高精度地图的话，对于软件算法能力挑战是非常大的，我举几个例子就比较容易理解。

举个例子在日本北海道，一到冬天就大雪一片白，连树都是白的，做视觉的知道一片白就是缺少纹理，目前的视觉手段大概率要吃瘪。人也不好开，但是可以开，可以通过起伏，绿化带之类的判断车道，可以跟前面的车辙，视觉怎么搞，烧香求祖师爷显灵，让自己辛辛苦苦训练的交通标志模型，正正好好的把车辙识别成车道线吗？

而且还有很多特殊情况，很多视觉在道路上都需要有车道分界线，但是在农村一些道路根本没有这些标识，如果没有前面车辆跟随，或者高精度地图定位，否则很难识别到自己车辆在哪个车道上，基本上就只能退出辅助驾驶。

我们通过看自动驾驶测评的视频，比测的一个场景就是大曲率的弯道测试，看看自动驾驶会不会退出，基本上特斯拉、小鹏、蔚来都失败率很高，在特别大曲率的弯道中尤其特斯拉失败率会更高。

![img](https://pic1.zhimg.com/80/v2-df8527ebc93803447f3b605995947518_720w.jpg)

以特斯拉 Model 3 上使用的三目摄像头为例，其中一颗为长焦摄像头，探测距离 250 米；一颗为中距离摄像头，探测距离 150 米；一颗广角摄像头，探测距离 60 米，但是探测角度达到了 120 度。【参考1】

![img](https://pic4.zhimg.com/80/v2-d1a7e146186c05abb94a2b89987a4973_720w.jpg)





而只有一颗摄像头的车型，这颗摄像头只能是兼顾探测距离和探测角度的中距离摄像头。

但是在通过一些曲率较大的弯道时，这颗摄像头的探测能力就比较吃力了，有限的探测角度导致探测范围相对局限，想要通过大曲率弯道，则需要系统对盲区中的车道线有一定的预测能力，根据实时探测到的信息，不断调整预测线路。

反映到实际表现中也是两种结果，曲率过大直接放弃，辅助驾驶退出，或者系统根据探测结果不断修正车辆行驶轨迹，导致车辆过弯时有较为明显的锯齿感。

对于有高精地图的辅助驾驶来说，这些都是已知信息。例如凯迪拉克 CT6 可以预知前方 2.5 km 道路的曲率、坡道、限速等信息，所以在通过大曲率弯道时表现会从容很多。

如果纯粹用图像是识别，需要非常大的计算能力，而且需要非常强大的云端训练，本地推理，而且需要匹配5G的传输速度快速传输，也是一条路径。

**综上所述，仅仅依靠单车感知时，辅助驾驶对车辆识别、探测能力的要求更高，但是在识别能力没有更大突破的前提下，向外部借力，带来更好的使用体验也不失为一个好办法。**

## 3 高精度地图三大功能

历经数年的技术实践，业内达成共识：仅仅依靠车辆自身传感器搜集的信息和车辆本身的处理器是难以实现并推广自动驾驶的。特斯拉在自动驾驶实验中发现，道路地面的细微突出或凹陷就能很容易造成自动驾驶系统的误判和错误反应，而包含精确道路信息的地图则可以很好的解决此类问题。国内举办的历届无人驾驶大赛中优胜选手均高度依赖比赛场地详细地图的结果也证明了，没有精确的地图信息，无人驾驶的落地难以实现。

高精度地图主要有以下三大功能：地图匹配、辅助环境感知和路径规划。高精度地图可以将车辆位置精准的定位于车道之上、帮助车辆获取更为准确有效全面的当前位置交通状况并为无人车规划制定最优路线。

**地图匹配**：由于存在各种定位误差，电子地图坐标上的移动车辆与周围地物并不能保持正确的位置关系。利用高精度地图匹配则可以将车辆位置精准的定位在车道上，从而提高车辆定位的精度。

**辅助环境感知**：这个在自动驾驶中非常非常重要，不同的传感器都有其自身的优势和劣势，例如摄像机在弱光及高对比度光线条件场景下很难捕捉足够的视觉信息；激光雷达在雾气/雨滴/雪花/汽车尾气/反射等场景下容易形成虚假点；毫米波雷达在通过隧道、大桥等场景下雷达探测可信性降低。自动驾驶因其问题复杂度高、安全第一等特性，需要依靠多种传感器数据的相互融合来提高感知效果。

![img](https://pic2.zhimg.com/80/v2-d23dd9c46a761b256dbe2afa5ef9f81d_720w.jpg)

无论是哪种传感器，在探测距离和时间上都有限制，都需要多种传感器来融合，但是不能排除面对复杂的驾驶环境，传感器都存在失效的场景，但是地图作为智能驾驶唯一的超距传感器，突破空间、时间的限制，可以说地图是通过定位实现的智能驾驶的“知识图谱”。

自动驾驶的功能安全的本质是做冗余保障，对传感器无法探测的部分进行补充，进行实时状况的监测及外部信息的反馈：传感器作为无人驾驶的眼睛，有其局限所在，如易受恶劣天气的影响，此时可以使用高精度地图来获取当前位置精准的交通状况。

**路径规划：**为了让无人驾驶车在行驶过程中能够及时、准确地对他车行为作出反应，保证行驶的舒适性与安全性，算法需要对他车的行为与路径作出相对准确的预测。对于提前规划好的最优路径，由于实时更新的交通信息，最优路径可能也在随时会发生变化，此时高精度地图在云计算的辅助下，能有效地为无人车提供最新的路况，帮助无人车重新制定最优路径。

在路径规划方面，在使用了高精度地图的车辆上有这些功能会得到优化，在用户的体验提升起到非常至关重要的作用。

• 自动切换车道

• 对行驶较慢车辆的自动超越

• 智能设定巡航车速

• 匝道的自动驶入和驶离

比如：在无人驾驶车经过一些坡道时，高精度地图里因为有坡道的信息，也能让车辆尽早做好速度规划。或者，当你要经过一个弯道时，高精度地图可提前为无人驾驶车提供弯道的曲率信息，让无人驾驶车可以规划好最适合弯道的拐弯速度。

比如：通过高精度地图查询到前方右侧有辅路入口或者车道合并的情况，那么该处出现的车辆就很有可能会作出向左变道或加速并入等动作。根据左右车道线虚实情况，也可以更好的帮无人驾驶车判断旁边车辆加塞的可能性，这个对于匝道的驶入和驾离更符合自然驾驶人的行为，而不是按照通常的做法，提前2公里就进入右边通道，但是由于右边的大货车又比较多，这样行驶速度非常慢，让人非常不爽。

但是通过高精度地图以后，综合决策可以更像一个老司机的操作，可以根据实际的车流情况，选择合适的时机进入右边通道，既不太慢，又不至于太快到路口才并入。

所以通过以上信息可以得出，L3以下可以不用高精度地图，L3+必须要用到高精度地图。

高精地图不不仅是比传统地图精度更高，而且包含信息更全面，实时性更强。