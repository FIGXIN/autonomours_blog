- [V2X 通信 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/287983846)

V2X通信分为两种，分别是基于PC5和Uu口的通信。

## 1 基于PC5的V2X通信

对于V2X通信，存在两种类型的PC5参考点：基于LTE的PC5参考点，以及基于NR的PC5参考点。根据UE支持的服务，UE可以将PC5的任一类型或两者都用于V2X通信。通过PC5参考点的V2X通信支持漫游和PLMN间操作。当UE“served by NR or E-UTRA”或当UE“not served by NR or E-UTRA”时，支持通过PC5参考点的V2X通信。

通过PC5参考点的V2X通信具有以下特点：

- 基于LTE的PC5参考点上的V2X通信是无连接的，即接入层（AS）层的广播模式，并且没有通过PC5的信令来建立连接。
- 基于NR的PC5参考点上的V2X通信支持AS层的广播模式、群播模式和单播模式。如果UE的V2X应用层指明了与V2X层的通信方式，则V2X层应根据V2X应用层的请求设置通信方式；否则，V2X层根据V2X业务类型的映射信息设置通信方式。V2X层表示V2X服务类型到AS层的通信模式。支持单播模式通信管理的PC5参考点上的控制面信令。
- V2X服务通过PC5用户平面实现UE之间的通信支持。
- PC5参考点支持基于IP和非IP的V2X服务通信。
- 对于基于IP的V2X服务通信，仅使用IPv6。不支持IPv4。
- V2X消息通过PC5用户面在UE之间交换。
- PC5参考点支持基于IP和非IP的V2X消息。
- 对于基于IP的V2X消息，仅使用IPv6。不支持IPv4。

## 2 基于PC5的广播通信模式

基于LTE的PC5参考点和基于NR的PC5参考点都支持广播通信模式。因此，当选择通过PC5参考点传输的广播模式时，需要配置执行PC5 RAT选择。

对于基于LTE的PC5参考点，广播模式是唯一支持的通信模式，其操作细节将在另一篇文章中介绍。

对于基于NR的PC5参考点，广播模式还支持增强QoS。

### 2.1 基于PC5的组播通信模式

Groupcast模式通信仅在基于NR的PC5参考点上受支持，适用于所有类型的组，即应用层无连接组和应用层管理组。

对于应用层管理组，如果V2X应用层提供了组大小和成员ID，则V2X层将它们传递给AS层以进行groupcast控制。

### 2.2 基于PC5的单播通信模式

仅在基于NR的PC5参考点上支持单播通信模式。图5.2.1.4-1说明了PC5单播链路的示例。

![img](https://pic2.zhimg.com/80/v2-88d92cca39bc550ea18aa91c5d7a5ded_720w.jpg)

Figure 5.2.1.4-1: Example of PC5 Unicast Links

当V2X通信通过PC5单播链路传输时，以下原则适用：

- 两个UE之间的PC5单播链路允许这些UE中的一对或多对对等V2X服务之间的V2X通信。UE中使用相同PC5单播链路的所有V2X服务使用相同的应用层ID。
- 一个PC5单播链路支持一个或多个V2X服务类型），前提是这些V2X服务类型至少与该PC5单播链路的对等应用层ID对相关联。例如，如图5.2.1.4-1所示，UE A和UE B具有两个PC5单播链路，一个在对等应用层ID 1/UE A和应用层ID 2/UE B之间，一个在对等应用层ID 3/UE A和应用层ID 4/UE B之间。
- PC5单播链路支持使用单个网络层协议（例如IP或非IP）的V2X通信。
- PC5单播链路支持每流QoS模型。
- 如果多个V2X服务类型使用PC5单播链路，则由PFI标识的一个PC5 QoS流可以与一个以上的V2X服务类型相关联。

当UE中的应用层需要PC5参考点上的单播通信模式的V2X服务类型发起数据传输时：

- 如果该PC5单播链路的对等应用层ID和网络层协议与UE中该V2X业务所需的对等应用层ID和网络层协议相同，则UE应重新使用现有的PC5单播链路，并按规定修改现有PC5单播链路，增加该V2X业务类型；
- UE应触发新PC5单播链路的建立。

成功建立PC5单播链路后，UE A和UE B使用同一对第2层ID进行PC5-S信令消息交换和V2X业务数据传输。发送UE的V2X层向AS层指示传输是针对PC5-S信令消息（即直接通信请求/接受、链路标识符更新请求/响应/Ack、断开请求/响应、链路修改请求/接受、保持活动/Ack）还是V2X业务数据。

对于每个PC5单播链路，UE自身分配不同的PC5链路标识符，该标识符在PC5单播链路的生存期内唯一地标识UE中的PC5单播链路。每个PC5单播链路与单播链路配置文件相关联，该单播链路配置文件包括：

1. UE A的应用层ID和层2 ID

2. UE B的应用层ID和层2 ID

3. 在PC5单播链路上使用的网络层协议；

4. 有关PC5 QoS流的信息。对于每个PC5 QoS流，PC5 QoS上下文和PC5 QoS规则。

出于隐私原因，在PC5单播链路的生存期内，应用层ID和层2 ID可以随流程发生变化，如果是这样，则应在单播链路配置文件中相应地更新。UE使用PC5链路标识符来指示到V2X应用层的PC5单播链路，因此，即使存在与一个V2X服务类型相关联的多个单播链路，V2X应用层也标识相应的PC5单播链路（例如，UE为同一V2X服务类型建立多个具有多个UE的单播链路）。

单播链路配置文件应在已建立PC5单播链路的第2层链路修改或第2层链路标识符更新后进行相应更新。

当从AS层接收到由于RLF而释放PC5-RRC连接的指示时，UE中的V2X层本地释放与该PC5-RRC连接相关联的PC5单播链路。AS层使用PC5链路标识符向V2X层指示其PC5-RRC连接被释放的PC5单播链路。

当PC5单播链路按照规定进行释放时，PC5单播链路的每个UE的V2X层通知接入层PC5单播链路已经释放。V2X层使用PC5链路标识符来指示释放的单播链路。

### 2.3 IP地址分配

对于PC5参考点上V2X通信的单播模式，可使用以下IP地址/前缀分配机制：

a） RFC 4862中指定的IPv6无状态地址自动配置，用于分配IPv6前缀，两个UE中的一个充当IPv6默认路由器。

b） rfc4862中定义的IPv6链路本地地址由UE本地形成。在通过PC5参考点建立安全的第2层链路期间交换IPv6链路本地地址。在建立第二层链路后，UE应禁用重复地址检测。

对于通过PC5参考点进行V2X通信的广播和群播模式，以下源IP地址管理适用：

UE配置链路本地IPv6地址作为源IP地址。UE可以使用该IP地址在PC5参考点上进行V2X通信，而不发送用于重复地址检测的邻区请求和邻区广播消息。

## 3 基于Uu口的V2X通信

V2X通过Uu参考点的单播通信支持非漫游和漫游操作。

对于通过Uu参考点传输V2X消息：通过正常的机制可用于建立合适的PDU会话，并且V2X消息被路由到V2X应用服务器或具有现有单播路由的UE。

PC5参考点上的V2X通信可能使用与Uu参考点上V2X通信不同的协议和格式。

可以基于PC5或Uu口的V2X服务类型进行V2X消息通信，下面是基于Uu口的V2X通信：

- 对于从应用程序传输非基于IP的V2X消息：

1. 使用IP封装（即IP PDU会话类型）或非结构化PDU会话类型。

2. UE根据网络配置，确定IP封装和非结构化PDU会话类型之间的哪种方法用于非基于IP的V2X消息。如果没有这样的配置可用，UE可以使用基于UE实现的方法。

- 当IP PDU会话类型用于传输基于IP或非基于IP的V2X消息时，V2X消息通过UDP或TCP传输：

1. 对于来自应用程序的非基于IP的V2X消息，UE可以从V2X应用服务器学习，或者UE可以被显式地配置为需要使用传输层协议或者没有配置施加的限制。

2. 对于来自应用程序的基于IP的V2X消息，UE使用上层设置的传输层协议。

- UE向V2X应用服务器地址发送V2X消息。目的地V2X应用服务器地址来自PSID或ITS-AID和UE配置，并且V2X应用服务器在V2X应用服务器地址上以UDP/IP包或TCP/IP包的形式接收V2X消息。

1. 当非结构化PDU会话类型用于传输非基于IP的V2X消息时：

2. V2X消息被传输到V2X应用服务器。

通过单播的V2X消息传输的时延可通过使用各种机制来实现，包括通过例如边缘计算、应用功能对流量路由的影响和边缘计算的支持，其中V2X应用服务器充当应用功能。