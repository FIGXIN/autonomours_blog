- [电子地平线（EHP）及ADASIS概念详解 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/368798777)

## 1、什么是电子地平线

**电子地平线（Electric Horizon）是一种为车辆提供超视距道路交通信息的产品或者服务，例如超出传感器感知范围的道路（如曲率、坡度）、车道（如车道线形状、车道属性）、红绿灯（如位置、轮廓）信息**。

超出传感器感知范围有两种情况：一是距离，例如前方2公里，二是视场角FOV以及路口、弯道等特殊场景下的遮挡与盲区。

另外需要注意的是，电子地平线不关注全局所有的道路交通信息，而需要提供与车辆行驶道路相关、会影响车辆行驶的道路交通信息，具体包括一下类型：

1）车辆当前行驶的道路；

2）与当前道路连接的道路，包括退出当前道路的道路（车辆可能驶离当前道路而进入该道路）和前方进入当前道路的道路（可能有其他车辆驶入当前道路从而造成一定影响）。

![img](https://pic4.zhimg.com/80/v2-9426306a9bb18d3b84518bb9dd52442f_720w.jpg)

![img](https://pic3.zhimg.com/80/v2-4fbafc8d97b7e70ba3e8242e63f01392_720w.jpg)

![img](https://pic1.zhimg.com/80/v2-a80de1c7d0b47b3a89dea7f02ef27238_720w.jpg)

**电子地平线更像是一种软件产品或者服务（虽然它肯定需要基础硬件支持），它最核心的就是收集和抓取车辆前方或周边的道路交通信息。**而承载这些信息最直接的载体就是地图（此处指的道路交通信息以静态信息为主，如上文提到的道路曲率、车道线形状等；也可以通过V2X的方式提供前方道路交通信息，特别是实时动态信息，日本也提出动态地图的概念，此处不作详展开），因此电子地平线往往以地图作为数据基础，在地图数据基础上，基于车辆当前位置，提取当前车辆行驶的道路以及连接道路等。

**事实上，提取出来的地图数据就是电子地平线数据。**这么来看，电子地平线是不是与地图引擎的概念非常相似。实际上，电子地平线可以理解为一种特定的地图引擎或者地图API，从地图数据中获取特定的道路及属性，然后输出到应用侧。

## 2、电子地平线的作用

了解了电子地平线的定义之后，其作用不言而喻，那就是为汽车主动安全、辅助驾驶或者自动驾驶提供必要的道路交通环境感知信息。高级驾驶辅助系统ADAS（Advanced Driver Assistance System）的诸多功能都需要依赖基于地图的电子地平线才能实现，如自主大灯调节（Adaptive Front Lighting）和弯道限速预警（Curve Speed Warning）。同时也有一些ADAS功能有了地图的帮助，实现起来更加稳定，例如自主巡航ACC（Adaptive Cruise Control）。

![img](https://pic1.zhimg.com/80/v2-7a419a6a81e6741efee0911132211f70_720w.jpg)

![img](https://pic1.zhimg.com/80/v2-1603c6a9d56ee2a92fa4023a07dd38e4_720w.jpg)

总而言之，基于地图的电子地平线可以赋予车辆可靠的超视距感知能力，帮助车辆实现更节能、更安全、更舒适的驾驶体验。

## 3、基于地图的电子地平线实现方式

从上述定义了解到**电子地平线根据车辆位置从地图数据中提取车辆前方或者周边的道路交通信息，然后将这些信息输出，供汽车感知、决策、控制等各功能模块使用。**因此，电子地平线的实现主要考虑两个过程：

### **1）如何提取？**

### **2）如何传输？**

对于问题（1）是一个典型的地图引擎功能，根据车辆当前位置，匹配到地图上最紧邻的道路、甚至车道，然后根据地图存储的道路拓扑连接关系，找到当前道路连接的道路以及所需要的道路附属设施（如红绿灯、地面箭头、标志牌等目标物体）。因为车辆是在动态行驶，所需提取需要设置一个频率，即多久提取一次，也需要设置一个范围，即每提取一次提多大的范围。此外，提取后的信息如何存储与表达呢？还需要一套逻辑数据结构，定义道路、车道、目标物体等详细几何与属性的表达。

对于问题（2），从地图提取后的数据，需要考虑如何传输到车内的其他ECU。目前车内通信应用最为广泛的是CAN Bus。如果采用CAN通信，需要详细定义每个字节的含义。但CAN通讯的带宽不大，如果传输的数据量很大，就需要使用车载以太网，但目前车载以太网还没有实现大规模应用，具体细节不展开。

基于以上实现方式的分析，**欧洲汽车工业界提出了ADASIS标准，旨在将提取的地图逻辑数据结构与通信传输协议标准化。**标准化的好处与利益，以及不标准化的危害，相信大家都十分清楚。

## 4、什么是ADASIS

ADASIS全称是Advanced Driver Assistance Systems Interface Specification，是ADASIS协会提出的一套用于实现电子地平线的数据通信协议，其发展历程如下：

- 最早由Navtech发起，由ERTICO工业合作伙伴成立于2002年；
- ADASIS v1于2005年发布，直到2007年通过欧盟MAPS＆ADAS项目的测试和验证；
- 2010年开始研究ADASIS v2，在2012年启用了首个预测性应用；
- 自2018年5月以来，ADASIS成为一个非营利的国际协会；
- 2018年协会内部发布了ADASIS v3赋能自动驾驶，并2019年10正式发布。

1）ADASIS v2

ADASIS v2基于道路级地图数据提供电子地平线，其架构如下图所示，分为以下几个模块：

- AHP(ADASIS Horizon Provider)：电子地平线提供者
- AHR(ADASIS Horizon Reconstructor) ：电子地平线重构者
- 通讯使用CAN Bus

![img](https://pic4.zhimg.com/80/v2-4f2053b91c2e6c9292b7fc684d825c57_720w.jpg)

并按照CAN通信要求，详细定义了车辆位置、道路曲率、坡度等属性在CAN Layout（CAN数据帧）上的字节长度与位置。

![img](https://pic4.zhimg.com/80/v2-060f76c1ea5415ea0784448db9be6897_720w.jpg)

2）ADASIS v3

ADASIS v3是基于车道级的高精地图提供电子地平线，所需要的带宽更大，是面向车载以太网通信进行设计的。目前ADASIS V3最新版本是V3.2.0。由于不在受限于CAN Bus 64位字节的限制，ADASIS v3采取了面向对象的思想定义了非常丰富的数据结构体。ADASIS协会为会员提供定义文件（ Franca IDL，即.fidl文件）与说明文档。

ADASIS V3消息类型包括以下几种。

- MPP：局部路径规划
- Path control&Profile control ：地图拓扑关系、同步数据
- Global Msg： 系统状态，天气等全局数据
- Position Msg： 车辆在地图的位置信息
- Profile Msg： 包含信息最多，包括车道线、车道中心线、路牌等

在继承Path、Subpath、Message等基本概念的同时，扩展定义了Path Control和Profile Control消息。AHR根据从AHP接收的Path Control消息，可以将需求范围之外的旧Path删除；再根据Profile Control消息，将当前path中不在需求范围之内的旧数据删除。从而实现了数据接收端的动态更新，避免数据持续累积过大。

Profile Msg中，可支持自动驾驶功能的部分定义展示如下：

![img](https://pic2.zhimg.com/80/v2-5fbd5aafd6d3a9321b29b7e432cf8095_720w.jpg)

3）ADASIS V2与V3的不同之处：

![img](https://pic1.zhimg.com/80/v2-6ab49643f68bb985af45b85d1565f038_720w.jpg)

## 5、ADASIS实现路径

基于ADASIS实现电子地平线，包含以下环节：

### 1）地图数据

例如使用NDS格式或者其他导航电子地图格式的数据。导航电子地图或者高精地图一般包含基于交通通行规则的道路和车道拓扑连接关系，这是生成电子地平线Path树的数据基础。

![img](https://pic2.zhimg.com/80/v2-644e77d84d36e904988e16549e196c4d_720w.jpg)

### 2）AHP开发

AHP除了上文提到的地图引擎功能，即根据车辆位置，提取需要的前方或周边局部地图数据，还需要执行序列化。

由于ADASIS协会定的ADASIS V3是一套逻辑数据结构，对应ISO/OSI参考模型的第7层。而在使用车载以太网传输前，需要将按照逻辑结构存储的电子地平线数据进行序列化或者称为二进制化。未来，ADASIS可能会继续将电子地平线数据的编码（encoding，对应第6层）及传输（更低层）进行标准化。

![img](https://pic3.zhimg.com/80/v2-62ff9f95b11e716ae12b70716cdf45ee_720w.jpg)

因此，在ADASIS协会将序列化方法标准化前，需要使用非标准化的序列化方法。

TomTom和 EB公司合作的ADASIS V3实现方案中采用的序列化方法： [http://msgpack.org](https://link.zhihu.com/?target=http%3A//msgpack.org)

![img](https://pic3.zhimg.com/80/v2-346b157e3f232d1881d6f675614c54b2_720w.jpg)

### 3）AHR开发

AHR主要作用是将接收到的序列化后的电子地平线数据反序列化，将二进制数据重构为逻辑数据。对于ADASIS V3版本的AHR，还需要实现双向通讯、动态存储管理等机制。此外，在基于AHR重构后的数据，还可以开发格式检查、可视化等功能。

![img](https://pic2.zhimg.com/80/v2-b1e02e37247c5c6e8888ba7c105c8431_720w.jpg)

### 4）硬件

详细可以参考我的这篇回答。

[请问高精度地图数据具体存放在车端哪个硬件设备下？7 赞同 · 0 评论回答![img](https://pic2.zhimg.com/v2-0a46d216e26ccaa413ed546ae06fb2a9_ipico.jpg)](https://www.zhihu.com/question/436291828/answer/1785724596)

## 6、待续话题

1）ADASIS V3详细介绍，包括：

- EHP双向通讯机制
- Path生成方案，特别是GPP与MPP生成方案
- 动态删除机制
- Profile消息详解

2）ADASIS测试验证方法

3）ADASIS实际应用中的问题与定制化方法

4）ADASIS当前应用状态及未来发展计划

5）多源感知融合的AHP方案

6）ADASIS在不同场景下的应用，如高速、城市道路、封闭园区

7）其他不使用ADASIS标准的电子地平线方案