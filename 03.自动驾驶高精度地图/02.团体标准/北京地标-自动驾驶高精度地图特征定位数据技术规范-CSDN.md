# 1 范围

本文件规范了自动驾驶高精度地图特征定位数据的建立。

本文件适用于自动驾驶高精度地图特征定位数据的生产和测试。 

# 2 规范性引用文件

下列文件对于本文件的应用是必不可少的。凡是注日期的引用文件，仅所注日期的版本适用于本文件。凡是不注日期的引用文件，其最新版本（包括所有的修改单）适用于本文件。

GB 20263 导航电子地图安全技术处理要求

GB/T 5768.2 道路交通标志标线第2部分：道路交通标志 

GB/T 5768.3 道路交通标志标线 第3部分：道路交通标线 

GB/T 30269.807 信息技术传感器网络第807部分：测试：网络传输安全

GB/T 37939 信息安全技术 网络存储安全技术要求

# 3 术语和定义

下列术语和定义适用于本文件。

## 3.1 特征定位数据 feature localization data

可以被传感器检测、识别并具有位置信息，能够用于定位的数据。

## 3.2 自然特征定位数据 natural feature localization data

由图像或点云中的灰度值或曲率变化较大的点构成的，以离散三维点云形式表达的特征定位数据。

## 3.3 语义特征定位数据 semantic feature localization data

从图像中提取并抽象的线或面要素，具有现实语义属性，以矢量数据形式表达的特征定位数据。

## 3.4 绝对精度 absolute accuracy

观测位置值相对于真实位置值之差的统计值。

## 3.5 相对精度 relative accuracy

两个测量对象间的绝对距离偏差值和真实值之间的比值。 

## 3.6特征点描述子 image feature points descriptor

每个关键点周围的区域中，以选定的比例尺测量的局部图像梯度的二进制编码。 

## 3.7帧 frame

在图像领域是指影像动画中最小单位的单幅影像画面；在雷达点云领域是指雷达扫描一次的单幅点云图像画面。 

## 3.8关键帧 image keyframe

在局部一系列普通帧中选出的记录并代表局部信息的帧。 

## 3.9杆状设施 pole

用于支撑交通标牌、路灯、信号灯、龙门架、广告牌、交通监控设备、车路协同设备等物体的圆柱形或长方体形的物体。

# 4 总体要求

## 4.1 时空参照系

4.1.1 空间坐标系统应采用 2000 国家大地坐标系（CGCS2000）。

4.1.2 时间系统宜采用协调世界时（UTC）。

## 4.2 数据作业范围

4.2.1 自然特征定位数据作业范围应为传感器可识别范围。

4.2.2 语义特征定位数据作业范围宜为道路路面上和道路边缘处的所有交通设施、路侧外 1m 以内高于地面 0.1m 的设施和路侧外 1m-5m 范围内高于地面 0.5m 的设施，见图 1。

![image-20220829174742096](https://img-blog.csdnimg.cn/img_convert/69d09687103f5966b2633ccd5aa2a5dd.png)

## 4.3 数据应用流程

高精度地图特征定位数据的采集、处理、应用的流程为车端到服务端，再到车端的过程，宜实现快速更新，见图 2。应符合下列要求：

a) 车端基于不同传感器采集的特征定位数据上传到服务端，并基于服务端发布的特征定位数据辅助车辆定位；

b) 服务端经过多车特征定位数据的自动化融合与质量评价，发布给车辆特征定位数据。

![image-20220829174805811](https://img-blog.csdnimg.cn/img_convert/b8fbf5483145780e1dbacf35fa8860d1.png)

## 4.4 数据应用方式

4.4.1 本地地图应用：特征定位数据存储在终端设备上，结合传感器和特征定位数据进行融合定位， 当传感器检测的特征要素和特征定位数据不一致时，自动驾驶车辆将差异路段的特征要素上传到服务端。 

4.4.2 在线地图应用：特征定位数据存储在服务端，设备终端需要联网，自动驾驶车辆根据某种方式请求区域内的特征定位数据，当传感器检测的特征要素和特征定位数据不一致时，自动驾驶车辆将差异路段的特征要素上传到服务端。 

# 5 技术要求

## 5.1 精度要求

5.1.1 特征定位数据绝对精度：平面、高程均方根误差小于等于 1m。 

5.1.2 视觉自然特征与语义特征定位数据相对精度：平面、高程每 100m 范围内小于等于 0.2m。 

5.1.3 毫米波雷达点云自然特征定位数据相对精度：平面、高程每 100m 范围内小于等于 0.2m。 

5.1.4 激光雷达点云自然特征定位数据相对精度：平面、高程每 100m 范围内小于等于 0.1m。 

## 5.2 密度要求

5.2.1 特征要素应分布在图像或点云的上下左右各方位，特征要素集中在图像或点云的某一侧时，该数据不能参与定位或参与度降低。 

5.2.2 在多车融合后某一帧图像上可用特征点的数量应不少于 200 个。 

5.2.3 在多车融合后某一帧毫米波雷达点云上可用特征点数量应不少于 100 个。 

5.2.4 在多车融合后某一帧激光雷达点云上可用特征点数量应不少于 700 个。 

5.2.5 在 100m 范围内语义特征对象的个数应不少于 5 个。 

## 5.3 实时性要求

5.3.1 特征定位数据更新应即时、准确，从道路变化的发现、上报到数据更新下发宜 24 小时内完成。 

5.3.2 按照更新方式，宜支持特征定位数据快速更新，不同车辆搭载的不同传感器上传的原始数据， 可通过设置权重、置信度等方式对同一路段进行特征定位地图更新。 

5.3.3 现实世界的特征定位数据的变化量达到 20%时，应对地图进行更新。 

## 5.4 完整性要求

5.4.1 特征定位数据只需表达和特征定位相关的要素及其属性。

5.4.2 现实中不存在的要素或其属性不应存在于特征定位数据中。 

5.4.3 特征定位数据中不应包含重复的要素及其属性。

## 5.5 安全性要求

5.5.1 传输安全性：车端与服务端特征定位数据传输应符合 GB/T30269.807 标准要求，保证数据完整性、保密性和可用性。

5.5.2 存储安全性：服务端特征定位数据存储应符合 GB/T37939 标准要求，保证访问安全、系统安全、数据安全和管理安全。

5.5.3 特征定位数据采集、处理、应用应符合 GB 20263 的标准要求，保证地理信息安全。

5.5.4 按照隐私要求，服务端应对传感器数据进行脱敏处理。 

5.5.5 按照隐私要求，应支持部分传感器特征要素的上传或下载。 

# 6 特征定位数据表达

## 6.1 概述

根据特征定位数据传感器的特性不同，可分为视觉自然特征定位数据、视觉语义特征定位数据和点云自然特征定位数据。毫米波雷达点云和激光雷达点云特征定位数据的表达相同。 

## 6.2 视觉自然特征表达

### 6.2.1 视觉自然特征数据模型

视觉自然特征数据模型应包括关键帧、地图点及连接关系，见图 3。 

![image-20220829174915671](https://img-blog.csdnimg.cn/img_convert/6229f258706d77076fd3f01228b5ddf8.png)

6.2.2 视觉自然特征关键帧应符合下列要求：

a) 时间戳为关键帧对应的时间信息。有两种方式，一是采用自 1970 年 1 月 1 日 0 点 0 分 0 秒开始计算的延续时间（以毫秒为单位）表达方式，如：“1577833620000”，二是采用年月 日时分秒表达方式，如“2020-01-01 07:07:00”；

b) 位姿变换应为关键帧对应的当前相机运动的位姿变换矩阵；

c) 角度应为关键帧中特征点的角度，表示特征点的方向；

![image-20220829174935607](https://img-blog.csdnimg.cn/img_convert/c10e110d1c2ace9c88ddae0186b1398f.png)

d) 响应值为关键帧中特征点的灰度变化强度，应根据角点响应函数计算；

e) 特征点描述子应为关键帧中特征点的属性，对已检测到的特征点进行描述，特征点与周围像素点的灰度对比；

f) 地图点索引应为关键帧中特征点对应的地图点的编号值。 

6.2.3 视觉自然特征地图点应为图像特征点投影到地图上的三维坐标点，见图 5。

![image-20220829174955817](https://img-blog.csdnimg.cn/img_convert/b902de76e51fe25c671c627d657a176e.png)

6.2.4 视觉自然特征连接关系应为关键帧之间，关键帧与地图点之间建立的关联关系。

6.2.5 视觉自然特征表结构

6.2.5.1 关键帧表结构见表 1。

![image-20220829175036804](https://img-blog.csdnimg.cn/img_convert/a27a676e9219c60966c2557c5ab31166.png)

6.2.5.2 地图点表结构见表 2。 

![image-20220829175054744](https://img-blog.csdnimg.cn/img_convert/36ca0632be4db09df476371a02c7aca0.png)

6.2.5.3 连接关系应为特征点和地图点、特征点和特征点的连接，见表 3、表 4。 

![image-20220829175108371](https://img-blog.csdnimg.cn/img_convert/1e3e74d1cc70689279ea0b3055ceef48.png)

## 6.3 视觉语义特征表达

### 6.3.1 视觉语义特征数据模型

6.3.1.1 视觉语义特征数据模型分为线特征和面特征两类，见图 6。

![image-20220829175125663](https://img-blog.csdnimg.cn/img_convert/b0bf9c02de458f3761927497f5ba4b52.png)

6.3.1.2 线特征数据应为线状延伸，所需形状点数量不固定的要素，模型见图 7。 

![image-20220829175143815](https://img-blog.csdnimg.cn/img_convert/15656e39280f5bca7132883a8cef29e9.png)

6.3.1.3 面特征数据应由数量不等的边界点（至少 3 个）所围成的面状区域要素表达，面特征数据分为地面面块和空中立面两类，模型见图 8。

![image-20220829175203336](https://img-blog.csdnimg.cn/img_convert/d54acb486be54e4ffe4fed322cc169c7.png)

### 6.3.2 线特征数据表达

6.3.2.1 线特征数据几何应符合下列要求，线特征数据可表达的实际场景示例见图 9，图 10。

a) 线特征数据表达路面的各种交通标线、路侧呈线状布设的交通防护设施、路侧及车辆活动场景下竖立于地面的竖杆或平行于地面的空中横杆物体；

b) 几何上以形状点顺序构成的折线表示，形状点位置以三维几何坐标表示；

c) 当线特征数据表达的物体是突起于地面的路侧防护设施时，需要以起点高度和终点高度属性表示物体自身的高度尺寸。

![image-20220829175231843](https://img-blog.csdnimg.cn/img_convert/c01d6fb9806e5939f05ebf95ecbd3cc2.png)

6.3.2.2 线特征数据属性应包括下列内容：

a) 路面交通标线的属性包括：类型、线型、颜色、实线段长度、虚线段长度和置信度；

b) 路侧防护设施的属性包括：类型、起点高度、终点高度、颜色和置信度；

c) 路侧杆状设施的属性包括：类型、颜色和置信度。

6.3.2.3 线特征表结构应符合下列要求：

a) 路面交通标线的视觉语义属性与位置信息的数据库表达见表 5；

![image-20220829175314547](https://img-blog.csdnimg.cn/img_convert/60105c09c7d9cfb88f533284b4dc2814.png)

![image-20220829175322227](https://img-blog.csdnimg.cn/img_convert/4d5966a86d10d82499dd86eea6ef99c8.png)

b) 路侧防护设施的视觉语义属性与位置信息的数据库表达见表 6； 

![image-20220829175353300](https://img-blog.csdnimg.cn/img_convert/9476269b542db366da77eb78a2c5cf39.png)

c) 路侧杆状设施的视觉语义属性与位置信息的数据库表达见表 7。 

![image-20220829175421556](https://img-blog.csdnimg.cn/img_convert/6095e83a02d36418b448cd1a9e68dbc8.png)

6.3.2.4 线特征数据应符合以下基本要求：

a) 线特征数据的采集位置宜为交通标线喷涂线的中央位置，见图 11；

![image-20220829175437494](https://img-blog.csdnimg.cn/img_convert/9c5b22b470f48f499d364c825d2fdb1e.png)

b) 交通标线为双线时宜分别采集两条喷涂线的中央位置，见图 12； 

![image-20220829175450470](https://img-blog.csdnimg.cn/img_convert/5075d0540c14387dcb3f0013ff9fc328.png)

c) 路侧防护设施的地面根部位置为线特征数据的采集位置，当多种类型组合出现，且高度差异 大于 1m 时，应使用平行线的方式用多条线段表示，线段间距 20cm，见图 13； 

![image-20220829175504447](https://img-blog.csdnimg.cn/img_convert/97534a07e7d7b6d58ec0e603e86c1412.png)

d) 线特征数据中路侧防护设施高度自地面起算，按实际测量值赋值；

e) 与道路延伸方向相同的线特征数据，按实际位置表达，不应出现线条间的重叠或交叉；

f) 线特征数据类型、线型发生变化时，应在变化处打断，见图 14； 

![image-20220829175518014](https://img-blog.csdnimg.cn/img_convert/f11b1a13d32db40c993ed7c2ba6c702e.png)

g) 形状点密度要求：相邻两点距离不大于 50m，相邻三点的中间点对首末两点连线的垂距不大于 0.1m。 

### 6.3.3 面特征数据表达

6.3.3.1 面特数据几何应符合下列要求，面特征数据可表达的实际场景示例见图 15。 

![image-20220829175536535](https://img-blog.csdnimg.cn/img_convert/e254874c734c0ba3789ccc75e97de554.png)

a) 面特征数据表达路面中以面状区域表示的路面交通标线、路侧及路内竖立和悬挂的各种交通标志牌，几何上以这些面块的外边界形状点顺序围成的地面面块或空中立面表示，形状点位置以三维几何坐标表示；

b) 路面交通标记中路面转向箭头、路面指示文字、路面交通图形，中心圈，减速丘应使用对应的最小外接矩形表达，边框角点按顺时针方向排列。如图 16 矩形框所示；

![image-20220829175555302](https://img-blog.csdnimg.cn/img_convert/596005b4881f6a3af3fc967d9f68944b.png)

c) 路面交通标记中的导流区、禁止停车区、减速带、停车位面应使用其对应的外边界表达。如 图 17 所示； 

![image-20220829175608863](https://img-blog.csdnimg.cn/img_convert/522d3f0d8f8c40a5a51532fc93780c34.png)

d) 路侧（内）的交通标志牌，应使用其外接矩形或三角形作为立面的边界线，非规则三角形、 矩形使用最小外接矩形表达，其他以实际标牌的各个顶点顺序相接而围成的面表达，边框角点按顺时针方向排列。如图 18 所示； 

![image-20220829175623176](https://img-blog.csdnimg.cn/img_convert/46a31f30507845e0cf4758bdfe61f670.png)

e) 路侧（内）其他设施面，主要指跨路的过街桥面向车辆来向的侧面、龙门架跨路部分以及其他非交通标志牌的立面，使用最小外接矩形（红框）表达，边框角点按顺时针方向排列。如图 19 所示；

![image-20220829175638697](https://img-blog.csdnimg.cn/img_convert/e2c6394289995f1ea59dd369e3a1a89b.png)

f) 信号灯以包围信号灯的矩形立面表达，不区分颜色和转向方向，边框角点按顺时针方向排列。 如图 20 所示。

![image-20220829175654470](https://img-blog.csdnimg.cn/img_convert/afa1f8ebcd959a3a4b9cfec99e0b32cc.png)

6.3.3.2 面特征数据属性应包括下列内容：

a) 路面交通标记的属性包括类型、颜色、导向箭头方向和置信度；

b) 路侧（内）交通标志牌的属性包括类型、形状、底色、文字边框颜色和置信度；

c) 路侧（内）其他设施的属性包括类型和置信度。

6.3.3.3 面特征表结构应符合下列要求：

a) 路面交通标记的视觉语义属性与面边界位置信息数据库表达见表 8； 

![image-20220829175732450](https://img-blog.csdnimg.cn/img_convert/8cf96240fe4e4415b24f8ae336b0ca8b.png)

![image-20220829175754481](https://img-blog.csdnimg.cn/img_convert/b142ecfb9aa05ee060ce4d4e2707a585.png)

b) 路侧（内）交通标志牌的视觉语义属性与面边界位置信息数据库表达见表 9； 

![image-20220829175812203](https://img-blog.csdnimg.cn/img_convert/71afc2c4bdd18619e5fff2b973dfa977.png)

![image-20220829175834130](https://img-blog.csdnimg.cn/img_convert/45555cc96697111bb08f69382f7ef8be.png)

c) 路侧（内）其他设施的视觉语义属性与面边界位置信息数据库表达见表 10。

![image-20220829175846697](https://img-blog.csdnimg.cn/img_convert/c473b3e886eccc217424decd479e2128.png)

6.3.3.4 面特征数据应符合以下基本要求：

a) 路面标记面的边界位置应按线状喷涂线的中央位置采集，且要求首尾点重合，边界线无缠绕， 边界线形状点以左上角为起点，按顺时针方向排列。见图 21； 

![image-20220829175901246](https://img-blog.csdnimg.cn/img_convert/9a329250b69122d1625bca121335889c.png)

b) 面边界形状点密度要求相邻两点距离不大于 10m，相邻三点的中间点对首末两点连线的垂距不大于 0.1m。 

## 6.4 点云自然特征表达

### 6.4.1 点云自然特征数据模型

点云自然特征数据模型包括特征边界和特征点云，见图 22。

![image-20220829175917440](https://img-blog.csdnimg.cn/img_convert/b8fc7798589f69f25829be70091372eb.png)

### 6.4.2 特征边界应符合下列要求：

a) 每个特征区块的特征边界宜为一个三维的矩形面，边长根据实际特征要素形状划分；

b) 边界坐标宜为每个特征区块边界的左下角三维坐标和右上角三维坐标。 

### 6.4.3 特征点云应符合下列要求：

a) 点云自然特征定位数据应分为毫米波雷达和激光雷达两种类型。毫米波雷达点云识别的静态目标主要是道路护栏、杆、桥、建筑物等，见图 22。激光雷达点云识别的静态目标包括草木，金属、水泥、车道线等，见图 23； 

![image-20220829175941970](https://img-blog.csdnimg.cn/img_convert/bda8a50d988132913067113b98c4f1c8.png)

b) 点云坐标应为特征点云在当前特征区块的三维坐标，通过相对坐标的形式表达，和特征区块边界左下角的坐标的差值；

c) 点云自然特征定位数据的强度越强定位数据越可靠；

d)置信度为点云自然特征定位数据位置的可信程度。环境会影响置信度，在应用时应优先选择置信度高的特征要素用于定位。

### 6.4.4 点云自然特征表结构

6.4.4.1 特征边界表结构见表 11。 

![image-20220829180007674](https://img-blog.csdnimg.cn/img_convert/d1d78632bfca11d43f10d9e44b8dc387.png)

6.4.4.2 特征点云表结构见表 12。

![image-20220829180021684](https://img-blog.csdnimg.cn/img_convert/0095f342cad49c9c82598236b449756b.png)