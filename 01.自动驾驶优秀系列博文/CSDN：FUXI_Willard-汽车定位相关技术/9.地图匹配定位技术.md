- [学习笔记9--地图匹配定位技术_FUXI_Willard的博客-CSDN博客](https://fuxi-willard.blog.csdn.net/article/details/125644288)

## 3.地图匹配定位技术

### 3.1 地图匹配定位技术简介

- 地图匹配定位技术是利用实时道路物理信息与预制高精度地图进行匹配来实现汽车定位的技术；
- 引入地图匹配可以有效消除系统随机误差，校正传感器参数，弥补在城市高楼区、林荫道、立交桥、隧道中长时间GNSS定位失效而惯性导航系统误差急剧增大时的定位真空期；
- **地图匹配定位技术指将自动驾驶汽车行驶轨迹的经纬度采样序列与高精度地图路网匹配的过程；**
- 如下图所示，由于各种原因导致自动驾驶汽车定位信息存在误差，尽管汽车行驶在中间车道上，但定位结果与实际情况存在误差，利用地图匹配定位技术将汽车定位信息纠正回正确车道，提高定位精度；
  ![1](https://img-blog.csdnimg.cn/b099314a12574251a287f215fc8df894.jpeg#pic_center)

### 3.2 地图匹配定位技术原理

![2](https://img-blog.csdnimg.cn/d048c6e0fd64415baaca94052c270664.jpeg#pic_center)

- 地图匹配定位是在已知汽车的位姿信息的条件下进行高精度地图局部搜索的过程；
  - 首先，利用汽车装载的GNSS和INS做出初始位置判断，确定高精度地图局部搜索范围；
  - 然后，将激光雷达实时数据与预先制作好的高精度地图数据变换到同一个坐标系内进行匹配，匹配成功后即可确认汽车定位信息；
- 高精度地图预制是地图匹配的基础，需要包含特征明显的结构化语义特征和具有统计意义的信息；
- 高精度地图中常用于地图匹配的特征包括：车道线、停止线、导流线、路灯、电线杆等特征明显的物体，同时，还包括平均反射值、方差及平均高度值等具有统计意义的信息；

![3](https://img-blog.csdnimg.cn/82cb6956db6c489c963a1e1a5891987c.jpeg#pic_center)
![4](https://img-blog.csdnimg.cn/fc19af0bb0eb47cb8a88dfcebd7f5f83.jpeg#pic_center)

- 根据实时感知数据进行环境特征的检测，主要检测对象是地面上的车道线与杆状物，并从高精地图对应位置范围内提取对应的元素；实际匹配过程中，系统将检测出的车道线、护栏等道路特征与高精地图提供的道路特征进行对比，修正汽车的横纵向定位；
- 图3-19：GNSS将汽车定位在前进方向的左侧车道，自动驾驶汽车利用传感器检测到车道线信息与高精度地图数据进行匹配后，确定汽车位于前进方向中间车道，与GNSS的定位结果存在差异，进而修正横向的位姿误差；
- 图3-20：纵向上修正主要提取传感器所检测到的广告牌、红绿灯、交通标志灯等道路元素与高精度地图进行匹配，可以修正汽车的纵向误差；

### 3.3 地图匹配定位误差分析

**地图匹配定位误差主要由局部搜索范围正确性引起；局部搜索范围正确性即道路选择的正确性，是地图匹配中极大影响因素之一，在选择道路正确情况下，才能继续地图匹配过程；造成道路选择错误的原因主要包括：路况引起的误差、传感器误差、高精度地图误差及算法误差等方面；**

1. 路况引起的误差

   - 车速变化将影响传感器采集数据的质量，车速越快，质量越低，甚至产生运动模糊、失真等情况；
   - 在没有INS定位系统中，各种路况下造成的汽车轮胎的漂移及地面颠簸等情况都可能使激光点云数据存在畸变、抖动和运动模糊等问题；
   - 实际行驶情况中汽车有时会离开道路，将导致道路匹配错误并引起误差；

2. 传感器误差

   进行地图匹配需要利用传感器的量测信息，这些数据存在误差将直接影响定位速度与成功率；

3. 高精度地图误差

   在地图数据本身存在误差时，即使在正确选择道路的情况下也会引入误差；

4. 算法误差

   在地图匹配过程中不可避免地因算法存在的缺点导致发生错误匹配，发生错误匹配会对之后的地图匹配定位结果产生恶劣的影响；

### 3.4 地图匹配常用算法

任何地图匹配算法都涉及两个根本问题：**一是当前汽车在哪一条道路上；二是当前汽车在对应道路的哪一个位置；** 地图匹配算法可用下式进行形式化描述：
X ^ n = f ( ( X 0 , X 1 , X 2 , … , X n ) T , G ( R , N ) ) \hat{X}_n=f((X_0,X_1,X_2,\dots,X_n)^T,G(R,N))X^n​=f((X0​,X1​,X2​,…,Xn​)T,G(R,N))
其中：

- X n X_nXn：表示n nn时刻汽车的原始状态信息，如定位数据、速度、行驶方向等；
- G GG：表示道路网络，由道路路段集R RR及道路节点集N NN构成；

#### 3.4.1 几何匹配算法

几何匹配算法包括：点到点、点到弧、弧到弧的地图匹配算法；

1. 点到点地图匹配算法
   - 原理：搜索汽车定位点与高精度地图中位置点之间几何距离最近的点作为匹配结果；
   - 该算法匹配精度取决于位置点集的数量，随着位置点集数量的增大，匹配精度更高；
2. 点到弧的地图匹配算法
   - 原理：通过寻找与汽车定位点几何距离最近的路段作为匹配线段，将汽车定位点投影到该线段上作为匹配结果；
   - 对于曲线则做线性化处理后进行投影，该算法只利用部分数据，当两条曲线距离较小或相同时容易造成误匹配，在路网密度大时匹配结果精度锐减，算法缺乏稳定性；
3. 弧到弧地图匹配算法
   - 原理：将连续的汽车定位点组成一条轨迹曲线，寻找与这条曲线最近的匹配弧线作为匹配线段；
   - 若某定位点与非正确匹配线段非常近，将导致严重误差；

#### 3.4.2 概率统计算法

**概率统计算法通过在汽车导航定位系统中获得的历史轨迹，建立置信区域来与高精度地图进行匹配；置信区域参考GNSS误差、汽车航迹、汽车速度及道路信息等进行选取，与高精度地图匹配后采取最近距离原则来确定匹配线段；**
![5](https://img-blog.csdnimg.cn/7cd28b4add064956a1670b984d36ad44.jpeg#pic_center)

- 基于概率统计地图匹配算法包括三个主要处理过程：确定误差区域、选取候选路段、计算匹配位置；
- 误差区域：指可能包含汽车真实位置的区域范围，应根据传感器定位结果和误差情况确定；
- 在误差区域内的道路称为候选路段，地图匹配算法认为其中包含了汽车的真实位置；
- 匹配路段的选取方法：从候选路段中挑选最有可能的汽车行驶路段，挑选原则依据具体的算法设计而不同；通常，挑选参考量是高精地图中的道路形状与汽车轨迹的相似程度；
- 确定匹配路段后，计算汽车在该路段中最有可能的位置，并用匹配结果修正原有的定位信息；

#### 3.4.3 其他高级算法

- 其他算法：非参数滤波算法和参数滤波算法；
- 非参数滤波算法包括：直方图滤波(Histogram Filter，HF)和粒子滤波(Particlce Filter，PF)等；
- 参数滤波算法包括：卡尔曼滤波、扩展卡尔曼滤波(Extended Kalman Filter，EKF)、信息滤波(Information Filter，IF)、扩展信息滤波(Extended Information Filter，EIF)等；