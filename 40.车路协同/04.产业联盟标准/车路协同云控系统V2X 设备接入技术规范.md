## 1 范围

本文件规定了合作式智能运输系统车路协同云控系统V2X设备接入要求和对应的交互数据技术要求。 本标准适用于基于LTE的车联网无线通信技术消息层的设计与开发。 

本文件适用于合作式智能运输系统车路协同云控系统V2X设备接入的设计与开发。

## 2 规范性引用文件 

下列文件对于本文件的应用是必不可少的。凡是注日期的引用文件，仅注日期的版本适用于本文件。 

凡是不注日期的引用文件，其最新版本（包括所有的修改单）适用于本文件。 

YD/T 3709-2020 基于LTE的车联网无线通信技术 消息层技术要求 

T/CSAE 53-2020 合作式智能运输系统 车用通信系统 应用层及应用数据交互标准 

T/ITS 0097-2018 合作式智能运输系统 通信架构 

T/CSAE 157-2020 合作式智能运输系统 车用通信系统 应用层及应用数据交互标准 

## 3 术语和定义 

下列术语和定义适用于本文件 

### 3.1 术语 

3.1.1 合作式智能运输系统 cooperative intelligent transportation system

C-ITS 合作式智能运输系统是智能运输系统的一种，包含各智能运输系统站之间交流和分享信息的工具， 旨在提供建议或采取措施提高独立智能运输系统范围之外的安全性、可持续性、效率和舒适性。 

3.1.2 车路协同云控平台 car road collaboration cloud control platform 

车联网V2X云控平台主要是面向智能网联汽车“车路云一体”数字化设施建设，是智慧交通的综合 管理支撑平台，解决智能网联汽车存在的信息孤岛，难以互联协同、有效管控的问题，通过定义互相可 靠的信息交互规则，实现车与车、车与基础设施、车与平台之间数据的互联互通。将各种实时的动态信 息汇集到V2X云控平台，通过对多源数据的建模分析，为辅助驾驶和自动驾驶提供安全、可靠的规划决策。提高驾驶的安全性和通行效率，同时提供个性化的内容服务。 

3.1.3 物联网 internet of things，IOT

物联网是一个基于互联网、传统电信网等信息承载体，让所有能够被独立寻址的普通物理对象实现互联互通的网络。它具有普通对象设备化、自治终端互联化和普适服务智能化3个重要特征。具体来说，物联网的体系自下而上可以分成五个层级，分别是感知层、接入层、网络层、服务管理层以及应用层。

一句话概括：把所有物品通过信息传感设备与互联网连接起来，进行信息交换，即物物相息，以实现智能化识别和管理。 

3.1.4 车联网 internet of vehicles，IOV 

车联网的概念源于物联网，即车辆物联网，是以行驶中的车辆为信息感知对象，借助新一代信息通信技术，实现车与X（即车与车、人、路、服务平台）之间的网络连接，提升车辆整体的智能驾驶水平，为用户提供安全、舒适、智能、高效的驾驶感受与交通服务，同时提高交通运行效率，提升社会交通服务的智能化水平。 

3.1.5 物模型 thing specification language，TSL 

**物模型指将物理空间中的实体数字化，并在云端构建的该实体的数据模型，用于描述实体的功能。** 

**TSL是一个JSON格式的文件。**它是物理空间中的实体，如传感器、车载装置、楼宇、工厂等在云端的数字化表示，从属性、功能和事件三个维度，分别描述了该实体是什么、能做什么、可以对外提供哪些信息。定义了物模型的这三个维度，即完成了产品功能的定义。 

3.1.6 V2X 

车载单元与其他设备通信，包括但不限于车载单元之间通信（V2V），车载单元与路侧单元通信（V2I）， 车载单元与行人设备通信（V2P），车载单元与网络之间通信（V2N）。 

### 3.2 缩略语 

下列缩略语适用于本文件。 

ASN.1：抽象语法标记（Abstract Syntax Notation One） 

BSM：基本安全消息 (Basic Safety Message) 

C-ITS 合作式智能运输系统 (Cooperative Intelligent Transportation System) 

CLPMM：编队管理消息（Connectionless Platooning Management Message） 

OBU：车载单元（On-Board Unit） 

PAM：停车场地图（Parking Area Map） 

PSM：个体安全消息（Personal Safety Message） 

PSU：个人服务单元(Personal Service Unit) 

RSC：路侧协调消息（Road Side Coordination） 

RSI：路侧单元发布的交通事件消息 Road Side Information 

RSM：路侧单元消息 (Road Side Message) 

RSU：路侧单元（Road Side Unit） 

RTS: 道路收费服务（Road Tolling Service） 

SDS：感知数据共享（Sensor Data Sharing） 

SPAT：信号灯相位与配时消息（Signal Phase and Timing Message） 

SSM：感知共享消息（Sensor Sharing Message）

TSL: 物模型 (Thing Specification Language) 

UPER：非对齐压缩编码规则（

Unaligned Packet Encoding Rules） 

V2I：车载单元与路侧单元通讯（

Vehicle to Infrastructure） 

V2P：车载单元与行人设备通讯（

Vehicle to Pedestrians） 

V2V：车载单元之间通讯（

Vehicle to Vehicle） 

V2X：车载单元与其他设备通讯（

Vehicle to Everything） 

VIR：车辆意图和请求（

Vehicle Intention And Request） 

VPM：车辆支付消息（

Vehicle Payment Message） 

VRU：弱势交通参与者（

Vulnerable Road User） 

VRUSP: 弱势交通参与者安全通行（

Vulnerable Road User Safe Passing） 

## 4 合作式智能运输系统 车路协同云控系统 

### 4.1 系统介绍 

合作式智能运输系统-车路协同云控系统为V2X设备提供安全可靠的连接通信能力，向下连接海量V2X设备，支撑V2X设备数据采集上云；向上提供云端API，服务端通过调用云端API将指令下发至V2X设备端，实现设备管理、远程控制、监控运维等能力，详见图1。V2X设备与平台之间通过物模型（物模型是指将物理空间中的实体数字化，并在云端构建该实体的数据模型）实现消息通信。物模型可以屏蔽底层设备差异，让软件开发者基于平台提供的标准API进行开发，让硬件开发者基于平台提供的标准协议开发，从而达到软硬开发解耦的目的使用物模型接入物联网平台，简化接入流程和软硬件开发，同时可以更好地支持设备的扩展。

### 4.2 应用层与交互数据 

本文件围绕智能网联汽车测试示范互通性与互认性，调研和梳理合作式智能运输系统现有数据监控的需求，界定监控数据类型及采集数据项范围，定义V2X设备监控管理的应用以及支撑这些应用的交互消息集合（数据帧、数据元素、数据结构和具体的编码方式等）。

本文件通过对主流物联网平台的分析，定义在实现V2X设备监控管理应用时，V2X设备和云控平台间的信息交互内容与交互协议等。为了降低整体产业开发成本和周期，本文件不指定具体的通信协议，用户可以使用开放协议（如MQTT、Coap、HTTPS等物联网传输协议）自主接入V2X设备，实现设备上报属性和事件信息，平台下发设置属性和调用服务指令；不限定具体的数据格式，使用ASN.1记录V2X设备物模型数据内容，用户可以选择ASN.1格式或相应的其他数据格式（如JSON、XML等）。 

## 5 车路协同云控系统 V2X 设备接入应用 

### 5.1 设备认证 

设备接入系统之前，需通过身份认证，车路协同云控系统应支持使用设备密钥和X.509证书等方式进行身份认证，并使用 TLS/DTLS 保证通道安全。 

### 5.2 设备影子 

系统提供设备影子功能，用于缓存设备状态。设备在线时，可以直接获取云端指令；设备离线后，再次上线可以主动拉取云端指令。 

### 5.3 远程登陆 

系统支持远程登录功能，用户可以远程控制和管理设备。远程连接基于SSH技术实现，方便用户远程登录设备进行设备控制和管理（其使用的用户名和密码是设备的用户名与密码）。 

### 5.4 远程重启 

系统支持的远程重启功能，用户可以远程重启设备。 

### 5.5 远程配置 

系统支持的远程配置功能，用户可以在线远程更新设备的系统参数、网络参数等配置信息。 

### 5.6 远程升级 

系统支持OTA升级与管理服务。 

### 5.7 日志上报 

系统支持设备本地日志的上报，用户可以在线查询V2X设备本地日志，进行故障分析。 

### 5.8 PC5 通信统计 

系统支持V2X设备上报PC5接口的通信数据，用户可以在线分析PC5接口的信道忙率、单向时延、丢包率等指标。 

## 6 消息层交互数据技术要求 

### 6.1 消息层基本介绍和要求 

消息层数据集用ASN.1标准进行定义，遵循“消息帧-消息体-数据帧-数据元素”层层嵌套的逻辑进行制定。

数据集交互的编解码方式遵循非对齐压缩编码规则UPER（Unaligned Packet Encoding Rules）。 

### 6.2 消息层数据集定义 

基于车联网开发领域设计的合作式智能运输系统车路协同云控系统V2X设备接入，消息层所涉及的数据集，主要由1个消息帧格式，3个基本的消息体以及相应的数据帧和数据元素组成，详见图2。

![image-20220418160707186](https://raw.githubusercontent.com/lovebetterworld/img/master/img/20220418160707.png)

#### 6.2.1 消息帧 

消息帧是单个应用层消息的统一打包格式，是数据编解码的唯一操作对象。消息帧由不同类别的消 息体组成，并支持扩展。 

```ASN.1
-- Main message frame 
MessageFrame ::= SEQUENCE { 	
	timestamp INTEGER, 
	messageId NumericString, 
	deviceId NumericString, 
	payload Payload 
}
Payload ::= CHOICE { 
	property Property, 
	funtion Function, event Event 
}
```

