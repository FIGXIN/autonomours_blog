- [高精地图（一）：自动驾驶HDmap（3万字扫盲科普） - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/605953999)

## 1. 自动驾驶产业与高精地图

### 1.1 自动驾驶技术

了解高精地图需要从自动驾驶产业说起。所谓**自动驾驶**，即车辆能够自主**感知环境并安全移动**，几乎不需要或不需要人工的介入。当前，自动驾驶分为两种方式：

- **模块化系统（Modular systems）：**

将传感器输入到执行器输出的中间过程分别构造成独立的模块：感知-定位-决策-执行等，模块化的基本逻辑就是分而治之。利用LiDAR，Camera，Radar，GNSS-IMU等传感器感知道路环境信息，并进行高精定位，在此过程中也会有V2X技术提供车辆与其他智能设备之间的交互信息。结合人工智能算法进行车道级的路径规划策略，并最终由车端的控制机构执行驾驶决策。**此种方案是当前业界的主流方案。**

![img](https://pic2.zhimg.com/80/v2-58f51bed70974fc3e6f76146df2aa6ad_1440w.webp)

模块化自动驾驶系统框架

- **端到端系统（End-to-end systems）：**

根据传感器采集的道路信息，运用人工智能模型，直接输出方向、刹车、油门踏板的控制信号，实现自动驾驶。**端到端的方式仍然停留在学术研究层面，并无实际应用案例（2023年暂时不用相信某些厂家的端到端口嗨）。**

![img](https://pic3.zhimg.com/80/v2-e2f5d15bd0c5d733d05fc4d9847fdcb6_1440w.webp)

端到端的自动驾驶系统

现阶段，围绕自动驾驶的感知-决策-执行过程，业界涌现了一大批相关供应商，其中高精地图（High Definition Map）处于产业链上游的**感知层**。业界对 “研发高精地图” 的想法十分朴实：如果车载摄像头、激光雷达等传感器相当于人的眼睛和耳朵，可以实时采集道路信息的话，那么**高精地图就像人脑海中的对熟悉道路的记忆一样**——相比陌生的道路环境，驾驶在熟悉的道路上自然信心更加充足一些。

![img](https://pic3.zhimg.com/80/v2-f507e0d24ddd9e70aebb2423d9be6f7e_1440w.webp)

自动驾驶产业布局与高精地图

对于“自动驾驶到底用不用高精地图”，有相当多的口水仗。Tesla领头，理想、华为等厂商也都开始对外宣称要采用重感知的方案。尽管我做了一年左右的HDmap相关工作，但我并不站队高精地图。至少在2022年，我没有看到高精地图方案能有压倒性的优势，但我也没看到重感知的方案有压倒性的优势。

事实上，中国的汽车市场很大，足够容纳好几种方案去折腾、试错。有可能几种方案都可以达到目的，也有可能只有一种可行，也有可能都不行。目前高精地图公司还能拿到投资和项目，证明这条路线并不算差。至于能走到什么地步，我们拭目以待吧。



### 1.2 高精地图的作用

**1.2.1 HDMap与SDMap的对比**

不同于传统的导航地图，高精地图的**应用主体已不再是驾驶者**，而是自动驾驶系统或自动驾驶辅助系统，同时**其精度需达到厘米级，**高精地图包含的道路信息的丰富程度大大提高。高精地图与普通SD地图的详细比对如下：

|          | 高精地图                                                     | 普通SD地图                                 |
| -------- | ------------------------------------------------------------ | ------------------------------------------ |
| 内容要素 | 车道级的道路及路口模型、部件、属性及其他定位图层信息等；交通信号元素：路牌，信号灯等；其他道路元素：高架、护栏、树木、路缘、路标、路灯等；地图元素的逻辑关系表述；注：HDMap表达内容要素极多，组织形式多样，可参考各类《高精地图标准》获知详细信息。 | 道路，POI 道路形状线条、坡度、曲率、方向等 |
| 精确度   | 绝对精度0.5m内，相对精度10~20cm内                            | 米级                                       |
| 使用者   | 自动驾驶系统                                                 | 驾驶者                                     |
| 用途     | 环境感知、定位、路径规划                                     | 导航搜索、目视                             |
| 更新频率 | 动态实时更新 注：实时更新仅从定义和愿景出发。当前业界难以达到此标准，是高精地图需要攻克的难题之一 | 日级/ 小时级更新                           |
| 生产模式 | 高精地图采集车辆 or 众包采集                                 |                                            |



![img](https://pic2.zhimg.com/80/v2-1300e45dbbd3d5a8fb19794a552150d1_1440w.webp)

HDmap图例

![img](https://pic4.zhimg.com/80/v2-2114d790afa0cc685e629f39ee979a4f_1440w.webp)

SDmap图例



**1.2.2 高精地图的作用**

**1. 地理围栏：**高精地图可对行驶车辆给出精细化的边界围栏。

**2. 高精定位：**通过车载传感器如激光雷达、相机等采集的数据，实时与高精地图进行匹配，即可获得车辆的精确位姿，在车端与组合导航输出数据相融合，可实现亚米级甚至厘米级的定位精度。

以上三点，都为车辆最终的**决策规划**提供了丰富的全局信息，有助于自动驾驶车辆做出更为合理的驾驶行为。

![img](https://pic4.zhimg.com/80/v2-2b9cf657f43b9229ccff506e5175a883_1440w.webp)

基于高精地图的定位框架


**3. 辅助环境感知：**

- HDmap可以有效弥补传感器信息不足，提供更丰富的先验信息，减少车端算力负担；
- 可提供传感器感知范围外的超视距信息，为决策规划提供前瞻性信息；以上在车端可称为电子地平线系统（EHP）

![img](https://pic2.zhimg.com/80/v2-f371d98edcf27f5ca009c2361b7f3a39_1440w.webp)

EHP

- 可根据HDMap，对重点区域ROI进行过滤，把感知搜索区域限制在一个明确的、很小的范围内，降低感知难度，如在路口可利用高精地图使相机主动采集交通信号灯的ROI区域；
- 当自动汽车传感器出现故障、环境较为恶劣、或存在遮挡时，高精地图亦能提供充足的道路信息，保障车辆安全。

![img](https://pic4.zhimg.com/80/v2-0ef7dccc5eac362a987e84daff62a1af_1440w.webp)

高精地图辅助感知红绿灯信号

**4. 实景导航HMI**

尽管高精地图主要的作用是用于自动驾驶，但其仍然可以用于人机交互界面，为驾驶员提供实景导航功能。

![img](https://pic3.zhimg.com/80/v2-5f102f8f4522732e2fd4fa3ac05436d6_1440w.webp)

基于高精地图的车端实景导航效果示意



**1.2.3 相对精度与绝对精度**

高精地图存在两种精度：“绝对精度”和“相对精度”。对于HDMap从业者而言，对**“精度”**的理解至关重要。

|          | 概念                                                         |
| -------- | ------------------------------------------------------------ |
| 绝对精度 | 1. 全局Global坐标系下，对某物体位置的测量值 与 其所处的真实世界坐标 的差值。 2. 在实际场景中，比如一个路牌在Global坐标系下实际位置是（100，200，5），而我们测量的位置（99，202，5），那么其差值就是（-1，2，0），自身误差为慨 √5。对多个目标的位置误差进行统计，即得到“绝对精度”。 3. 着重强调地图中各要素孤立的绝对位置。 |
| 相对精度 | 1. 以车辆Host为原点的局部Local坐标系下，某物体相对Host距离的测量值 与其 相对Host距离的真实值 的差值。 2. 着重强调地图中各要素之间相对位置关系。 |

![img](https://pic4.zhimg.com/80/v2-774df8d500b891f3bab6a495cafd4467_1440w.webp)

绝对精度的图例

![img](https://pic1.zhimg.com/80/v2-dd29fbf90293b31bcfb885036c9df2e4_1440w.webp)

相对精度图例

**从自动驾驶车辆的需求出发：**

显然，在车辆的定位过程中，**“Host车辆与周围物体相对距离”**的信息更加重要，也更加直观，后续的计算（如避障、路径规划）也都是基于相对位置来进行的。——这和人类开车一样，我们大部分时候并不知道自己所处的绝对位置，而是依靠与周围物体的相对位置来做出驾驶行为决策。

即使自动驾驶车辆拿到的是 “Global坐标系下Host的绝对位置” 以及 “周围目标物体的绝对位置”，最终仍然需要转化成相对位置来进行后续计算。并且，从法理上讲，所有地图在发布前都需要经过国家测绘局的非线性加密偏转处理，其偏差可达数米，且这种加偏是不可逆的。**因此过度追求绝对精度既无意义也无必要。**

综上，对于高精地图而言，建图过程中的相对精度比绝对精度更加重要，**本文后续讨论涉及“精度”一词全部指“相对精度”。**



### 1.3 高精地图的层级

高精地图按照要素的变化速率，可以分为四个层级：分别是静态层、准静态层、准动态层以及动态层。

|          | 包含信息                                                     |
| -------- | ------------------------------------------------------------ |
| 静态层   | 道路网、车道网的几何以及拓扑信息； 该信息除修路外基本不会变动 |
| 准静态层 | 交通标牌、路面标志等道路部件信息，提供道路信息与定位特征； 会因日常磨损、人为修改发生变化 |
| 准动态层 | 拥堵、施工、交通管制、天气信息等                             |
| 动态层   | 周边车辆、行人、交通事故等                                   |

![img](https://pic4.zhimg.com/80/v2-bf09fe38f8cd9b9dc9d3f73ead90f52f_1440w.webp)

高精地图分层逻辑

*不同的组织、企业会有不同的分层标准，但基本上遵循该分层逻辑。



### **1.4 高精地图的标准**

已知高精地图包含的要素种类繁多，且精度更高。那么，就需要设计一套规则来对地图要素的**表达、组织、交互、更新**格式进行规范，这套规则也就是**高精地图的数据标准。**

*这部分内容详细可参考：

**1.4.1 单一地图要素的表达**

以一个40km/h的限速牌为例，其在高精地图中应当如何进行抽象化表达？我们将其包含的信息拆分为**位置轮廓信息、语义信息、**以及**拓扑信息**，前者表达其所处的位置与外形，后两者表达其属性和连接关系。

| 包含信息     | 表达方式举例                                                 |
| ------------ | ------------------------------------------------------------ |
| 位置轮廓信息 | 1. 圆心点（X,Y,Z）坐标 + 半径r； 2. 由一连串点（Xi,Yi,Zi）组成的矢量化多边形（polygone）； 以上两种表达都是正确的 |
| 语义信息     | 1. 路牌的编号——代表该路牌的唯一身份ID，如10001； 2. 路牌的属性——它是什么种类的路牌，是限速牌，假设其编码为205； 3. 值——限速值是多少，40km/h；etc； |
| 拓扑信息     | 1. 所属地区——例如该路牌位于北京朝阳区，对应行政编码110105 2. 所属路段——例如该路牌属于G1高速上； |

![img](https://pic1.zhimg.com/80/v2-858517f4e78474b9fb5ccc55e01564fc_1440w.webp)

限速牌的抽象化表达

按照上表的逻辑，就完成了对一个路牌信息的提取和抽象化表达。同理，道路中所有的要素都可以按照此逻辑进行抽象，表达为在同一坐标系下（如WGS84或CGCS2000地固坐标系）的**矢量化点、线、面（point，polyline，polygone）及其属性**。

![img](https://pic1.zhimg.com/80/v2-1a456c5eab47c8556b1683153f90f1c4_1440w.webp)

高精地图要素展现格式样例



**1.4.2 地图要素的组织**

然后，需要将这些要素按照一定的层次、结构进行组织管理。比如可以将全国的地图按照行政区域划分成若干小幅地图，再将小幅地图以若干图层来进行组织，相同图层中包含特性近似的道路要素。这样可使得地图逻辑更加清晰，方便使用和更新。在此基础上，对高精地图的更新、复用方式做出规定，即可构成一份完整的**“高精地图标准”。**

![img](https://pic3.zhimg.com/80/v2-ee8a286ac76b39d0cac70a34fc29e926_1440w.webp)

数据的分幅度与分层

当前主流的标准格式有：**OpenDrive，NDS，ADASIS**等**。**业界一般的高精地图交付格式多为Opendrive及其衍生标准，而在车端地图与车载应用之间的标准接口常用ADASIS。 国内一些部门联合企业也推出了多个国家非强制性标准、行业标准以及一些企业的内部标准。

| 标准                                   | 起草者                                  | 时间    | 备注                                                         |
| -------------------------------------- | --------------------------------------- | ------- | ------------------------------------------------------------ |
| NDS                                    | 汽车OEM、图商                           | /       | 瓦片格式，支持增量更新；重文档，信息全面                     |
| OpenDrive                              | 德国自动化及测量系统标准协会（ASAM）    | /       | XML文件                                                      |
| ADASIS                                 | 欧洲智能交通协会下属 ADASIS Forum       | /       | 定义了地图在ADAS和自动驾驶应用程序中的数据模型和传输方式，是针对地图与车载应用之间的标准接口。 |
| 《智能驾驶电子地图数据模型与交换格式》 | 四维图新主编                            | 2019.05 | 此类标准都是推荐性国标或行业标准。多数标准仅有一两个文档，建设不健全。 |
| 《道路高精度电子导航地图数据规范》     | 自然资源部、武汉大学主导                | 2019.12 |                                                              |
| 《电子公路地理要素高精度表达规范》     | 交通运输部主导 协作：国汽智联、易图通等 | 2020.07 |                                                              |
| 《自动驾驶地图采集要素模型与交换格式》 | 中国汽车工程学会、易图通主编            | 2021.05 |                                                              |

**Ref：**

[ASAM OpenDRIVE](https://link.zhihu.com/?target=https%3A//www.asam.net/index.php%3FeID%3DdumpFile%26t%3Df%26f%3D4422%26token%3De590561f3c39aa2260e5442e29e93f6693d1cccd)



### **1.5 对高精地图的要求**

高精地图面向的主要客户是汽车OEM和ZF单位，尤以前者为多。2021年，全国高精地图市场规模已达10亿美元。而如果高精地图能够在未来称为自动驾驶的主流方案，按照远期**国内乘用车+商用车每年超过2000万辆的**装备规模以及附带的地图服务，则市场前景将会十分可观。

OEM对于高精地图的需求可分为对HDmap的需求以及对Map Service的需求，具体的又有**丰富度、覆盖度、新鲜度、准确度**等要求。

|                             | 需求                                                         | 描述                                                         |
| --------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 高精地图相关                | 地图要素(Feature Specification)                              | 地图数据的丰富度： 100余种要素，包括车道中心线、车道属性信息、道路连接信息、坡度、航向、曲率、交通标牌等； 约20 种要素对自动驾驶车辆功能安全有重大影响，包括坡度、曲率、航向、车道类型、道路边界类型等。 |
| 精度（Accuracy）            | 绝对精度：0.5m以内 相对精度：20cm/10cm以内                   |                                                              |
| 范围（Coverage）            | 保障覆盖度：当前要求全国高速公路+城市快速路，之后逐渐要求覆盖城市道路 |                                                              |
| 数据格式（Data Format）     | OpenDrive，NDS等标准格式                                     |                                                              |
| 高精地图服务相关            | 标准导航地图关联（Cross Referencing）                        | 导航电子地图与HD MAP 的关联，实现导航和自动驾驶系统的自动切换。 |
| 数据下发（Data Download）   | 基于高精地图的快速更新和发布，云服务（未来趋势）             |                                                              |
| 终端数据更新(Data Update)   | 保障地图数据的新鲜度                                         |                                                              |
| 其他                        | 品质控制（Quality Control）                                  | 保障数据准确度：例如百度交付高精地图准确率可达99.5%。        |
| 合规（Laws and Regulation） |                                                              |                                                              |

除了对地图内容和服务相关需求，OEM还会从功能安全角度出发，对高精地图供应商的设计、开发、生产流程做出品质控制（QC）的要求，供应商应当满足国内以及国际的相关体系审核认证，例如下方的认证标准。

| 认证标准  | 描述                                                         | 备注                                     |
| --------- | ------------------------------------------------------------ | ---------------------------------------- |
| ISO9001   | 质量保证体系框架                                             |                                          |
| ISO26262  | 《道路车辆功能安全》国际标准，是针对总重不超过3.5吨八座乘用车，以安全相关电子电气系统的特点所制定的功能安全标准 | 当前所有车用电子电器系统均需要通过该认证 |
| ASPICE    | 全称是“Automotive Software Process Improvement and Capacity Determination”，汽车软件过程改进及能力评定，是汽车行业用于评价软件开发团队的研发能力水平的模型框架。 |                                          |
| IATF16949 | 国际汽车工业质量体系认证，IATF16949全名“质量管理体系---汽车行业生产件与相关服务件的组织实施ISO9007的要求”。重于缺陷防范，减少在汽车零部件供应链中容易产生的质量波动和浪费。 |                                          |



### 1.6 国内高精地图概况

**1.6.1 政策优势**

地理信息属于我国重要的战略信息，涉及到国防安全。**因此我国的高精地图测绘并不对外资厂商开放**，**并且对于国内企业获得地图测绘与制作资质有严格的要求。**根据《中华人民共和国测绘法》，从事地图测绘活动的单位，需依法取得相应等级的测绘资质证书，方可从事测绘活动。

2016年出台的**《关于加强自动驾驶地图生产测试与应用管理的通知》**规定，自动驾驶地图的绘制需由具有《导航电子地图制作甲级测绘资质》的单位承担。对高精地图的采集、绘制、传输、审核过程均作出了严格的限制规定。
这较大程度上抬高了高精地图行业的准入门槛，当前具备资质的国内企业不超30家。

而在某di公司事件后，国家在2022年资质复审时更加收紧了准入门槛。以下是拥有《导航电子地图制作甲级测绘资质》的企业、单位名单，信息来源是自然资源部公开目录。

| 序号 | 2022复审 | 单位、公司               | 类型                    | 成立时间 | 发证日期 |
| ---- | -------- | ------------------------ | ----------------------- | -------- | -------- |
| 1    | 通过     | 四维图新                 | 图商-腾讯、航天科技持股 | 2002     | 2001.01  |
| 2    | 通过     | 阿里-高德                | 图商-互联网             | 2001     | 2004.06  |
| 3    | 通过     | 灵图                     | 图商                    | 1999     | 2005.05  |
| 4    | 通过     | 百度-长地万方            | 图商-互联网             | 2002     | 2005.05  |
| 5    | 通过     | 凯立德                   | 图商                    | 1997     | 2005.06  |
| 6    | 审核中   | 易图通                   | 图商                    | 1997     | 2005.07  |
| 7    |          | 国家基础地理信息中心     | 事业单位                | 1995     | 2006.01  |
| 8    |          | 立得空间                 | 图商                    | 1999     | 2007.06  |
| 9    | 通过     | 腾讯大地通途             | 互联网                  | 2005     | 2007.06  |
| 10   | 审核中   | 江苏省测绘工程院         | 事业单位                | 1984     | 2008.06  |
| 11   | 审核中   | 浙江省第一测绘院         | 事业单位                | 1975     | 2008.06  |
| 12   | 通过     | 江苏省基础地理信息中心   | 事业单位                | 2000     | 2017.10  |
| 13   |          | 光庭信息                 | 图商-已并入中海庭       | 2011     | 2013.06  |
| 14   | 已凉     | 滴滴-滴图科技            | 互联网                  | 2016     | 2017.10  |
| 15   |          | 上汽-中海庭              | 自动驾驶公司-整车OEM    | 2016     | 2018.08  |
| 16   | 审核中   | Momenta                  | 自动驾驶公司            | 2016     | 2018.08  |
| 17   | 审核中   | 宽凳科技                 | 图商-互联网             | 2016     | 2019.01  |
| 18   |          | 晶众地图                 | 图商                    | 2010     | 2019.05  |
| 19   |          | 江苏智途                 | 整车OEM-小鹏全资收购    | 2006     | 2019.05  |
| 20   | 通过     | 华为                     | 互联网                  | 2006     | 2019.06  |
| 21   | 通过     | 顺丰-丰图                | 互联网-物流             | 2018     | 2019.11  |
| 22   |          | 京东-物流                | 互联网-物流             | 2007     | 2020.01  |
| 23   | 通过     | 美团-美大智达            | 互联网                  | ?        | ?        |
| 24   | 通过     | 湖北亿咖通               | 整车OEM                 | ?        | ?        |
| 25   |          | 湖北省测绘科学技术研究院 | 事业单位                | ?        | ?        |
| 26   | 通过     | 沈阳美行科技             | 科大讯飞、腾讯持股      | ?        | ?        |
| 27   | 估计已凉 | 北京中交宇科             | 四维图新子公司          | 2008     | ?        |
| 28   | 通过     | 速度时空                 |                         | ?        | 2020.07  |
| 29   | 审核中   | 河北全道科技             |                         | 2018     | 2021.02  |
| 30   | 通过     | 航天宏图信息             |                         | ?        | 2022.05  |
| 31   | 通过     | 辽宁宏图创展             |                         | ?        | 2022.05  |


**1.6.2 厂商情况**

对具有甲级测绘资质的单位进行分类，可以分为**传统图商、互联网公司、政府部门、自动驾驶公司**、以及**车企OEM**构成。

![img](https://pic2.zhimg.com/80/v2-b54f7cf0738317501dd9e023076ca449_1440w.webp)

国内外主要厂商

**1. 国外厂商：**

由于测绘法例的限制，国外图商无法进入中国市场，这对于国内的图上而言是一个利好消息。当然也有与国内图商合作运作JV的模式，比如四维和Here成立了合资公司，但此种模式很少见。

**2. 传统图商：**

重点关注：**高德（阿里全资），四维图新，易图通。**

此类厂商大多由2D地图业务起家，行业年限较长，普遍在车载前装导航领域占有一定份额。当前，各家图商基本上也将未来瞄准了高精地图方向。其中高德是业界最强，其建设里程，精度，自动化效率，更新频次都处于第一梯队，也因此拿到了最多的量产订单。

**3. 互联网 & 科技公司：**

重点关注：**百度，腾讯大地通途，华为。**

百度Apollo建图的自动化程度很高，精度亦不差，因此拿到的订单数量仅次于高德。大地通途和华为在地图领域的经验略显不足，但由于资金和人才储备都比较雄厚，因此增长速度比较快。例如，目前蔚来好几个项目的HDmap定点已经由百度切换到腾讯。至于顺丰、滴滴、美团、京东的地图部门，更多的是为了自家的运输业务而服务，目前来看，还没有进入主机厂供应体系的意愿。

传统图商与互联网公司在资本上互有往来，比如身为传统图商的高德是阿里系企业，腾讯则握有四维图新11.28%股权。

**4. 智驾公司 与 OEM子公司：**

重点关注：**Momenta**（2022资质复审还没结果）

此类公司的目标一般是**“全栈式研发自动驾驶方案”**，高精地图则是其中的一块拼图。比如最近紧靠上汽的Momenta，**上汽**控股中海庭，**吉利**控股的亿咖通，**小鹏**2021年7月全资收购的智途科技（这个是一个垃圾传统图商，小鹏出资2.5亿基本是为了采集资质，但让人笑掉大牙的是2022年其资质复审没通过），**小米**在2021年收购的深动科技DeepMotion（该创业公司并不具备采集资质）。这些公司在商业订单上会依靠母公司存在一定优势，毕竟OEM大部分时候更加倾向于使用与其存在资本关联企业的高精地图。在研发过程中，HDmap与自动驾驶系统的融合也会更好。

国外公司的此种趋势更为明显，比如DeepMap被Nvidia收购，Here被戴姆勒、宝马、奥迪三家持股，Mobileye被Intel收购。 但自动驾驶公司的研发重心仍然在自动驾驶算法，OEM的重心在于整车，对于高精地图这一细分基础设施，其在专业性以及资源投入上应当不是那么专精的。

**5. 政府事业单位：**

技术能力较弱，基本也不从事自动驾驶高精地图的绘制，因此不予考虑。
综上，其优势与劣势如下：

|            | 资金   | 专业性 | 采集成本 | 众包成本 | 法务风险 | 总结                                     |
| ---------- | ------ | ------ | -------- | -------- | -------- | ---------------------------------------- |
| 传统图商   | 较充足 | 最高   | 较低     | 偏高     | 较小     | 经验丰富、流程规范，与互联网公司存在关联 |
| 互联网公司 | 极充足 | 最低   | 较高     | 较低     | 中等     | 资金充足、算法能力强                     |
| 智驾公司   | 一般   | 中等   | 较高     | 中等     | 中等     | 更多关注自动驾驶，高精地图能力存疑       |

因此，当前在高精地图市场最具竞争力的仍然是**图商**和**互联网&科技公司，**各大主机厂的采购定点情况也证明了这点。 当前，各家图商的高精地图主要建设情况如下表所示（数据来源于互联网，2022年情况，不保证失效行）：

|              | 高精地图建设情况                | 精度质量                                     | 已有客户                                                     | 高精定位 | 云平台 |
| ------------ | ------------------------------- | -------------------------------------------- | ------------------------------------------------------------ | -------- | ------ |
| 高德         | 全国高速+城市快速路             | 水平相对精度5~7cm；高程相对误差4cm           | 量产项目：上汽通用、理想、小鹏、长城 定点项目：东风、吉利、广汽等 | 千寻位置 | 阿里   |
| 百度         | 全国高速+城市快速路             | 相对进度10cm                                 | 量产项目：蔚来、广汽埃安 合作项目：江淮、奇瑞、长城、长安、沃尔沃、标志等 | /        | 百度   |
| 四维图新     | 全国高速+城市快速路             | 未知                                         | 定点项目：上汽集团、宝马、戴姆勒、沃尔沃                     | 六分科技 | 华为   |
| 腾讯大地通途 | 全国高速+城市快速路             |                                              | 定点项目：蔚来（替换百度）                                   |          |        |
| Momenta      | 全国高速+城市快速路（2021完成） | 未知，预计不会太高（中等精度硬件，无控制点） | 合作方：上汽集团                                             | 千寻位置 | 未知   |
| 滴图         | 未知                            | 未知                                         | 未知                                                         |          |        |
| 华为         | 高速、城快采集完毕              | 相对精度20cm                                 |                                                              | 打控制点 |        |
| 易图通       | 未知                            |                                              | 福特、一汽                                                   | 打控制点 |        |
| 宽凳科技     | 未知                            | 未知                                         | 广汽、现代                                                   |          |        |
| 中海庭       | 未知                            | 未知                                         | 上汽集团（母公司）                                           |          |        |



**1.6.3 市场分析：烧钱竞争阶段**

从市场来看，高德和百度在20年左右将单车/年的高精地图服务费用压到**100元**左右，基本是紧贴成本售卖，已经有了一些恶性竞争的苗头。投资机构对未来高精地图的市场规模估计都在百亿以上，按照现在这个价格，意味着需要有超过一亿辆装备高精地图的车辆保有量——显然在短期内是很难达成的。

目前大部分厂商的想法是：不靠高精地图赚钱，而是靠售卖自动驾驶方案、硬件、以及捆绑的增值服务赚钱。不想评价这种模式的好坏，反正还是这么多年互联网经验的老套路。如果这种烧钱大战一直持续下去，那么对于专注于高精地图的中小型图商大概不算个好消息，能够与财大气粗的科技巨头、或者整车OEM建立资本关联大概会过的好一些。



## 2. 高精地图的构建

### 2.1 高精地图构建的方案

讲完高精地图宏观层面的信息，下面来阐述高精地图的构建方法。当前业界存在两种解决方案：

1. **专业采集：**基于高精度的专业采集设备和专业采集人员，经历一整套生产工艺流程后输出高精地图；
2. **众包采集：**用户通过自动驾驶车辆自身的图像传感器，或其他低成本的传感器硬件（Lidar），收集的道路数据，并上传到云端进行数据融合，通过数据聚合的方式提高数据精度，来完成高精地图的制作（该思想可类比为：用普通设备拍摄木星经叠加后亦可获得高质量的图像）。

云端再实时将高精地图返回给自动驾驶车辆使用，而在此过程中继续对地图进行迭代更新。**如此车辆既是地图的生产者、也是高精地图的使用者和更新者**，形成数据的闭环。

![img](https://pic1.zhimg.com/80/v2-2f26ce680b16f1f42b84b5dab31e0d00_1440w.webp)

木星的叠加

![img](https://pic2.zhimg.com/80/v2-8ec5042480aed4a2cf4a399f1ccd983d_1440w.webp)

众包建图的数据闭环

我们暂且按下众包采集不表，先来介绍**专业采集路线**的建图流程。构建高精地图的一般流程可拆分为：**数据采集（外业）**、**数据处理（中业）**、**人工验证（内业）**、最终的**地图发布、**以及后续的**地图更新。**

![img](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1527' height='723'></svg>)

高精地图的制作的一般流程，来自apollo

|                                                              | 具体过程                                                     | 备注                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 外业采集                                                     | 使用地图采集车辆，利用各种传感器（激光雷达，相机，组合导航等）采集道路信息，并回传 | 此过程耗费人力物力极大                                       |
| 中业预处理                                                   | 数据解算：对采集到的点云数据、组合导航数据进行后解算         | 软件：IE（Novatel），POSPAC（Applanix）                      |
| 底图构建：利用点云配准算法，结合组合导航数据，对激光点云进行拼接配准，生成底图。 | 该初始底图模板无任何语义信息。                               |                                                              |
| 要素分类与识别：基于深度学习方法，对3D点云与2D图像中的目标（如路牌、车道线、护栏等）进行分类、识别，提取道路各要素的语义信息。 | 可对点云、图像融合进行要素的识别提取                         |                                                              |
| 矢量化：将识别出的各道路要素抽象化为带有语义信息的点、线、面，并建立要素间的关联信息。 |                                                              |                                                              |
| 内业校正                                                     | 人工编辑：对预处理中误识别、漏识别的要素进行检查，并进行人工补全； | 该过程一般基于专门的“内业操作平台”，可保证自动地图创建正确、完备； |
| 质检：对生成高精地图进行人工验证；                           |                                                              |                                                              |
| 数据发布                                                     | 经过数据编译之后，输出标准格式地图                           | OpenDrive，NDS，或自主定义的格式；                           |
| 地图更新                                                     | 检测道路情况发生变化的路段，以一定周期更新和维护高精地图，保证地图的新鲜度 | 该过程难度较大，后面会详述；                                 |

上述为高精地图建图的笼统方案，事实上，**各家厂商的建图方案存在差异**，要描述这种差异，我们需要从高精地图的采集设备谈起。



### 2.2 高精地图的采集设备

高精地图测绘车辆配备的传感器种类与自动驾驶车辆并无本质性差异，核心的传感器都是：**激光雷达、相机、IMU、GNSS-RTK、**毫米波雷达等。其区别主要体现在：高精地图采集车一般配备昂贵的高精度传感器，但量产的自动驾驶车辆对于成本更加敏感，其采用的消费级传感器性能较低。

关于自动驾驶传感器，可参考：

![img](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1002' height='351'></svg>)

自动驾驶车辆硬件，来自Apollo

以上图百度Apollo的自动驾驶车辆为例，其配备的传感器及对应作用为：

| 硬件       | 作用                                                         |
| ---------- | ------------------------------------------------------------ |
| 激光雷达   | 采集反射点云，提供道路结构化数据；多采用精度最高，点云最为稠密的机械式激光雷达，成本在几十万到百万不等； 一般会有单线和多线，平装和斜装的区分。 |
| 相机       | 采集图像数据，提供道路语义数据。成本在万元到数十万不等。 一般有：前视相机，或者环视相机系统的区分。 |
| GNSS       | 提供全局的定位信息，一般搭配RTK使用，在开阔地带定位精度可达毫米级，但在山区、城市内的定位精度急剧下降，隧道内更是完全无法使用。 |
| IMU        | 由陀螺仪、加速度计、磁力计组成，测量局部位姿，高精地图采集车一般采用战术级的惯性传感器（IMU），价格在数十万到百万RMB，其GNSS离线1min后的定位精度一般在0.5m以内。 |
| 轮速计     | 根据轮速，提供位置信息冗余；                                 |
| 工控机     | 控制硬件采集，临时存储数据。                                 |
| 毫米波雷达 | 一般为自动驾驶决策提供辅助信息，对高精地图采集无作用         |

对于采集设备，非常重要的一点是**多传感器的联合标定**：**即将雷达、相机、IMU、GPS等所有的传感器纳入到统一的坐标系下。**例如，将同一位姿的激光点云投影到2D图像上，其误差应当控制在一定的范围内，这对于后续的数据融合十分重要。当设备经历重新拆装、甚至每次作业之前都需要对其进行重新标定。



**2.2.1 单线雷达斜置方案**

对于成本较高的**专业地图采集车**，大体上也有两种方案，其区别主要体现在**单线/ 多线**激光雷达上。较为传统测绘的点云获取方式一般是采用机械式单线激光雷达，代表生产厂商是奥地利Reigl。雷达斜置在车尾，转速高达200rps，随着车辆的前进，即可完成对道路的扫描。

![img](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1018' height='458'></svg>)

单线斜置激光雷达原理示意

单线雷达的优点是测量**精确度极高**，可达毫米级（这有利于对地面粗糙度等细节进行建模）；**点云也更为稠密**。Reigl还将雷达设备进行了整合集成，使其易于拆装，方便外业采集人员的操作。如下图即为高德地图的采集车。

![img](https://pic3.zhimg.com/80/v2-faaea514bf2642c577606eb8cd96016a_1440w.webp)

高德的单线雷达采集车辆

但此种方案的缺陷也极为突出，由于是单线扫描，其没有“帧-Frame”的概念，因此点云结构是依靠组合导航（GNSS+IMU）的输出作为真值进行拼合而成的，造成了以下问题：

1. 采集道路数据时，容易被其他车辆遮挡，造成数据报废；在复杂场景下，往往需要多次采集并选取效果最好的一次，其外业采集成本亦较高。
2. 难以使用SLAM或其他的基于点云的位姿预测方法。这使得在山区、隧道、城市峡谷等组合导航失效的场景下，无法进行位姿纠正，亦无法简单的合并上下行的数据。

![img](https://pic3.zhimg.com/80/v2-5c51f7397ac7ad0bd4b2e48139f93b92_1440w.webp)

单线雷达采集：道路数据被车辆遮挡

当前如高德、易图通、华为等为数不少的厂家仍然在使用单线雷达的方案（不限于单线），但许多厂商已经将后续研发重心转移至多线雷达方案。国际上，日本的ZENRIN，以及荷兰的TOMTOM，美国的Waymo均采用了多线雷达的建图方案。



**2.2.2 多线雷达平置方案**

多线雷达集成了更多的激光线束，其精度为厘米级，相较于单线雷达差一些，但对矢量化后的结果影响并不大。多线雷达拥有了“视角”的概念，其完成一周扫描即能够对视角内物体结构进行表达。而多线雷达在采集车上又有**平置**和**斜置**两种方式。

如下图为平置雷达方案，该放置方式的优点在于：

1. 能够获得最大的可视范围，对行进过程中的每一帧进行叠加后，基本能够消除绝大部分遮挡物所造成的影响，直接提升采集效率；
2. 更加重要的是，多线雷达的加入使得建图方案可以使用SLAM或者其他点云配准方法，利用道路的结构特性来对位姿进行估算，融合IMU的数据，以输出更精准的轨迹；
3. 当前，学界针对多线雷达点云数据的识别、分割算法做出了大量的研究。运用这些算法，可自动化对道路的要素进行自动化的提取，这大大提升了建图的效率，降低了后续的人力成本；
4. 在外参、时间戳经过校准的前提下，可对点云、图像进行融合，大幅提升道路要素提取的自动化程度。

![img](https://pic4.zhimg.com/80/v2-bf81004053b31102b9ceab385d4d9a6f_1440w.webp)

多线平置雷达方案示意

![img](https://pic1.zhimg.com/80/v2-27ce31e1c8f212d9e716172d3a2f66fc_1440w.webp)

平置多线雷达的一帧



**2.2.3 多线雷达斜置方案**

多线平置方案也有其缺陷，由于使视场角最大化，因此其点云就更加稀疏分散。一些道路重点目标，如路面标线、路面标志、交通标牌的点云就不够稠密。因此，业界目前主流方案是让多线雷达斜置，以对重点目标进行增稠的采集硬件方案。

但此种方式每帧点云重合度较小，很难利用SLAM算法做点云的配准。因此，一些时候，还会采用多线平置 + 多线斜置组合使用的方式。

![img](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1039' height='469'></svg>)

多线斜置雷达示意图

![img](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1477' height='621'></svg>)

百度Apollo的斜置激光雷达采集车

![img](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1111' height='589'></svg>)

80线斜置雷达的稠密点云——路牌，路面

**Ref：**

1. [【SHU你不易，其实你很“牛”】高德地图数据采集员：“丈量中国”的老司机-新华网 (xinhuanet.com)](https://link.zhihu.com/?target=http%3A//www.xinhuanet.com/2021-02/07/c_1127075877.htm)
2. [高德数据生产基地探秘：地图是如何“活”起来的|高德|地图|数据中心_新浪科技_新浪网 (sina.com.cn)](https://link.zhihu.com/?target=http%3A//tech.sina.com.cn/i/2016-12-27/doc-ifxyxury8859785.shtml)
3. [回头率完爆超跑 聊百度高精地图采集车-爱卡汽车 (xcar.com.cn)](https://link.zhihu.com/?target=https%3A//info.xcar.com.cn/201708/news_1984327_1.html%3Fviewtype%3Dall)
4. [地图采集车的那些事 | 载车篇-阿里云开发者社区 (aliyun.com)](https://link.zhihu.com/?target=https%3A//developer.aliyun.com/article/783769)
5. [高精地图采集 与 数据预处理 方案分析 2022.03.16](https://link.zhihu.com/?target=https%3A//luokuang.feishu.cn/docs/doccnz3D0CR4ALN5bbp744mGEBb)



### 2.3 数据处理的Pipeline

高精地图的生产是逻辑较为清晰的流水线模式，而如何在保证地图质量的基础上**提升效率**并**降低成本**就是当前各大图商关注的重点。当前建图最主要的人力、物力成本在于**外业采集**和**内业处理**。对于外业采集，当前能够大幅削减成本的方法并不多，毕竟采集车的数量总得够，司机的工资和油钱也是一大笔开支。

而在后续的处理过程中，自动化建图则是一个重要方向：即使用基于人工智能的算法对图像、点云进行处理，识别并提取道路要素，最终直接输出附有语义的矢量化结果。后续人工仅需要对误识别、漏识别的要素进行检查并补全即可。这也是当前各大图商的主要着力点——AI算法能够大幅提升建图的自动化程度，减少建图所消耗的人力成本，从而获得更高的市场竞争力。



**2.3.1 多源底图生成**

数据完成采集后，首先对LiDAR数据（PCD）进行解压。而后利用Inertial Explorer（Novatel）或Pospac（Applanix）对位姿进行后解算。特别地，点云、图像以及位姿有着严格的时间戳。接下来则需要对连续采集的激光点云进行拼接，使之成为**高精地图底图**。其需要具备以下性质：

| 相对精度 | 保证地图局部结构的平滑和连续度                           |
| -------- | -------------------------------------------------------- |
| 绝对精度 | 保证地图全局结构及位置的准确度                           |
| 完整度   | 能够完整地对环境进行重建，以能提供高精地图所需的不同要素 |

具体地，底图的生成有以下几种思路：

**1. 以组合导航的输出作为真值，直接将LiDAR输出点云进行拼合：**

此种情况多用于前述单线激光雷达采集方案，受限于数据特性，无法对点云数据做出处理。因此，当组合导航输出不稳定时，其底图会存在跳变。当进入山区、城市峡谷地带时，底图与实际的偏差会很大。这种方式直接放弃了多线雷达数据中包含的位姿信息。



**2. 利用点云配准算法，对雷达点云进行配准：**

此方法仅在多线雷达数据上可用。其原理是：前后两帧点云存在一定程度的重合，利用重合的部分，即可对每一帧点云进行合并，生成一张完整的底图，并给出每一帧对应的位姿。此方法利用了点云自身的结构化信息，其具体算法可以是ICP、NDT等传统配准算法，还可以是一些离线的SLAM算法，如LOAM系列（LOAM、A-LOAM、Lego-LOAM等）。

此种方法没有利用组合导航的输出数据，而随着距离的增加，会出现严重的漂移失真。因此，该方法仅在组合导航完全失效的场景下发挥一定作用。



**3. 融合LiDAR+GNSS+IMU的离线SLAM系统：**

该方法对上述两种思路进行融合，同时利用点云的结构信息和组合导航的输出，保障了底图的绝对精度以及局部的平滑、连续性，极大提升了建图的鲁棒性。具体算法可以是LIO-SAM等算法框架。该方法应当是当前的主流方案

![img](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1874' height='613'></svg>)

LIO-SAM 算法框架



**4. 融合LiDAR+Camera+GNSS+IMU的多源SLAM系统：**

由于激光雷达无法获知纹理信息，因此在结构重复场景下容易存在退化失效风险。因此，在上一种方法的基础上，融合360°的环视视觉信息，组成多源融合的SLAM系统，则可进一步提升底图建图的精度和鲁棒性。该方法是将来算法团队要达成的方向，具体算法框架如LVI-SAM、R3-LIVE等。

![img](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='877' height='468'></svg>)

多源融合的SLAM系统



**2.3.2 多模态的智能感知**

建图过程中另一大重要板块是对**地图要素的识别和提取**，包含路面标线与标识、非地面要素的路牌、交通信号灯、杆状物、路缘、护栏、建筑等要素。 具体可拆分为以下部分：

**1. 3D点云、2D图像数据的语义分割：**

具备深度的3D点云提供了各物体丰富的轮廓几何信息，利用深度学习方法对3D点云中的目标进行自动化分类、识别，即可自动化提取道路要素的语义信息。

![img](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1125' height='557'></svg>)

3D点云语义分割样例

但对于带更丰富的颜色、纹理信息的目标，例如写有数字/汉字的路牌，白/ 黄色的车道线，仅依靠点云是无法识别的，因此需要通过对图像的识别提供更为丰富的语义信息。再比如当车道线发生磨损，激光反射率不足以在点云中形成可辩信息的情况下，图像亦能提供良好的辅助。

![img](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1787' height='989'></svg>)

2D图像提供更丰富的语义信息

![img](https://pic3.zhimg.com/80/v2-c70393d2a1ef9bd2f43c4e040647720a_1440w.webp)

2D图像语义分割样例

**2. 多传感器的融合：**

对图像、点云分别进行识别后，需要将两个结果融合。利用严格校准后的外参，将2D图像投影到3D点云，并对元素进行一定程度的跟踪和补全之后，即可得到带有**精细语义的点云数据**。通俗的讲：此时3D点云中每一个point都带有对应的Label，指示其属性（如车道线/护栏/路牌...）、类别（限速牌/指示牌/警告牌/禁止牌）、值（80）；

![img](https://pic2.zhimg.com/80/v2-eb4c3be2d1af0b5ddaf216394a90775d_1440w.webp)

详细语义点云

上述的融合方式是一种“松耦合”的融合方式，而另一种“紧耦合”的方式则是将3D点云、2D图像导入一个模型，实现类似于end to end的输出，该种方法当前还不够成熟。



**3. 点云要素的矢量化（vectorization）；**

该过程是通过点云矢量化算法，将精细语义的点云转化为带有语义信息的点、线、面，即用这些带有语义的矢量化数据表达道路中的各项要素。然后建立各要素之间的关联信息，生成结构化的道路数据。

![img](https://pic1.zhimg.com/80/v2-05f5da6cfb7ff8e15d676303e60a4064_1440w.webp)

矢量化后的高精地图样例


**2.3.3 人工校正与质检**

经历上述步骤，高精地图已经具备雏形，但仍然存在一些问题——在现有技术基础下，自动化的要素识别、提取、乃至矢量化算法的精确度与召回率很难达到100%，特别是在道路情况较为复杂的情况下，出现漏识别、误识别、属性关联错误的情况就会更多，此时就需要人工补齐、校正这些短板。同时，对于自动识别但置信度较低的目标，也应当进行人工的质检环节，最终使得高精地图的准确性、完备性达到可商用的程度。

上述过程即为高精地图生产的“内业”，而组织内业生产则需要具备以下要素：

1. 以上作业过程，需要基于专为高精地图生产而定制开发的可视化**“高精地图生产平台”**，集成GIS模块，前述的智能感知模块等，以提升相关作业效率。
2. 内业生产需要严格统一的**《高精地图生产工艺》**作为指导。此工艺涵盖了高精地图的**数据表达格式、工艺流程、生产组织方案、**以及**质检逻辑，**以最大限度的保证高精地图的质量，提升生产效率。同时，地图的**数据表达格式**对于前面的智能感知至关重要。
3. 高精地图内业生产涉及较多的人力投入，对生产人员的培训、组织、管理水平很大程度上影响地图的生产效率，以及地图的最终质量。



**2.3.4 数据的交付**

上述生成的高精地图格式可能是原始的数据格式，而交付前则需要转换为一个**通用的、自动驾驶系统可以使用的**格式，也就是前面所提到的《高精地图标准》。这么做的道理很简单，如果每一个图商、OEM之间的地图数据格式不一样，实际使用过程中会带来很多兼容性问题，额外花费很多成本。
当前业界主流的高精地图格式是NDS，OpenDrive格式，因此，高精地图生产平台也需要具备编译、导出这些格式地图的功能。经由国家相关测绘部门进行审核后，即可交付给用户。

![img](https://pic3.zhimg.com/80/v2-40249fe3ad627183a5589cc57b33b9aa_1440w.webp)

OpenDrive Format样例



**2.3.5 想法：SLAM & 感知 紧耦合的建图Pipeline**

智能感知的结果可以为SLAM系统提供**更加精确的特征匹配**结果，从而得到更加精确的位姿输出；同时，SLAM系统输出的位姿则可以为感知系统提供**多帧间信息融合**的基础。因此，可以建立一种**SLAM & 感知紧耦合的自动化建图系统**，其Pipeline如下图所示：

![img](https://pic1.zhimg.com/80/v2-c0a2c8a58c466e1fdda1cfe616cde42c_1440w.webp)

后续的建图Pipeline

### 2.4 高精地图的更新

现实中，道路处于不断的变化当中，例如一些地方会重新粉刷地面标线、地面标识，树立新的标牌、路灯杆等，每年我国也会新修建大量的公路。如此一来，之前采集的数据就变得“陈旧”，就需要及时地对地图进行更新，使其更加“新鲜”。

使用高精采集车重新对所有道路采集一遍显然是不经济的。更为普遍的做法有几种：

\1. 采用相对廉价的**专业更新车**来采集路面信息的局部变化，然后对数据进行差分融合计算，完成地图更新，高德地图即部分采用了此种方案。

\2. 利用自动驾驶车辆的感知设备，发现路面信息的变化，然后派遣高精地图采集车辆去对应路段采集作业，完成地图更新，本文下方高德在Super Cruise项目中即采用该种方式迭代高精地图数据。该方案中，关键数据掌握在甲方手中，较长的信息链条使得该方式效率略低。

![img](https://pic1.zhimg.com/80/v2-ca0ff58bf1805759b2c002df6667d644_1440w.webp)

高精地图的更新模式，From ZENRIN

以上两种更新方式均需要高精地图采集车辆前往对应地点对道路重新采集，其效率较低，其极限只能维持月度更新，完全做不到高精地图定义中所谓的 “动态要素的实时更新”。

\3. 采用更为廉价的**众包设备，**结合车端算力进行众包建图与更新，实现实时的地图更新，下一章节详述。



## 3. 众包建图

**讲完基于专业采集车的建图方案，下面来讨论众包建图。**

众包车辆采用的传感器种类基本与专业采集车一致，仍然是GNSS+IMU+LiDAR+Camera等，但其采用的多是低成本的传感器，采集数据的精度也会比较低。一些厂商的方案则干脆舍弃LiDAR，采用纯视觉的方案进行众包建图（当然，目前来看各大新势力整车厂新发布的车型全部带有千元级别的半固态Lidar，可以较低成本获得环境的结构信息）。另外，众包采集车需要在车端对采集数据进行一定程度的处理，因而需要一定的车端算力。

因此，理论上**许多预埋了Camera、Lidar、高算力芯片的量产车型都可以作为众包建图车辆**——例如理想L9搭载的禾赛AT128芯片出点速率可达150W/s，蔚来ET7采用4片Nvidia Orin芯片，算力超过1000TOPS。

|      | 专业采集车                                            | 众包采集车                                            |
| ---- | ----------------------------------------------------- | ----------------------------------------------------- |
| 硬件 | 高精度Lidar+Camera+战术级组合导航；对车端算力不做要求 | 消费级Lidar+Camera+消费级组合导航；车端算力（AI芯片） |
| 精度 | 10cm内                                                | 10cm-50cm                                             |
| 成本 | >200万                                                | 千元级采集硬件                                        |

![img](https://pic1.zhimg.com/80/v2-7dabe16bd06b522a5636066e6c6d9200_1440w.webp)

蔚来ET7，配备众多传感器



### 3.1 众包建图的优劣势

**3.1.1 专业建图 vs 众包建图**

下表是对众包路线和专业采集路线较为客观的对比：

| 方案 | 专业采集车路线                                               | 众包路线                                                     |
| ---- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 优点 | 1. 硬件完善，精度高，单次作业可采集到完整道路信息； 2. 作业精度高，配合定位基站，单次作业即可满足精度需求； 3. 专业人员采集，通过作业前规划与作业后检查，可满足道路完备性要求； | 1. 硬件成本低，可在民用、商用车辆实现海量部署； 2. 可利用车端算力，完成结构化数据处理，快速发现变化，并将其回传； 3. 单条道路多次采集后，通过大数据即可建立起统计学模型，保障采集地图的准确性； 4. 设备覆盖率达到一定程度，用户既是高精地图的使用者，亦是高精地图的生产者，形成服务闭环。 |
| 缺点 | 1. 硬件成本极高，使用门槛较高，无法规模化； 2. 采集数据难以在车端进行处理，需要专门的内业生产； 3. 对于发生变化的道路，无法做到及时的更新； 4. 需要后解算保障精度，地图采集、预处理、编译、审核、发布周期较长，无法实时更新。 | 1. 没有人力纠正，对算法要求极高，工程化链条更长； 2. 单条道路必须有足够的采集次数，现实中许多地区的覆盖次数不达标； 3. 涉及敏感信息的采集和传输等法律问题； 4. 海量信息的传输需要的流量通道，对存储、算力亦是极大的挑战。 |

如仅仅罗列上述优缺点，很容易迷失在文字中，难以抓住重点。我们不妨回归用户对高精地图的需求，即**准确度、覆盖度、新鲜度、以及成本，**来分析讨论众包方案与专业采集方案。

**1. 精确度：**

专业采集车的硬件完善，测绘精度高，配合定位基站，单次或数次作业即可采集到完整的道路信息。作为当前建图的主流方案，其精确度是有商用的落地产品作为事实支撑的，例如百度Apollo的相对精度可达20cm以内，而高德的相对精度更是达到了5cm。

对于众包采集，通过对同一路段的多次采集，通过大数据建立起统计学模型，从理论上是能够保障地图的精确度的。不过，现实中许多较偏远地区的道路可能存在“覆盖次数不达标”的问题，这部分精度也就无法保证。

**2. 覆盖度 & 新鲜度：**

截至2020年底，中国的公路总里程达到了520多万公里，其中高快速约35万公里。对于用户而言，必然期望地图覆盖面能够尽可能广，新鲜度尽可能高。而用专业采集车来保障地图数据的新鲜度是不大现实的，其成本实在是太高。事实上，当前头部图商仅仅维持全国高快速公路季度级的更新，其测绘资源已经捉襟见肘。

而众包路线则在地图的实时更新上具备无可比拟的优势。通过前面的描述，当众包车辆“发现”道路发生变化，即可将该“变化”传回云端，当一定数量的车辆均发现这一情报时，云端系统即可采信这一情报，对地图做出更新。**事实上，当前全球搭载mobileye设备的车辆每天可以完成数百万公里的道路数据采集，还可以对道路的实时路况进行更新。**

**3. 成本：**

专业采集方案的成本主要有两方面：其一是建立单车成本高昂的专业采集车队，并维持其日常采集作业的开销；其二则是建立并维持内业生产线/ 生产团队的运转。后者随着人工智能技术的发展，自动化技术的提升，其成本会逐渐下降。

而对于众包方案，**其生产的数据只是日常交通行为的副产品**。其成本主要体现在数据的流量费用，以及云端计算平台的建设和运转的成本。当然，这两部分的建设运营成本倒也未见得有多低。以目前的业界进展来看，成本不太会是制约高精地图落地的主要因素。



**3.1.2 众包采集的前提与难点**

可以说，众包建图描绘的愿景是非常诱人的：其实时性、以及建图-用图-更新的闭环逻辑在理论上都是成立的。
不过事实上，当前各大图商对众包方案的商业化落地仍然比较缓慢，这是因为众包建图必须解决以下关键问题：

1. **算法层面：**

专业采集数据与众包的道路数据识别、提取的算法基于的原理并无本质性区别。当前，**高精地图生产过程中的自动化算法准确率难以达到100%，仍然需要人力对错误和遗漏进行纠正，**以保障地图质量。特别地，对于场景较为复杂的道路，自动化识别模型的性能会进一步降低。

而在众包方案的设想下，则是要完全摒除人力的参与，依靠算法来实现，这对于车端算法的性能和鲁棒性要求极高，并且对于低质量的数据，要有算法来进行判定是否丢弃——换言之，如果算法的准确率不高，就算建了一大片图，其质量不一定保证可用。另外，在云端对海量数据进行聚合、对齐算法同样是一项难度和复杂度极高的任务。

**2. 工程层面：**

首先，众包建图涉及到**算法在车端的实现、众包数据的云端回传、云端新鲜地图的实时下载、以及算法的OTA更新迭代**。这绝非仅仅是“软件算法的开发”，还需要对汽车硬件有深度理解和权限（但整车厂基本不愿意对供应商开放此权限）。其次，众包方案还涉及数据上传、云计算、地图的云端分发等技术，涉及大量车辆的情况使得众包建图有许多困难的工程问题，需要堆大量人力和资源去攻克。

**3. 商业化问题：**

一般情况下，众包车辆的传感方案，甚至细化到传感器的规格、布置都需要尽可能统一。制定“标准化”的采集方案并推行至海量的量产车型上，对于一般的商业公司并非易事。由于涉及面更广，建图方案的验证、迭代难度也更大。

在这方面，拥有大量运营车辆资源的商业公司，如滴滴、顺丰，以及各家自动驾驶厂商、主机厂则具备得天独厚的优势。只要在其运营车辆或量产车型加装统一规格的采集设备，即可以极低的成本得到海量道路数据。事实亦是如此，此类厂商皆倾向于发展基于众包的高精地图。在此领域，传统的图商反而相对比较劣势，其很难拿到相应的商业资源。

**4. 法律问题：**

另外，如第1章所说，采集高精地图需要《地图甲级测绘资质》，且测绘车辆必须经过严格的报备、审核流程才能够上路。换言之，当前使用众包车辆采集并回传地理信息的行为可能游走在法律的灰色地带。尽管不少厂商暗里一直在收集道路数据，但这类事情始终没有放到明面上来。如理想申请了**乙级互联网地图服务资质**并获批，是否明确可以进行类似众包建图的行为没有明确界定。未来相关部门是否会对众包领域加以限制，仍然并不明朗。

**5. 结论：**

个人认为，**实现众包建图的难点并不在于算法有多么高深，而是其整体的研发链路较长，涉及的工程问题也更多、更广，对各种资源的整合能力要求也更高。尽管在这个闭环体系建成后的整体运行成本较低，但并不代表该体系的建设成本也低。**相比之下，当前阶段专业采集方案更为简单直接，对外部资源的依赖也少得多——搞定采集设备、采集资质、建图算法，拉一个内业和外业的团队，基本就能够开始地图作业了。



### 3.2 众包起源：Mobileye REM（Road Experience Management）

早期的高精地图采集都沿用第2节所讲的“百万级的专业采集车方案”。而在2016年的CVPR会议，Mobileye公司CEO Amnon Shashua在大会报告中提出了REM——Road Experience Management的概念（见下方链接），**即利用搭载摄像头的、众多行驶在道路上的车辆构建高精地图的方案。**这应当是最早的纯视觉众包建图概念的起源，后来者基本都是模仿Mobileye的模式。

![img](https://pic1.zhimg.com/80/v2-fa7342f05c03e0ae36e0b66104cc19e0_1440w.webp)

Mobileye REM众包建图流程

**ME硬件：摄像头 + 普通GPS；**

**ME众包建图的具体步骤如下：**

| 步骤                       | 说明                                                         |
| -------------------------- | ------------------------------------------------------------ |
| Data Collection            | 装备Mobileye自家硬件的车辆在运行时即可采集相关道路数据（Eye Q4都带有REM相关功能） |
| Identifying & Transmitting | 车端计算平台提取有效信息并以“带有语义信息的点”的形式回传云端，该过程会被匿名化并加密，数据量仅有10kb/km（通过3G网络即可上传） |
| Aggregation & Alignment    | 不同车辆在同一路段采集到的数据被聚合、对齐（通过神经网络模型） |
| Modeling                   | 对齐后，算法自动生成道路对象的精确轮廓                       |
| Semantic Identification    | 生成道路对象的语义，以及其影响的范围                         |
| Mobileye Roadbook          | 最终道路数据被汇总到名为Mobileye RoadBook的库中。而REM不仅仅包含了静态的高精地图数据，实时的动态路况（水洼、道路裂纹、凹凸）、甚至“车辆在该路段的驾驶行为”也被包含在内。 |
| Localization               | 云端进行瓦片式下发地图数据给车辆，用来定位以及其他自动驾驶应用 |

[Mobileye Mapping - Road Experience Management™ - YouTube](https://link.zhihu.com/?target=https%3A//www.youtube.com/watch%3Fv%3DhoC40qS4p20) 该Demo较好的展示了ME-REM的产品特性，推荐观看。

从Mobileye发布的专利**《US9665100 - Sparse map for autonomous vehicle navigation》**（见下方链接）比较完整地阐述了其众包建图的架构以及具体流程。其对于核心算法公开不多，个人理解其算法所基于的方法论与主流的图像识别、分割算法不会存在本质差异。**由于其采用的是普通GPS，其绝对精度应该比较低，其相对精度基本能保持在10cm以内，从Demo中“地图重新投影到camera数据”的结果看基本属实。**

**在实现REM工程落地方面，Mobileye的先天优势有：**

1. ME的视觉识别算法十分强大，属于第一梯队；
2. 在过去的数年中，ME始终都是最大的ADAS整体方案（芯片+算法+摄像头）供应商，例如2021年其Eye Q4、Q5系列方案出货量2810万片。ME可以利用其硬件内嵌的算法对全球范围内的道路数据进行采集，实现REM的建设。

在众包地图的建设上，Mobileye的执行力很强，其与宝马（主要采集北美+欧洲地图）、日产（主要采集日本地图）、大众（主要采集欧洲地图）、福特、蔚来展开合作（尽管21年开始众多OEM开始抛弃mobileye的黑盒方案，转而使用Nvidia、高通等厂商的芯片）。在2020Q1已经完成对欧洲、日本全部道路的覆盖，2020年底已经完成对美国大部分区域的覆盖。在2021年，ME收集到了**17.5亿公里**的全球道路数据。目前只需要24小时，Mobileye的众包车辆即可对日本的地图完成一次采集。

而在中国，受制于测绘法律，目前明面上Mobileye没有展示对中国数据的采集。但其与蔚来、理想、吉利、上汽等一众OEM以及四维图新、紫光都有过合作，是否已经对中国数据进行采集不得而知。（可参考[高精度地图的中国战事，一切才刚刚开始 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/165651511)的分析）

![img](data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1568' height='875'></svg>)

ME RaodBook的建设情况——全球

而在2022年CES消费电子展上，mobileye介绍了其REM的最新进展（见下方链接），并展示了搭载mobileye硬件设备的车辆实时利用REM地图执行自动驾驶、并且回传地图数据的Demo。**在商业化方面，大众最新的ID.4 Travel Assist 2.5辅助驾驶系统将会成为首个搭载REM众包地图的量产方案**（见下方链接），**日产的ProPilot也会搭载ME的REM系统。**

![img](https://pic1.zhimg.com/80/v2-1c4bf9ec1cd57baddd8429277bda57c0_1440w.webp)

Mobileye利用REM自动驾驶的Demo

**Ref：**ME的产品特性、方案介绍以及Demo较为全面，尽管底层技术涉及较少，仍然推荐了解以下内容。
**概念：**2016CVPR报告（40:00开始） [Amnon Shashua CVPR 2016 keynote: Autonomous Driving, Computer Vision and Machine Learning - YouTube](https://link.zhihu.com/?target=https%3A//www.youtube.com/watch%3Fv%3Dn8T7A3wqH3Q)
**专利：**[US9665100B2 - Sparse map for autonomous vehicle navigation - Google Patents](https://link.zhihu.com/?target=https%3A//patents.google.com/patent/US9665100B2/en)
**专利解读：**[(18条消息) Mobileye专利 US9665100 - Sparse map for autonomous vehicle navigation 吐血整理_neroyouqiang的博客-CSDN博客](https://link.zhihu.com/?target=https%3A//blog.csdn.net/weixin_40131652/article/details/104283046)
**官网：**[Mobileye REM™ - Road Experience Management](https://link.zhihu.com/?target=https%3A//www.mobileye.com/technology/rem/)
**官方Demo：**[Live Traffic Demo | Mobileye Data Services](https://link.zhihu.com/?target=https%3A//www.mobileye.com/en/data/live-traffic-demo/live/)
**官方介绍：**[Mobileye Mapping - Road Experience Management™ - YouTube](https://link.zhihu.com/?target=https%3A//www.youtube.com/watch%3Fv%3DhoC40qS4p20)
[Amnon Shashua & Herbert Diess: Volkswagen Group applies REM™ mapping tech to ADAS globally - YouTube](https://link.zhihu.com/?target=https%3A//www.youtube.com/watch%3Fv%3DSnJXdfrybLI)（VW ID4量产REM）
[CES 2021: Under the Hood with Professor Amnon Shashua - YouTube](https://link.zhihu.com/?target=https%3A//www.youtube.com/watch%3Fv%3DB7YNj66GxRA%26t%3D301s)（2021进展）
[Mobileye CES2022 CEO 分享 REM 众包地图的最新进展 | CNET_哔哩哔哩_bilibili](https://link.zhihu.com/?target=https%3A//www.bilibili.com/video/BV1rb4y1e7mB%3Fspm_id_from%3D333.337.search-card.all.click%26vd_source%3Df6a6eca87c96a71ae167de404df806bb)
[Mobileye的自动驾驶地图技术 英文字幕_哔哩哔哩_bilibili](https://link.zhihu.com/?target=https%3A//www.bilibili.com/video/BV1PK411G7Hg/%3Fvd_source%3Df6a6eca87c96a71ae167de404df806bb)**（30分钟详细介绍，推荐观看）**
**其他介绍：**
[Mobileye 的地图攻势 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/95853555)
[(18条消息) Mobileye REM地图如何解决高精地图落地难点_瞻邈的博客-CSDN博客_rem地图](https://link.zhihu.com/?target=https%3A//blog.csdn.net/xhtchina/article/details/113795217)（介绍ME如何解决Align问题）



### 3.3 Nvidia Drive Map（重要）

笔者每次看Nvidia的方案，都有一种跪着看的感觉，Nvidia实在给业界带来了太多惊喜：**算力高达254TOPS的Orin自动驾驶芯片，基于Omniverse的Drive Constellation自动驾驶仿真方案，Hyperion 9自动驾驶平台，软硬件全包的技术能力，开放合作的态度**......都足以给业界的其他厂商带来窒息般压迫，给从业人员带来坐井观天的自卑感。

2021年8月，Nvidia完成了对高精地图厂商DeepMap的收购，并以极快的速度完成了对其技术的整合。2022年3月的GTC大会上，Nvidia宣布Orin芯片量产的同时，推出了Hyperion 9自动驾驶平台以及**包含的DRIVE Map多模态地图引擎。**
Drive Map包含了**两个地图引擎**，真值测绘地图引擎（DeepMap）以及众包地图引擎。前者用于自采数据，而后者引入了第三方数据。

| 地图引擎 | 特点                                                         |
| -------- | ------------------------------------------------------------ |
| 真值地图 | 利用专业的数据采集车辆，使用Camera、激光雷达、雷达、和差分GNSS、IMU等传感器创建地图，可实现5cm的精度。这主要使用收购的DeepMap的技术。真值地图也可以采用其他供应商的地图，给客户选择权。 |
| 众包地图 | DRIVE Map 基于真值地图和海量众包数据，利用装备了DRIVE Hyperion中DRIVE Perception软件处理的数据流，包含道路要素的语义信息。介绍中并没有提到真值和众包的融合，但推测应该可以实现对地图的更新。 |

Nvidia计划在2024年前，使用专业车队采集北美、西欧和亚洲的主要道路，总里程约50万km（并不多），而这些数据将被导入到NVIDIA Omniverse中**搭建仿真场景&数字孪生**，用于训练其自动驾驶引擎。（关于Nvidia的自动驾驶仿真技术以及基于高精地图的场景还原，我后面会写一篇关于自动驾驶仿真有关的文章 ）

![img](https://pic3.zhimg.com/80/v2-8d758c8f48a8f0b3e69c6f439fa89b8a_1440w.webp)

Nvidia Drive map众包建图架构

![img](https://pic4.zhimg.com/80/v2-06bbca4bd3a8c900785ebfd8bc1736d7_1440w.webp)

地图采集，From 2022GTC

技术角度看，Nvidia的方案并没有什么重大理论创新，基本都是业界主流的方案。但就结果来看，Nvidia只用了较短的时间就完成了自动驾驶硬件-众包建图-仿真场景的打通，展现出了极其强悍的技术整合能力和工程能力。

**Ref：**
**官网：**[NVIDIA DRIVE Mapping | NVIDIA Developer](https://link.zhihu.com/?target=https%3A//developer.nvidia.com/drive/drive-mapping)
[End-to-end HD Mapping for Self-Driving Cars | NVIDIA Automotive](https://link.zhihu.com/?target=https%3A//www.nvidia.com/en-us/self-driving-cars/hd-mapping/)
**GTC2022：**[GTC 2022 Keynote with NVIDIA CEO Jensen Huang - YouTube](https://link.zhihu.com/?target=https%3A//www.youtube.com/watch%3Fv%3D39ubNuxnrK8)（1:09开始）
**定位Demo：**[NVIDIA DRIVE Labs Ep. 17: Localization Helps Self-Driving Cars Find Their Way - YouTube](https://link.zhihu.com/?target=https%3A//www.youtube.com/watch%3Fv%3DjcKnb65wpWA)
**介绍：**
[英伟达推出地图产品 Drive Map，用于自动驾驶汽车行业，该产品都有哪些值得关注的亮点？ - 知乎 (zhihu.com)](https://www.zhihu.com/question/523643804)
[英伟达发布Hyperion 9计算平台和DRIVE Map地图引擎 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/486250488)



### 3.4 国内厂商方案

**3.4.1 众包建图方案：华为车BU**

下面以华为车BU团队发表在ICRA2021论文**《RoadMap: A Light-Weight Semantic Map for Visual Localization towards Autonomous Driving》**为例，介绍高精地图的众包方案的架构逻辑。众包建图可以分为**车端**和**云端**两个模块：

**1. 车端：**

首先，众包车辆是地图地生产者，众包车辆会产生海量的原始数据，将其全部回传在当前是不太现实的。因此，一般的思路是在车端对这些数据做一个很小的局部融合，然后将这个较小的融合数据传到云端。一来可以充分利用车端的算力，二来节省上传的流量费用。

![img](https://pic2.zhimg.com/80/v2-e62f30e59b63932eaa14f1612fe2a951_1440w.webp)

Raw Image 、Segmentation Image

![img](https://pic3.zhimg.com/80/v2-a362235c74fdee97db4e27bfc1c12f22_1440w.webp)

Semantic Map 、Recovered Semantic Map

**2. 云端：**

云端需配备大型的服务器，对车端传回的大量碎片化的数据进行实时地融合。假设一般情况下，多次观察行为相互独立，且仅受相同高斯白噪声影响，那么随着数据量的不断增大，众包数据的精度也就越高。而后云端再将生成/ 更新后的地图数据压缩并OTA分发至各众包车辆。

**3. 回到车端：**

车辆也是高精地图的使用者，高精地图可辅助车辆完成前述的定位、感知、决策等功能。而在使用高精地图的过程中，自动驾驶车辆又可以实时的发现高精地图与对应实际道路存在的差异，并将差异数据回传至云端，云端根据此数据再对高精地图进行更新。

![img](https://pic3.zhimg.com/80/v2-b670c65deae15fed1d757884b657128e_1440w.webp)

华为车BU 众包建图的框架- ICRA2021，秦通

在此框架中，众包车辆是高精地图的构建者，也是使用者和更新者，形成了完整的逻辑闭环。

**Ref：**

**原文：**[[2106.02527\] RoadMap: A Light-Weight Semantic Map for Visual Localization towards Autonomous Driving (arxiv.org)](https://link.zhihu.com/?target=https%3A//arxiv.org/abs/2106.02527)

**解读：**[RoadMap:一种用于自动驾驶视觉定位的轻质语义地图（ICRA2021） - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/411873535)

**秦通知乎：**[不用高精地图行不行？RoadMap:轻量化视觉众包构图方案探索（自动驾驶） (zhihu.com)](https://www.zhihu.com/zvideo/1389638431253868544)



**3.4.2 在研众包建图案例：Momenta**

再来看一个在研的详细案例：Momenta的基于众包数据进行高精地图建图与更新，该案例来自于《智能网联汽车高精地图白皮书》

- **总体建图框架**

首先，**车端硬件有**：低成本IMU+GPS+Camera。

**车端软件 & 作业流程：**

1. **硬件标定：**设备使用过程中，设备的参数可能发生变化。因此每次作业前需要对参数进行标定，包括：相机内参K、相机与IMU 坐标系间的外参Tci、相机和车体坐标系间的旋转矩阵Rcv，以及相机相对地面的高度H；
2. **要素感知：**实时感知，包括车道线、交通牌、路灯杆、边缘线等道路要素的识别检测；
3. **建图 SDK：轨迹解算：**借助同步的Camera，IMU，GPS 数据进行实时轨迹解算**，**对于质量不好的轨迹，可在建图之前予以过滤；**单包建图：**将二维感知信息转换成**有地理坐标的三维数据**，即确定语义特征在世界坐标系中的位置（注意与华为方案不一样，车端并未生成最终的结构化数据）。
4. **语义特征关联：**将待建图区域划分成子图，针对每个子图中的每个位置区域，对该位置区域中的关联语义特征与各个道路图像的语义特征之间的重投影误差进行非线性优化，确定关联语义特征更准确的世界坐标系位置，并添加至地图中。对地图中的语义特征进行筛选，去除可信度较低的语义特征，最终输出筛选后的地图信息。
5. **变化检测：**单包建图结果与最新的地图数据进行对比，识别道路更新，并可将发生变化的信息回传云端。

![img](https://pic1.zhimg.com/80/v2-5cf96b4cbbe506a606124255b1abee7c_1440w.webp)

单包信息提取框架

车端生产的众包数据以“包”为最小单位，其中包含了**感知结果、语义检测结果、轨迹数据，**而后通过4G/5G网络传输到云端平台。而云端主要功能有：

1. **回传海量数据的存储、管理与并发处理**：搭建云端数据管理平台，对多规格数据进行处理与转换，生成可用于地图自动化生产的结构化数据（以路段为单位的建图原始数据）。
2. **云端自动化地图生产平台：**Mapping brain 对各组数据 “是否达到生产、更新要求” 进行判定，自动触发生产、更新任务，实现各路段生产的并发处理。自动化生产线可将分块的路段单元、增量式更新结果合并到已有HDmap中，最终形成完整的地图数据库。
3. **地图下发与应用：**经过地图编译与格式转换，以API、SDK等方式提供给车端；

![img](https://pic1.zhimg.com/80/v2-de721f2ffd4ce610a762d5cf0e476bc8_1440w.webp)

众包的地图的总体框架

**3.4.3 地平线Navnet**

2019年的CES消费电子展上，地平线推出了NavNet众包高精地图采集与定位方案。基于单目SLAM和深度学习（具体技术方案未知）进行建图，但基本没看到后续动作，目前地平线官网上也看不到关于众包建图内容。

![img](https://pic1.zhimg.com/80/v2-b950c2f74b8ec07b99cdb26617aa941c_1440w.webp)

地平线的车端众包建图能力

**介绍：**[直击CES|除了激光雷达感知，地平线首推众包高精地图_南方plus_南方+ (southcn.com)](https://link.zhihu.com/?target=http%3A//static.nfapp.southcn.com/content/201901/09/c1831502.html)



### 3.5 众包建图现状

所谓“专业采集”和“众包采集”，其关系并非相互冲突的竞争关系，而是时间轴上**继承**和**发展**的关系。无论是直接采用众包建图，还是利用专业采集车建立高精底图后众包更新，众包在“地图鲜度”和“业务闭环”上的价值都无可替代。随着众包所依赖的外部条件一项一项达成，众包的工程落地的障碍逐渐被扫清。

1. **激光雷达：**当前业界主推的众包方案是“纯视觉”方案，**这主要是基于前几年量产车型没有安装激光雷达所致。**而到了2022年，车载半固态激光雷达性能肉眼可见提升的同时，价格已经来到千元级别。因此个人判断未来最佳的众包方案也一定是基于Camera+Lidar融合的方案，当前仍鼓吹纯视觉众包的是不清楚老方案不用Lidar的原因，也罔顾业界发展的大趋势。
2. **GNSS-RTK：**当前量产车型基本会装配如Ubox F9之类的RTK模块，或者RTX星站差分定位系统，其绝对定位精度可达厘米级甚至毫米级，保障了众包建图的绝对精度；
3. **车端算力：**当前量产车型的车端算力也极大增强，基本达到了数百TOPS，足以支持车端的单包建图；
4. **车联网：**当前车联网、5G系统也在有条不紊的进行当中，未来即使回传大量的数据也不会是一个大问题。



**3.4.1 业界进度（更新）**

根据调研，2022年主流的高精地图厂商**均部署了众包采集车辆。**但当前数据地精度、稳定性还不足以构建高精地图。就算是Momenta此类大力宣传采用纯视觉众包的厂商，其在2021年构建全国高快速路的高精地图时，仍然采用的是数十辆专业采集车，做出了一定的妥协，众包的“远水”解不了近渴。

不过，通过众包数据，国内主流图商可以对 **“道路发生的变化”** 进行判定和识别，而后派遣高精采集车辆或者中精度地地图更新车辆对该路段进行重新采集。根据实际访谈，当前拥有众包数据地图商基本采取了这一方案，极大的降低了高精地图的更新成本，提升了更新的频率。如头部的高德、百度当前均可做到一季度一更新，甚至在重点城市月度更新。

在纯众包方案方面，国外的Mobileye REM建设进展很快，也已经有一些局部的商业化落地。Nvidia也已经基于其Drive Hyperion平台的众包地图建设。国内的图商、自动驾驶供应商目前（2022Q4）还没有**公开的、特别**令人信服的demo，也没有看到基于众包的商业化落地。不过国内一众图商、自动驾驶厂商、乃至主机厂都已经在着力研发，（也有可能是出于某些原因秘而不宣），相信业界不会等待很久。

![img](https://pic2.zhimg.com/80/v2-a3e50ac7e32c4b20d50846b95aa16c9d_1440w.webp)

Deepmap的采集车辆，From DeepMap: The Future of Mapping - YouTube

Ref：

1. [DeepMap: The Future of Mapping - YouTube](https://link.zhihu.com/?target=https%3A//www.youtube.com/watch%3Fv%3DszgjvBkv1qY)
2. [专业采集与众包，细数两种地图制作方式的优劣 (baidu.com)](https://link.zhihu.com/?target=https%3A//baijiahao.baidu.com/s%3Fid%3D1667288318870095839%26wfr%3Dspider%26for%3Dpc)
3. [如何看待传统式高精地图VS众包式高精地图的路线PK？ - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/359700622)



## 4. 高精地图的存储与交互

那么，高精地图在自动驾驶车辆当中，是如何存储并被使用的呢？

### 4.1 现有存储与分发方案

首先，高精地图数据的在车端存储需要高压缩性的，方便灵活更新的格式。由第1节可知，高精地图表达的本质是带有语义信息和拓扑信息的矢量化点、线、面。现有的较为广泛使用的数据格式有NDS、OpenDrive等，如下图是OpenDrive格式的美国旧金山市高精地图文件的部分截图。
OpenDrive采用了可扩展标记语言（XML）来对所有要素进行组织表达，使得整个旧金山的地图为26MB，若采用压缩算法可进一步缩小其体积。

![img](https://pic2.zhimg.com/80/v2-9e53c94442d740dd7b7f41800ba6ab49_1440w.webp)

OpenDrive格式的旧金山高精地图（部分）

在车端，高精地图的存储架构与同普通的导航地图存在很大不同，导航地图的信息并不会接入中央ECU，仅通过HMI接口对驾驶员进行展示。但用于自动驾驶的高精地图则不同，当前主流的方案是将高精地图、以及高精定位模块放在专门开发的电子控制器上，也被称之为**地图盒子**（Map Box）、**地图电子控制器**（Map ECU）等。

如下图是Bosch已量产的车端地图存储架构：车端感知硬件GNSS-RTK、Camera（还可以有LiDAR，IMU等）输出的信息也被接入了地图盒子。地图盒子会对传感器数据与高精地图进行融合定位，以得到车辆当前的精确位姿。之后将对应范围的地图信号抽取出来，形成电子地平线（EHP），并打包为ADASIS格式，通过车载以太网或者CAN总线发送至自动驾驶域控制器上。自动驾驶域控制器即可利用这些信息实现后续的自动驾驶功能。并且，在地图盒子中，可通过4G/5G网络从云端对高精地图进行OTA升级。

![img](https://pic4.zhimg.com/80/v2-d00de6478b403f944dbecbe1372277f7_1440w.webp)

Bosch量产的车端高精地图存储框架

此种架构的优点是模块相对独立，逻辑更为清晰。当然也有的方案直接将地图与定位模块直接集成在了中央ECU或自动驾驶域控制器中，其通信效率会更高，但也会给后续的升级迭代带来一些不便。



### 4.2 未来的云存储方案

- **现存地图存储的难点：**

当前，车载高精地图存储的主要难点在于嵌入式系统的存储容量限制。根据调研，仅全国35万公里的高快速公路的高精地图经过矢量化和压缩处理后，需要6-20GB不等的存储空间，如蔚来的高精地图约占8GB的存储空间。如后续加入更为复杂城市道路，所需的存储空间将会是现有的数十倍不止。
因此，在车规级的存储芯片上的开销将会非常大，这一现状使得难以在一般量产项目中大规模推广高精地图。

- **可能的解决方案：云存储**

采用云存储的方案是这一问题的一种思路，即根据定位结果，自动驾驶车辆实时从云端获取相应路段的高精地图数据即可。此种方案的另一个好处在于省去了车端进行地图OTA升级的麻烦，图商仅仅需要保持云端地图的新鲜度即可。下图是来自《智能网联汽车白皮书2020》的对未来高精地图建设、使用框架的展望。

![img](https://pic4.zhimg.com/80/v2-0739ee9f309299bc4cab2ecbd54e3b0b_1440w.webp)

高精地图云平台展望，From《智能网联汽车白皮书 2020》

但个人认为，此方案对无线通信的实时性以及覆盖范围有着极高要求，当前的基础建设还需要加把劲。



## 5. 高精地图量产项目案例

都是些古早的L2量产项目，随便看看就行

### **5.1 凯迪拉克Super Cruise（高德）**

**中国第一个的高精地图量产项目，**是2018年高德拿下的**上汽通用凯迪拉克CT6**项目，对于中国的高精地图产业具有重大的意义。CT6搭载了由通用汽车子公司，加州交通管理局DMV榜单排名第二的Cruise公司发布的**Super Cruise 高速公路自动驾驶系统，**可以实现高速公路场景下单车道内可脱手的自动驾驶。

![img](https://pic3.zhimg.com/80/v2-69d567bb7b0cc4bb7c11b2099e89049a_1440w.webp)

DMV 2021排名

早在2017年，美国高精地图供应商Ushr为通用提供了北美的高速公路高精地图数据，然后将其搭载到CT6的Super Cruise系统中。通用计划在2018年底在中国落地这套系统，因此就需要有中国的高速公路的高精地图数据。由前述的法规原因，外资图商无法在华采集高精地图，因此上汽通用最终选择了高德作为国内的高精地图供应商。

CT6搭载了由天宝（Trimble）提供的RTX高精GPS定位系统，RTX系统是基于空基卫星的GNSS定位增强系统（应该属于PPP-RTK），而并非RTK基于的CROS陆基定位个增强系统。在大部分情况下，定位精度可达90cm以内，融合前置摄像头识别的道路标识，可使车辆精确定位到所在车道。通过高精地图，车辆可提前得知前方2.5公里内的详细路况信息，并自动形成一条沿车道中央的**虚拟车辆控制路径**——**BLUELINE蓝线**。如此一来，就可以让汽车的决策系统更有预见性的控制转向、油门、刹车等执行机构。

![img](https://pic2.zhimg.com/80/v2-f6f0c95a6ba834d7b654863911526671_1440w.webp)

同时，在Super Cruise系统的使用过程中，通用不断给高德反馈高精地图存在的缺陷，使得高德能够针对性的补足地图的缺陷，在迭代中提升其地图的精确性和正确率。这也为高德后续接到更多商业订单，形成正向循环打下了良好基础。

**Ref：**

1. [最前线｜2021加州DMV自动驾驶众生相：Waymo跑最远，苹果人工接管最多-36氪 (36kr.com)](https://link.zhihu.com/?target=https%3A//36kr.com/p/1609174173010688)
2. [高精地图加持 凯迪拉克Super Cruise系统让安全、舒适双升级 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/234994725)
3. [卡迪拉克CT6超级巡航的车道级定位与日本QZSS-汽车电子-与非网 (eefocus.com)](https://link.zhihu.com/?target=https%3A//www.eefocus.com/automobile-electronics/463572)



### 5.2 广汽Aion LX高速公路辅助驾驶系统（百度）

2019年10月量产的广汽埃安 LX搭载了百度Apollo高精地图。针对甲方的客制化需求，百度提供了高精地图的整体解决方案。其中，高精地图数据包含了超过100种地图要素，且对各类要素提供不同的精度指标：

| 要素                    | 相对精度      | 备注                                       |
| ----------------------- | ------------- | ------------------------------------------ |
| 道路几何(Road Geo)      | 1m with 3σ    |                                            |
| 隧道(Tunnel)            | 3m with 2σ    | 隧道采集相对困难，精度要求低               |
| 收费站(Toll Booth)      | 3m with 2σ    |                                            |
| 道路终点(Raod End Flag) | 3m with 2σ    |                                            |
| 曲率(Curvature)         | 3%            |                                            |
| 坡度(Slope)             | 2%            |                                            |
| 车道几何(Lane Geo)      | 0.2m with 2σ  | 车道相关要素与导航定位强相关，精度要求最高 |
| 车道宽度(Lane width)    | 0.25m with 2σ |                                            |

车辆的电子地平线系统（EHP）支持ADASIS v3标准，可以依据汽车当前的位置，提供前方一定距离的高精地图数据，并通过车载以太网/ CAN总线与各类地图应用进行通信。

![img](https://pic1.zhimg.com/80/v2-1399f4334c8ff94ee9a3267815f06a7c_1440w.webp)

百度Aion LX项目电子地平线架构

基于该架构，可实现以下功能：

1. **基于高精地图的定位：**特别是在城市工况下，与视觉、雷达、IMU等多传感器进行融合，帮助车辆实现车道级定位；
2. **中距离下提升车辆感知，优化规划：**提供规划路径的曲率、坡度、出入口、匝道等信息，优化决策的细节，如上下坡前提前加减速，进入弯道时的预先速度控制，提升用户乘坐体验；
3. **长距离下的优化导航路径规划：**通过接入V2X 动态数据源，提供红绿灯状态与车道级交通拥堵、管制状态数据，对长距离的路径规划进行优化；



## 6. 高精地图的发展方向

### **6.1 自动驾驶场景的应用**

如果未来重感知的方案没有彻底把基于高精地图方案打垮，高精地图厂商还有一席之地的话，那么随着自动驾驶等级的提升，高精地图应当朝着这些方向变化、发展：

| 关键技术           | 趋势                                                         | 备注                                                         |
| ------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 采集技术           | 专采、众包结合                                               | 提升高精地图生产效率，以及更新实时性；                       |
| 采集流程高度自动化 |                                                              |                                                              |
| 制图技术           | 绘图技术                                                     | 借助AI技术完成多传感器数据的自动融合，对所有道路要素进行自动化的、高精度的识别； |
| 更新技术           | 依靠大数据和地图云服务平台，进行地图的更新和分发，建立采集、绘制、审核、发布等一体的高精地图自动化采集更新发布流程； |                                                              |
| 验证技术           | 由人工验证转向自动化的多源数据的交叉验证；                   |                                                              |
| 车路协同技术 V2X   | 路侧地图更新                                                 | 路侧的固定传感器可成为高精地图更新的数据源，可作为一种实时更新地图的手段； |
| 路侧感知体系       | 路侧感知设备与高精地图结合，利用V2X技术为汽车提供动态的感知信息； |                                                              |
| 高精地图分发       | 利用路侧通信设施分发地图，使车端实时获取地图数据，节省存储空间； |                                                              |
| 通信基础建设       | 5G的大面积组网                                               | 低时延、高可靠的数据传输与处理技术是实现上述技术的必要基础； |
| 硬件及传感器技术   | 提升性能、降低成本                                           | 低成本、高性能、大批量生产的摄像头、激光雷达、毫米波雷达（4D）、GNSS-RTK、惯性导航等硬件设备同样是实现以上技术的必要基础。 |



### **6.2 数字孪生与自动驾驶仿真**

除了车端的应用之外，还可以利用高精地图技术，创建出与现实世界一比一的数字空间，并在此基础上拓展出**“城市大脑”、“智慧城市”，**目前已有许多城市在此方面进行了大量投入。未来，高精地图作为连接真实世界与虚拟世界的媒介，使其成为未来智能世界的基础设施。结合AR/VR技术的发展，可以为人们带来“所见即所得”的空间互联网服务，人们的商业场景、生活模式都将发生深刻的变化。

![img](https://pic1.zhimg.com/80/v2-2a42b45bd7e02bdce2009c1dc9bb0534_1440w.webp)

数字孪生技术

还有前面提到的，利用高精地图来制作用于自动驾驶仿真的静态场景，具体不展开了，后面到仿真的文章里详细说。



## 7. Backups

### 7.1 主要图商的地图采集设备

以下信息主要来源于自然资源部的公开数据，一些企业的硬件上报不清晰，未截图。[政府信息公开目录 (mnr.gov.cn)](https://link.zhihu.com/?target=http%3A//gi.mnr.gov.cn/)

- **Momenta：**

如下30台

![img](https://pic4.zhimg.com/80/v2-29bb45e5d33a799dc4b7ef83b78aae07_1440w.webp)

如下4台

![img](https://pic2.zhimg.com/80/v2-a12628bb27752a7295b854cf2e3e955d_1440w.webp)

其他

![img](https://pic3.zhimg.com/80/v2-710446286afa644b9bdbc697bcab2c82_1440w.webp)

- **腾讯**

如下设备30台

![img](https://pic2.zhimg.com/80/v2-45d0b74f1e6154e2ce8d50d977d19305_1440w.webp)

- **长地万方-百度子公司**

如下设备30台

![img](https://pic1.zhimg.com/80/v2-b90f4dcecdec0be936f56ca7c43fb874_1440w.webp)

- **华为**

25台Lidar

![img](https://pic3.zhimg.com/80/v2-e4e4fb3ef6f06b870417710ac09bd12a_1440w.webp)

20台

![img](https://pic4.zhimg.com/80/v2-4c85bb66932e0c412ef4acc2b571dd57_1440w.webp)

12台

![img](https://pic4.zhimg.com/80/v2-65e324926b7c4f90cd9b81660e55f583_1440w.webp)

20台

![img](https://pic2.zhimg.com/80/v2-f19678e9cf55425aede147e5dd63f3ed_1440w.webp)

25台Lidar

![img](https://pic2.zhimg.com/80/v2-f11519d6db6fe80fcec0b14885da86b9_1440w.webp)

80台相机

![img](https://pic1.zhimg.com/80/v2-58b0cbb38f665f4e1afda40fdda17668_1440w.webp)

- **顺丰科技**

370台

![img](https://pic2.zhimg.com/80/v2-528f11395fec272dc2bcf242f028e78d_1440w.webp)

- **凯立德**

3种设备

![img](https://pic3.zhimg.com/80/v2-5add64d4601a80d366440a58fccf4d56_1440w.webp)

- **高德**

5台16线雷达，雷达方面应该没有上报齐全，得有别的雷达。

![img](https://pic4.zhimg.com/80/v2-f182b32d71131accae758212a3f28427_1440w.webp)

![img](https://pic1.zhimg.com/80/v2-54a29377b78780db70f460cbd2dce86c_1440w.webp)

- **宽凳科技**

![img](https://pic2.zhimg.com/80/v2-1000d4fbf9cb74519e1873e27184a09d_1440w.webp)