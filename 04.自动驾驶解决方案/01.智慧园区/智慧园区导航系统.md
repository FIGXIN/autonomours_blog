- [智慧园区导航系统 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/111019428)

## 1 系统总体设计

### 1.1 系统概述

本系统为了实现园区导航，开发一套基于GIS地图的导航技术的软件平台，实现园区的地图可视化、实现园区内的实时定位、实现园区内部的路线导航等核心应用。

在此基础上，针对物流园区的具体业务应用特点和需求，开发基于商户和商品管理、客流访问统计、大数据分析等具体的业务应用功能。

### 1.2 总体目标

为了实现以上业务目的，本系统的建设目标主要分为支撑平台建设目标和业务平台系统建设目标，其中支撑平台建设目标有：

 [GIS引擎](https://link.zhihu.com/?target=http%3A//www.ztmapinfo.com)地图服务平台：基于基础ZTMapGIS地图平台实现园区地图数据的采集绘制和管理能力，为园区地图的可视化和导航等提供空间分析能力，是整个系统的可视化支撑平台。

业务应用平台建设目标有：

 开发商铺管理系统：通过关键词搜索，分类筛选等方式让用户快速得到想要的商品、商铺、位置、联系方式等信息。

 开发园区导航系统：通过自主开发的园区导航系统，规划合理的路线，带领用户快速到达目标店铺位置。

### 1.3 系统架构

![img](https://pic3.zhimg.com/80/v2-73186126b008b6c4c31eb83c0ed769a6_720w.jpg)

## 2 数据采集绘制处理

### 2.1 地图采集绘制

POI处理：根据数据采集方的POI采集规范和所采集的数据情况，按类别、和应用需要制定POI分层（如商户、服务设施、消防通道、出入口、商品大类分区、小类分区等）及各层数据属性规范要求（如是由深度采集信息等）。针对采集数据依据规范进行分层、加工、入库。每一层赋予不同图标进行形象展示处理。建立POI图标库。

道路处理：识别会绘制园区内的道路，包括道路的走向、禁行、限速等相关与导航有关的属性，建立道路拓扑结构，对道路进行分段处理，生成能够用于路线导航的道路路网数据。

标注处理：针对每一层选用合适的标注形式，对地物进行标注，标注信息逐层进行视野范围控制设置，使每层的信息名称在合适的情况下展示。

视野控制：根据行业特点和参考一些规范要求，进行视野范围控制调整，根据用户视野范围，逐级深入将信息展示出来，针对每一图层进行视野范围的控制调整，使级别展示合理。

整体配色：根据不同的图层（如路径、各品牌营业区等）进行统一的渲染。

地图渲染：依据金字塔原则进行索引创建处理。生成地图数据在GIS平台中可直接使用。

### 2.2 数据维护更新

定期（例如每年一次）进行数据维护制作。定期根据最新的楼宇图纸等地图原始材料进行更新维护，修改地图对象的形状、位置、配色、属性管理数据等。

数据维护更新可以借助于数据维护子系统进行远程操作。

查询定位，前期以二维管线地图展示。

## 3 应用功能设计

### 3.1 园区地图

#### 3.1.1 园区地图浏览

基于GIS平台，对物流园区地图进行渲染发布，提供可视化显示浏览地图可以选择2D、2.5D等二三维地图模式，用户可以在地图上快速查询和点击选择某个园区内的建筑物、商铺等信息，并查看其相关属性信息，并在地图上进行高亮显示等。

#### 3.1.2 室内商铺地图

基于室内GIS平台，对建筑物内的商铺楼层进行数据采集和绘制，生成室内地图数据并发布为矢量渲染成果，用户可以通过放大地图，查看某一地点的具体室内图。室内商铺地图跟园区室外地图融为一体，实现室内外地图的无缝集成。

### 3.2 商铺查询

#### 3.2.1 可视化查询

基于园区地图实现商铺的查询，用户可以在手机地图上输入关键字、选择分类等方式查询园区商铺，选择的商铺可以在地图上进行高亮标注显示，点击之后可以查询其详细业务属性。

商铺查询支持通过名称、地址、分类等各种属性查询

#### 3.2.2 关联操作

对于查询出来的商铺，除了查看其信息本息和地图定位之外，还可以进行进一步操作，可以进行的操作包括：

 到这儿去：用户可以在商铺查询列表或者地图上，直接通过“到这儿”的快捷操作，启动路线导航功能，把用户导航到该商铺。

 电话拨打：提供拨打电话的快捷操作，便于用户随时咨询商铺

### 3.3 导航路线规划

实现根据起点和终点规划导航路线的接口，为商铺导航指引业务提供地图导航路线规划的能力。

导航请求：导航请求一般由手机端应用系统发起，请求参数包含起点和终点的坐标。起点一般是手机的实时定位的当前位置坐标，也可以是在地图上手动选择的点，终点一般是指选择的商铺的位置坐标，也可以是在地图上手动选择的一个点。

结果返回：本模块根据起点和终点坐标，调用地图导航引擎，计算一条最合理的行驶路线，然后把路线的描述信息以及路线走向地图信息返回给手机应用、本地管理系统等，进一步将路线地图显示在手机端或者停车诱导显示屏上。

### 3.4 楼层重叠区域导航

由于园区建筑物存在多楼层的情况，这样就导致了如果用户走到多楼层商铺的位置的时候，在没有室内精准定位的情况下，地图系统无法判断当前用户是在一楼还是二楼，这样地图导航就无法确定导航的起点。为了解决这一问题，操作流程如下：

1、判断用户是否在楼层重叠区域

2、如果在楼层重叠区域，选择私人活动安排了挺好的 金丝雀吗 我觉得这里面的问题

### 3.5 实时定位功能

依靠GPS定位和室内定位平台的定位引擎，封装室内外实时定位模块，供手机应用调用。GPS定位在露天场景下应用，室内定位在楼层内没有GPS信号的情况下进行精确定位，用于显示用户在楼层内的自身位置和商铺的精准定位。

室内实时定位应用的流程如下：

 手机端定位模块实时读取周边探测到的蓝牙设备信号，包括设备标识、信号强度

 将这些所有信息作为参数上传给服务端实时定位接口

 服务端实时定位接口根据接收到的信息，调用定位引擎计算当前手机所在的实时位置

 服务端接口将计算得出的实时位置坐标返回给手机端，同时记录在数据库中，作为历史轨迹查询的依据

 手机端将坐标标注在地图上。

### 3.6 历史轨迹查询

提供对用户的历史轨迹查询的功能，可以查询某个用户在指定的时间段内的行动轨迹。

历史轨迹可以依据时间顺序在地图上撒点标注连线显示，点击地图上的每个轨迹点，可以查看其具体详情。

可以沿着轨迹路线动态播放形式轨迹，重现当时的运行动态特征。

历史轨迹查询展示，可以在手机应用端、管理后台等不同场景和界面下进行。

### 3.7 商户可视化管理

#### 3.7.1 商户常规管理

实现基于地图的园区商户的分布查询，结合业务数据，进行常规业务的可视化管理查询等。实现对于商户分布和基本信息、档案、租赁合同、销售等业务数据的基本联动展示查询。

#### 3.7.2 产品管理

包括产品分类管理、计量管理、店铺物流管理、产品发布规范等跟产品管理相关的功能

#### 3.7.3 数据分析

包括行业数据、产品数据分析，趋势分析，用户流量分析等，以统计图标的方式，结合GIS地图，进行多维度可视化统计分析。

#### 3.7.4 广告推广

广告位、搜索排名、活动推广等，基于商户运营数据和用户流量数据等，实现广告营销相关的功能。

### 3.8 商户地图数据维护

需要统一的数据管理系统，可以通过这个管理系统来管理地图对象。包括添加、修改、删除图元对象和其业务属性数据，支持单元合并拆分等的自主维护。

为了保持系统的可维护性，开发基于地图的资产自行维护功能，用户可以随时在地图上标注一个和多个新的资产，并且设置相关的业务属性关联信息，绘制的资产信息保存到数据库中，提供后续查询使用。提供增删改的维护功能。

数据维护是指对需要在地图上展示标注的资产等地图对象进行的增删改操作。当然，这跟传统的数据维护有所不同，主要特点在于是基于地图的操作以及基于传统业务系统数据的操作进行关联。

要允许用户在地图上直接对需要维护的资产进行标注、拖动、修改、删除等操作，一切都是可视化的。在地图上操作完之后，需要根据数据关联关系告知业务数据系统，以便完成业务数据库的相应维护，从而实现数据的空间位置和业务数据的完整维护操作。

#### 3.8.1 新增数据

 功能描述

通过在地图中绘制公寓单元多边形区域或者其他业务设施POI等，并录入相应的属性信息进行添加，或者以MIF/MID、tab、excel等多种文件格式的批量导入。

 实现流程

在客户端浏览器中的数据维护页面中，用鼠标在地图上点击待添加信息所在地图上的位置后(该位置为待添加信息点的经纬度)，在系弹出的属性信息录入页面中编辑对应的属性信息后保存。

#### 3.8.2 修改数据

 功能描述

对已有的数据进行修改操作，可修改其位置、属性信息等。

 实现流程

在客户端浏览器中的数据维护页面，通过模糊查询、属性查询、拉框查询等将符合要求的基础数据查询出来，系统将以两种形式（1.地图撒点；2.数据列表）同时展示，此时可通过拖动地图中对应的图标进行位置修改；通过在数据列表中查看对应的详细信息页面进行属性信息的修改。

#### 3.8.3 删除数据

 功能描述

可对数据库中的一些冗余数据进行删除。

 实现流程

在客户端浏览器中的数据维护页面，通过模糊查询、属性查询、拉框查询等将符合要求的基础数据查询出来，系统将以两种形式（1.地图撒点；2.数据列表）同时展示，在数据列表中，可以通过删除按钮进行删除冗余数据。