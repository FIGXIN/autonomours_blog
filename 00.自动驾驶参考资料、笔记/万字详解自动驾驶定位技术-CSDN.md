更多自动驾驶、车路协同、车联网、智能网联车、高精度地图、无人驾驶笔记，尽在：https://gitee.com/AiShiYuShiJiePingXing/auto-driving



笔记来源于《自动驾驶汽车定位技术》书籍的笔记，整理内容来源于：[自动驾驶汽车定位技术_FUXI_Willard的博客-CSDN博客](https://blog.csdn.net/qq_39032096/category_11889412.html)

| [学习笔记1--自动驾驶定位技术概述_FUXI_Willard的博客-CSDN博客](https://fuxi-willard.blog.csdn.net/article/details/125510320) |
| ------------------------------------------------------------ |
| [学习笔记2--高精度地图定义及价值_FUXI_Willard的博客-CSDN博客](https://fuxi-willard.blog.csdn.net/article/details/125511264) |
| [学习笔记3--高精度地图关键技术(上)_FUXI_Willard的博客-CSDN博客](https://fuxi-willard.blog.csdn.net/article/details/125529213) |
| [学习笔记4--高精度地图关键技术(下)_FUXI_Willard的博客-CSDN博客](https://fuxi-willard.blog.csdn.net/article/details/125566579) |
| [学习笔记5--高精地图解决方案_FUXI_Willard的博客-CSDN博客](https://fuxi-willard.blog.csdn.net/article/details/125579030) |
| [学习笔记6--卫星定位技术(上)_FUXI_Willard的博客-CSDN博客](https://fuxi-willard.blog.csdn.net/article/details/125587984) |
| [学习笔记7--卫星定位技术(下)_FUXI_Willard的博客-CSDN博客](https://fuxi-willard.blog.csdn.net/article/details/125607754) |
| [学习笔记8--惯性导航定位技术_FUXI_Willard的博客-CSDN博客](https://fuxi-willard.blog.csdn.net/article/details/125625646) |
| [学习笔记9--地图匹配定位技术_FUXI_Willard的博客-CSDN博客](https://fuxi-willard.blog.csdn.net/article/details/125644288) |
| [学习笔记10--多传感器融合定位技术_FUXI_Willard的博客-CSDN博客](https://fuxi-willard.blog.csdn.net/article/details/125664362) |
| [学习笔记11--车联网体系架构及信息共享_FUXI_Willard的博客-CSDN博客](https://fuxi-willard.blog.csdn.net/article/details/125687647) |
| [学习笔记12--基于专用短程通信的车联网技术_FUXI_Willard的博客-CSDN博客](https://fuxi-willard.blog.csdn.net/article/details/125708869) |
| [学习笔记13--基于蜂窝移动通信的车联网技术_FUXI_Willard的博客-CSDN博客](https://fuxi-willard.blog.csdn.net/article/details/125708963) |
| [学习笔记14--车联网辅助定位技术_FUXI_Willard的博客-CSDN博客](https://fuxi-willard.blog.csdn.net/article/details/125709018) |

<center><h2>自动驾驶定位技术的构成</h2></center>

![1](https://img-blog.csdnimg.cn/5d7754362589409886e1bcb696533724.jpeg#pic_center)

## 1 高精度地图

- 高精度地图由含有语义信息的车道模型、道路部件、道路属性等矢量信息，以及用于多传感器定位的特征图层构成；
- 自动驾驶汽车在高精度地图的辅助下更容易判断自身位置、可行驶区域、目标类型、行驶方向、前车相对位置、感知红绿灯状态及行驶车道等信息；
- 自动驾驶汽车通过超视距的感知能力，辅助汽车预先感知坡度、曲率、航向等路面复杂信息，再结合路径规划算法，让汽车做出正确决策；
- 高精地图生产制作过程，需要对采集到的交通环境图像、激光点云、GPS定位等多种传感器原始数据进行处理，其中涉及车道线识别、交通标识标牌的图像处理技术、激光点云配准技术、同步定位与建图技术及OTA数据更新与回传等云端服务技术；

### 1.1 高精度地图定义及价值

- 高精度地图以精细化描述道路及其车道线、路沿、护栏、交通标志牌、动态信息为主要内容，具有精度高、数据维度多、时效性高等特点；
- 高精度地图也称为高分辨率地图(High Definition Map，HD Map)或高度自动驾驶地图(Highly Automated Driving Map，HAD Map)；

#### 1.1.1 高精度地图的分层结构

- 高精度地图比普通导航地图精度更高、数据维度更广的地图，高精度体现在地图精度精确到厘米级，数据维度更广体现在地图数据除道路信息外，还包括与交通相关的周围静态信息；
- 普通地图和高精度地图
  ![1](https://img-blog.csdnimg.cn/99fe3f49fc714649a3e089c0f7a3885d.png#pic_center)

- 高精度地图主要由静态数据和动态数据构成，其中静态数据包括道路层、车道层、交通设施层等图层信息；动态数据包括实时路况层、交通事件层等图层信息；

![2](https://img-blog.csdnimg.cn/55bfbab6c2914e50a1757c22c3398f89.jpeg#pic_center)

- 高精地图和普通地图的区别
  - 精度：普通导航地图精度一般达到米级，高精度地图精度达到厘米级；
  - 使用对象：普通导航地图面向人类驾驶员，高精度地图面向自动驾驶车辆；
  - 时效性：对于静态数据，普通导航地图更新要求一般在月度或季度级别，高精度地图一般要求周级或天级更新；对于动态数据，普通导航地图不做要求，高精度地图要求车道级路况或交通事件等信息实时更新；
  - 数据维度：普通导航地图只记录道路级别的数据，如道路等级、几何形状、坡度、曲率、方向等，高精度地图在普通导航地图基础上，增加了车道及车道线类型、宽度等属性，还有护栏、路沿、交通标志牌、信号灯等详细信息；

#### 1.1.2 高精度地图对自动驾驶的价值

- 辅助环境感知
  高精度地图可以对传感器无法探测或探测精度不够的部分进行补充，实现实时状况的监测及外部信息的反馈，进而获取当前位置精准的交通状况；
- 辅助定位
  汽车行驶过程中，利用地图匹配精确定位汽车在车道上的具体位置，提高汽车的定位精度；高精度地图更多依靠其准确且丰富的先验信息(如车道形状、曲率和标志牌等)，通过结合高维度的数据与高效率的匹配算法，能够实现更高精度的匹配与定位
- 辅助路径规划
  高精度地图可以确定车道的中心线，可以保证汽车尽可能靠近车道中心行驶；在人行横道、低速限制或减速带等区域，高精度地图可使汽车能够提前查看并预先减速；对于行驶汽车附近的障碍物，高精度地图可帮助自动驾驶汽车缩小路径选择范围，以便选择最佳避障方案；
- 辅助决策与控制
  高精度地图是对物理环境道路信息的精准还原，可为汽车加减速、并道和转弯等驾驶决策控制提供关键道路信息；高精度地图能给汽车提供超视距的信息，并与其他传感器形成互补，辅助系统对汽车进行控制。

#### 1.1.3 高精度地图行业现状

![3](https://img-blog.csdnimg.cn/37ac575a1df64ebd97a06912dfc2c34a.jpeg#pic_center)

### 1.2 高精度地图关键技术

#### 1.2.1 道路元素[图像处理](https://so.csdn.net/so/search?q=图像处理&spm=1001.2101.3001.7020)

**高精度地图的制作需要运用图像处理技术将道路上的各种道路元素进行识别，并以此进行语义标注，如车道线检测、众包图像数据采集等；道路元素包括：交通标志牌、红绿灯、车道线和隔离带等；在进行识别前，由于光线、雨水、车速等环境影响，可能引入噪声或使图像失真，因此，首先需要对图像进行降噪和增强等提高图像质量的预处理，然后利用这些道路元素的颜色、位置和大小等先验知识提取其特征，再基于这些特征进行识别并进行分类，完成语义标注；**
![1](https://img-blog.csdnimg.cn/0b3e0ad72a2f4f9db4a6143737df4ec2.jpeg#pic_center)

- 图像采集：通过摄像机等工具采集真实道路环境下的图像，形成数据集；
- 图像预处理：对数据集中的图像进行扩充，同时对图像进行标注工作，便于后期进行深度学习训练模型使用；
- 图像分割：将图像分成若干个特定的、具有独特性质的区域并提出感兴趣目标的过程；
- 边缘检测：找出图像中亮度变化剧烈的像素点构成的集合；
- 图像细化：将图像的线条从多像素宽度减少到单位像素宽度的过程；通过减少图像像素数来达到压缩图像的目的；
- 特征提取：将数据集中的每一幅图像输入到深度学习模型中，在特定的卷积层中提取图像的深度学习特征，便于图像识别工作；
- 特征参数计算：参数计算对卷积神经网络(Convolutional Neural Network，CNN)至关重要，不同的步长、填充方式、卷积核大小、池化层策略等都决定最终输出模型与参数、计算复杂度等；
- 图像识别：将任意一幅待识别的图像输入到深度学习训练模型中，提取样本的深度学习特征并对图像进行识别，判断该图像中的物体属于哪个类别并显示识别物体的准确率；

**当前主流方式采用基于深度学习的图像识别算法进行车道线、地面标志线和交通标牌的识别工作，常见的算法如下：**
![2](https://img-blog.csdnimg.cn/ee7f0d059c4d455da29149884be8e592.jpeg#pic_center)

#### 1.2.2 激光点云处理

**激光点云处理的通常做法：利用激光雷达扫描获取激光雷达点云数据，重建三维的道路环境，并利用重建好的三维环境进行道路要素特征的提取与识别，准确地反映道路环境并描述其道路环境特征，得到高精度点云地图；处理后的激光点云数据能够与图像数据进行映射或融合处理，得到信息更加丰富的彩色激光点云地图；**

1. 激光点云特征提取
   - 激光雷达获取的原始数据集以激光点云文件形式进行存储；
   - 激光点云文件中只包含物体表面的离散点集、法向量、颜色或标签等基本信息，但缺少物体的曲面、体积及各顶点间的几何拓扑等信息；
   - 采集得到的点集数据通常包含噪声，具有散乱、重复及量大等特点；为了更好描述道路环境的几何特征，需要对点集进行特征提取，提取得到的点特征所表示的特征向量应具有平移旋转不变性、抗密度干扰性、抗噪声稳定性等特点；
   - 抗密度干扰性表示一个局部表面小块的采样密度的变化不会影响特征向量值；抗噪声稳定性表示在数据中有轻微噪声的条件下，点特征表示的特征向量不会发生较大的变化；
   - 激光点云的特征按照空间尺度分为：局部特征、全局特征；
     - 局部特征：一般包括法线、点特征直方图(Point Feature Histogram，PFH)、快速点特征直方图(Fast Point Feature Histogram，FPFH)、方位直方图特征(Signature of Histogram of Orientation，SHOT)和3D形状描述子等几何形状特征描述；
     - 全局特征：一般为拓扑特征描述，这类特征描述一般难以捕捉细节的细微变化且对物体遮挡敏感；
2. 激光点云法向量
   - 法向量是激光点云数据重要的局部特征，能够对散乱激光点云的局部进行有效的描述并为其他激光点云处理技术提供支撑；SHOT以及旋转图(Spin Image)等许多特征描述子都需要利用激光点云法向量进行计算提取；
   - 激光点云法向量计算方法：
     - 第一种：使用曲面重建技术，从获取的激光点云数据集中得到采样点对应的曲面，然后从曲面模型中计算表面法向量；
     - 第二种：直接对激光点云数据集进行法向量估计；如：求某点在三维空间中的法向量，需要在该点周围搜索出近邻点集，利用此点集拟合一个曲面并计算此曲面的法向量；
3. 激光点云配准
   - 在激光点云数据的采集过程中，由于采集角度有限，可能需要从道路的多个方向进行多次采集，以保证采集数据的可靠性和完整性，在采集汽车运动过程中，采集到的激光点云数据会包含误差，进而不能准确地描述道路三维环境；需要利用激光点云配准技术将从各个视角下采集到的包含误差的激光点云通过旋转平移，消除误差并统一到同一坐标系下，还原道路的三维环境；
   - 激光点云配准主要分为：粗配准和精配准。
     - 粗配准
       - 适用于在两片激光点云初始位置误差较大的情况下快速取得两片激光点云的转换关系，输出精度不高；
       - 常见的粗配准算法：利用点特征直方图和快速点特征直方图的局部特征描述法、采样一致性初始配准算法(Sample Consensus-Initial Alignment，SAC-IA)及正态分布转换(Normal Distribution Transform，NDT)等；
     - 精配准
       - 适用于在初始位置误差较小的情况下对两片激光点云的坐标进行精准的计算，生成用于配准的旋转矩阵和平移向量，消除不同坐标下的激光点云误差；
       - 常见的精配准算法：迭代最近点(Iterative Closest Point，ICP)算法；
4. 激光点云分割
   - 为了能够将灯杆、标志牌和路沿等交通道路元素从大量杂乱无序的激光点云中识别出来，通常需要根据激光点云表现出的几何形状、特征等方面进行有效分割，提取物体的激光点云，然后利用算法进行分类和识别，并对道路元素添加语义信息；
   - 激光点云分割算法：随机采样一致(Random Sample Consensus，RANSAC)、最小分割、区域增长等常见分割算法，3DMV、PointNet及PointNet++等基于深度学习网络的语义分割与识别算法；

#### 1.2.3 同步定位与地图构建

- 同步定位与地图构建(Simultaneous Localization And Mapping，SLAM)：指机器人从未知环境的未知地点出发，在运动过程中通过观测到的环境特征定位自身位置和姿态，再根据自身位置构建周围环境的地图，从而达到同时定位和地图构建的目的；
- SLAM主要解决两个问题：“我在哪里"和"我周围是什么”，前者对应自身定位问题，后者对应地图构建问题；
- 现有发展情况下，SLAM有两种实现形式：一是以激光雷达为主的激光SLAM；二是以摄像头为主的视觉SLAM；
  - 激光SLAM：主要通过激光雷达获取自动驾驶汽车周围环境的激光点云数据，激光雷达能以很高的精度测量出汽车周围物体的角度和距离，从而很方便实现SLAM及避障等功能；
  - 视觉SLAM：主要通过摄像头采集的数据进行同步定位与地图构建；视觉传感器采集的图像信息要比激光雷达得到的信息丰富，更有利于后期处理；视觉SLAM主要有两种实现路径：一是基于深度摄像头，如Kinect；二是基于单目、双目或鱼眼摄像头；
- 激光SLAM及基于深度摄像头的VSLAM通过收集到的激光点云数据，能直接计算障碍物距离；基于单目、双目、鱼眼摄像头的VSLAM，利用多帧图像来估计自身的位姿变化，再通过累计位姿变化来计算物体的距离，并进行定位与地图构建；

##### 1.2.3.1 [SLAM](https://so.csdn.net/so/search?q=SLAM&spm=1001.2101.3001.7020)的经典框架

**整个SLAM系统要实际解决的问题：如何通过传感器数据来估计自身状态(状态即位姿)；状态估计可视为一个数学建模过程，即如何通过带有噪声的测量数据，估计自身状态。即：**

![image-20220722101605045](https://img-blog.csdnimg.cn/img_convert/62aa5acb6231dff7feebd132f9319c75.png)

![1](https://img-blog.csdnimg.cn/6b79b0297fc247399b3415c475b63e63.jpeg#pic_center)

- 传感器数据

  传感器数据在视觉SLAM中主要是相机图像信息的读取和预处理，在激光SLAM中主要是激光点云数据的读取与预处理；

- 前端

  视觉SLAM中，前端相等于视觉里程计(Visual Odometer，VO)，主要研究帧与帧之间的变换关系；先提取每帧图像特征点，利用相邻帧图像进行特征点粗配准，然后利用算法去除错误匹配，进一步进行精配准得到一个位姿信息，同时可以将其与IMU提供的位姿信息进行融合；视觉里程计每次估计两帧图像之间的运动时会出现误差，这个误差会不断累积导致漂移现象；漂移现象通过回环检测和后端优化解决；

  激光SLAM中，前端扫描匹配是核心步骤，工作内容是已知前一帧位姿并利用相邻帧之间的关系估计当前帧的位姿；激光SLAM主流的前端扫描匹配算法主要有迭代最近邻算法及变种、相关性扫描匹配(Correlative Scan Matching，CSM)算法、正态分布变换算法、基于特征的匹配(Feature-Based Matching，FBM)算法等；

- 后端

  后端主要是对前端输出结果进行优化，利用滤波理论或优化理论进行树或图的优化，最终得到最优的位姿估计；主要方法有：基于贝叶斯滤波器的卡尔曼滤波、扩展卡尔曼滤波和粒子滤波等滤波理论方法，基于图优化的光流法、密集跟踪与映射(Dense Tracking And Mapping，DTAM)、大范围单目(Large-Scale Direct Monocular SLAM，LSD-SLAM)法和半直接(Semi-Direct Monocular Odometry，SVO)法等优化理论方法；

- 回环检测

  回环检测主要解决位置估计随时间漂移的问题，要求机器人或任何使用SLAM技术的设备具备识别出曾经到过的场景的能力，主要通过判断图像间的相似性来完成回环检测；如果检测成功，则把检测结果传给后端，后端根据这些信息重新调整行进轨迹和已构建的地图；

- 地图构建

  地图输出形式：度量地图、拓扑地图；度量地图强调精确地表示地图中的物体的位置关系，根据点云数据量分为稀疏地图和稠密地图；稀疏地图有选择性地忽略一部分信息，将所有物体进行一定程度的抽象，从而只保留部分具有意义的东西；稠密地图偏向于保留所有信息，将所有看到的东西进行建模；使用稀疏地图进行自动驾驶汽车的定位，稠密地图进行导航；2D的度量地图由小格子(Grid)组成，3D的度量地图由小方块(Voxel)组成；每个栅格通过占据、空闲和未知3种状态表达该栅格内是否有物体；拓扑地图强调地图内物体之间的相对关系，去掉细节问题；

##### 1.2.3.2 SLAM方案对比

- 成本

  激光雷达成本高，几万元到几十万元不等；视觉SLAM使用的摄像头成本低；

- 应用场景

  激光SLAM主要应用于室内及范围较小的环境；视觉SLAM应用场景更广泛，更能适应室外环境，但对光的依赖性强，在光线暗或无纹理区域无法工作；

- 地图精度

  激光SLAM构建的地图精度较高，达到厘米级，能直接用于定位导航；视觉SLAM构建的地图精度较低；

- 易用性

  激光SLAM和基于深度摄像头的视觉SLAM是通过直接获取环境中的点云数据，根据生成的点云数据估计障碍物及距离等信息；基于单目、双目摄像头的视觉SLAM不直接获取点云数据，而是通过摄像头获取灰色或彩色图像，完成特征点的提取与匹配等工作，然后利用各种测距方法得到障碍物的位置信息；

### 1.3 高精度地图云端服务体系

#### 1.3.1 高精度地图OTA服务

- 空中下载技术(Over The Air Technology，OTA)是通过移动通信(GSM、CDMA等)网络空中接口对数据及应用进行远程管理的技术；
- OTA最常用的功能是手机获取推送信息升级系统，这样手机系统更新可以通过无线下载方式进行，短时间内就可完成所有升级工作，无须备份数据可完好无损地保留所有数据，基本流程：生成更新包、传输更新包、安装更新包；
- 汽车业中，OTA分为：固件在线升级(Fireware Over The Air，FOTA)，即通过空中接口给电子控制单元(Electronic Control Unit，ECU)等车载设备下载完整的固件镜像，或修补现有固件、更新内存；另一类为软件在线升级(Software Over The Air，SOTA)，即应用程序和地图数据等的更新；

#### 1.3.2 传感器数据回传及更新技术

- 基于OTA衍生的传感器数据回传及更新技术可将终端采集的数据(包括车端状态、道路、路面标志等)回传到云端，在云端进行数据预处理、数据规格化、数据生产和数据发布；
- 传感器数据回传的内容包括：APP运行数据、汽车状态数据、车身传感器数据及地图采集数据；
  - APP运行数据：指APP的运行日志、崩溃日志、API调用等信息；
  - 汽车状态数据：指汽车的定位数据、速度、航向和数据置信度等信息；
  - 车身传感器数据：指通过传感器获取的雨刷速度、电量、胎压和车内温度等数据；
  - 地图采集数据：指传感器结合高精度地图所采集到的图像、视频及识别出的结构化数据等；
- 传感器数据回传的策略包括：主动上传和任务上传；
  - 主动上传：指当APP的状态、汽车行驶状态、道路状态发生变化时主动上传数据；
  - 任务上传：指满足任务要求，如当汽车到达指定区域时、当前状态与定义状态相同时上传数据；
- 传感器数据回传协议包括：传输协议、数据协议、缓存策略协议；
  - 传输协议：采用HTTP和MQTT协议；
  - 数据协议：采用SensorIS和SFCD协议；
  - 缓存策略协议：指上传流量限制机制、网络异常检测机制、数据量过小检测机制等；

### 1.4 高精地图解决方案

#### 1.4.1 高精度地图采集

![1](https://img-blog.csdnimg.cn/781260d2397f4154802d765592c1f523.jpeg#pic_center)

- 采集车是数据采集的核心载体，其搭载全球导航卫星系统、惯性导航系统(Inertial Navigation System，INS)、激光雷达、摄像头等系统及传感器设备；
- 外业采集的数据包括行车轨迹、图像、激光点云等数据，拥有车道线、路沿、护栏、路灯、交通标志等信息；
- 采集过程中，采集员需要实时监控采集情况，不断确认采集设备是否工作正常，且需要根据天气和环境情况来选择不同的摄像头参数；
- 采集的数据经过数据自检、复制、备份后，进行回传，待数据入库检查无误后，保存至外业原始资料库；若数据自检和入库检查的过程中发现数据有问题，需要进行补充采集；

##### 1.4.1.1 高精度地图采集设备

**高精度地图主流采集设备：激光雷达、摄像头、IMU、GNSS和轮测距仪的组合；激光雷达和摄像头用于获取采集车周围环境数据，IMU、GNSS和轮测距仪用于获取采集车的绝对位置；**

- 激光雷达(LiDAR)

  - 激光雷达先通过向目标物体发射一束激光，根据发射到接收的时间间隔确定目标物体的实际距离；在单个发射器和接收器上在短时间内发射较多的激光脉冲，脉冲发射后，接触到需要被检测的物体并反射回接收器上，每次发射和接收都可以获得一个点的具体坐标，当发射和接收进行得足够多时，形成环境激光点云，从而将汽车周围环境量化；
  - LiDAR系统一般分为三部分：一是激光发射器，发出波长为600～1000nm得激光射线；二是扫描与光学部件，主要用于收集激光发射点，获取该反射点发射到接收的时间差和水平角度信息；三是感光部件，主要检测返回光的强度，因此检测到的每个点都包括空间坐标信息及光强度信息；

- 摄像头(Camera)

  摄像头以图像的形式捕捉汽车周围环境信息，通过对这些图像进行处理以提取道路关键信息，进而完成地图的初步绘制；

- IMU(惯性测量单元)

  一般使用6轴运动处理组件，包含3轴加速度计和3轴陀螺仪；加速度计是力传感器，可根据各方向受力情况计算每个轴上的加速度；陀螺仪是角速度检测仪，可根据每个轴上的角加速度得到各轴上的角度变化；

- GNSS

  GNSS接收机由储存的星历确定每颗卫星在各时刻的位置，再结合由接收机与卫星间的信号传输时间计算得到二者时间的距离，即可根据三球定位原理推算出接收机的位置；

##### 1.4.1.2 数据模型

**高精度地图要素的数据模型分为四大类：道路模型(Road Model)、车道模型(Lane Model)、道路标记模型(Road Mark)、基本对象模型(Object)；**
![2](https://img-blog.csdnimg.cn/0e140f8eca484639a904c00ebcb6e8cc.jpeg#pic_center)

- 道路模型
  - 道路几何形状：指数据制作时，形状点连接成的道路的几何形状；通过形状点描述道路的几何形状时，形状点以坐标形式进行描述，如道路中心线与道路拓扑等；
  - 曲率：表示道路的弯曲程度，弯曲程度越大曲率值越大，弯曲程度越小曲率值越小；计算时，采取曲线拟合方法，得到各形状点所在的曲率半径的倒数，根据道路的几何形状，进行曲线拟合后计算出离散点的曲率值；
  - 坡度：指道路纵向的起伏程度，道路起伏程度越大则坡度越大，道路起伏程度越小则坡度越小；计算时，对形状点高程差与水平距离取反正切计算得到坡度；
    ![3](https://img-blog.csdnimg.cn/5477acc853e94bdbba99b50baecac622.jpeg#pic_center)
- 车道模型
  - 车道类型：指地面道路上该车道的类型，主要包括：普通车道、入口车道、出口车道、进入匝道、退出匝道、应急车道、连接匝道等；车道类型会赋值在该车道上；
  - 普通车道：指无特殊属性的车道，一般为主行车道；普通车道普遍指高速中的主路，按照实际的车道形态进行制作表达，并在右侧车道上赋值主路属性；
- 道路标记模型
  - 道路标记模型：主要指车道线的形式，包括：无属性、单实线、长虚线、双实线、左实右虚线、右实左虚线、双虚线、路沿线、护栏线；道路标线会赋值在对应的车道线上；
- 基本对象模型
  - 高精度地图中对象的类型包括：杆、牌、龙门架、地面标线等；杆类型包括：灯杆、基站杆、摄像头杆、交通标志牌依附的杆等；地面标线分为：地面箭头、地面文字、导流区、地面限速等；

#### 1.4.2 高精度地图制作与编译

**采集车采集到符合要求的数据并回传保存后，先进行数据处理，将各传感器数据进行融合以进行各种对象的识别及标注，针对其中的误差及错误进行人工检查并更正，之后编译成可供自动驾驶应用的符合格式规范的高精度地图。**

##### 1.4.2.1 高精度地图数据处理

- 数据处理：指对收集到的数据进行整理、分类和清洗以获得初始地图模板，其中不包括任何语义信息或注释，之后通过激光点云配准、激光点云识别和图像识别等AI技术，把不同传感器采集的数据进行融合，即把GNSS、激光点云、图像等数据叠加在一起，进行道路标线、路沿、路牌、交通标志等道路元素的识别及分类；
- 一般在制图过程中处理的数据以激光点云为主，小部分以视觉为主；在城市道路中采用实时动态差分技术(Real Time Kinematic，RTK)方案获取位置信息，但高楼遮挡或林荫路等场景对信号的稳定性影响无法避免，在采集到激光点云后需要借助SLAM或其他方案，对位姿进行优化，然后才能将激光点云准确拼接，形成一个完整的激光点云；拼接成高度精确的激光点云地图后，对其进行识别、标注来绘制高精度地图；
- 激光点云识别包括：基于深度学习的元素识别和基于深度学习的激光点云分类；

##### 1.4.2.2 高精度地图编译及格式规范

- 高精度地图生成的最后一步是进行数据编译，将上述步骤中编辑好的高精度地图编译成可供自动驾驶应用且符合格式规范的高精度地图；
- 主流的通用格式规范：导航数据标准(Navigation Data Standard，NDS)和OpenDRIVE；
- 其他标准：JDRMA标准、KIWI格式标准、GDF标准、Etak标准、NavTech标准；

#### 1.4.3 高精度地图质量控制与发布

##### 1.4.3.1 高精度地图的质量控制流程

**高精度地图质量要求贯穿整个地图生产过程，包含各个生成过程的检查方式、检查内容、成果质量评定标准；具体到地图生产的各环节，包括：高精度地图资料采集、实地外业数据采集、室内数据制作、地图编译、高精度地图产品测试和产品发布；**
![5](https://img-blog.csdnimg.cn/7d5b2748a05f45e4bcc18c175070a2c8.jpeg#pic_center)

- 外业采集质控
  - 一级质检：组长检验，主要进行有效性检验；
  - 二级质检：质量控制检验，主要进行有效性检验和实地检验；
  - 三级质检：质量部验收，主要进行有效性检验、室内检验和实地检验；
  - 有效性检验：检验采集指引的完备性、有效性和正确性；检验方式：人工，根据城市采集指引及维护资料，对照外业采集成果进行检验；同时进行分城市、分区域、分要素的成果统计；
  - 室内检验：检验采集成果的完整性、逻辑一致性及可用性；由检验人员以城市或区域为单位进行自动化处理，快速识别和检出有效问题点，通过人机交互方式快速识别和检验；
  - 实地检验：检验相对于实地的完备性、正确性；检验方式：检验开始前，由检验人员根据城市重要区域、重要路段等挑选质检区域，然后按路线设计进行实际的采集检验，做问题记录；
- 室内制作质控
  - 第一阶段：程序处理检验。检验方式：首先，检验开始前，由检验人员均匀抽取各种场景，然后，按规范标准要求，检验自动化处理数据的准召情况，输出准召率；
  - 第二阶段：基础要素与高阶要素检验。检验方式：作业阶段进行自检、质检员进行抽检、质量保证验收；
  - 第三阶段：数据接边检验及交付检验；
- 产品化质控
  - 数据逻辑和阈值检验利用产品理论检查工具按照高精数据交换规格对数据连通关系、阈值等进行检验并输出结果；
  - 数据一致性检验利用产品可视化检查工具，对高精产品数据与现实的一致性进行人工检查，并记录数据问题；

##### 1.4.3.2 高精度地图的数据质量标准

**高精度地图的数据质量控制目标分为：数据完整性、逻辑一致性、位置准确度、专题准确度、时间准确度；**
![6](https://img-blog.csdnimg.cn/4010507d66634c16b514e05b4b6ad346.jpeg#pic_center)
**高精度地图属性质量标准表：**

| 要素         | 误报率标准 | 漏报率标准 |
| ------------ | ---------- | ---------- |
| 车道线几何   | 0.50%      | 0.50%      |
| 车道类型     | 0.30%      | 0.30%      |
| 车道通行状态 | 0.10%      | 0.10%      |
| 车道收费情况 | 0.10%      | 0.10%      |
| 车道线类型   | 0.20%      | 0.20%      |
| 车道线颜色   | 0.20%      | 0.20%      |
| 车道线粗细   | 0.10%      | 0.10%      |
| 路沿         | 0.50%      | 0.50%      |
| 护栏         | 0.50%      | 0.50%      |
| 限速         | 1%         | 1%         |
| 交叉点       | 0.50%      | 0.50%      |

##### 1.4.3.3 地图引擎与发布

- "地图引擎"提供读写高精度地图数据的应用程序编程接口(Application Programming Interface，API)；
- 从应用层看，"地图引擎"就是一套提供了驱动和管理地图数据，实现渲染、查询等功能的一套函数库，所有的应用层软件只需要调用"地图引擎"提供的API就能实现读取、增添、删除及修改高精度地图，从而保持车端地图的鲜度；
- "地图引擎"基于车端数据互传机制，采集车端状态和道路数据，通过地图更新、数据回传形成云端到车端的数据闭环，持续优化高精度地图。

## 2 汽车定位技术

- **基于信号的定位**。采用飞行时间测距法(Time Of Flight，TOF)获取汽车与卫星间的距离，基于三球定位原理得到汽车的空间绝对位置；典型代表：全球导航卫星系统(Global Navigation Satellite System，GNSS)，常用的GPS(Global Positioning System，全球定位系统)是GNSS中的一种；
- **航迹递推(Dead Reckoning，DR)**。DR依靠加速度计(Accelerometer)、陀螺仪(Gyroscope)、里程计(Odometer)等，根据上一时刻汽车的位置和航向递推出当前时刻汽车的位置和航向；
- **地图匹配(Map Matching，MM)**。用激光雷达(LiDAR)或摄像头(Camera)采集到的数据特征和高精度地图数据库中存储的特征进行匹配，得到实时的汽车位姿；

### 2.1 卫星导航定位系统简介

#### 2.1.1 全球4大导航卫星系统

**美国的全球定位系统(Global Positioning System，GPS)、俄罗斯的格洛纳斯卫星导航系统(Global Navigation Satellite System，GLONASS)、中国的北斗卫星导航系统(Beidou Navigation Satellite System，BDS)、欧盟的伽利略卫星导航系统(Galileo Satellite Navigation System，GALILEO)**；

1. GPS

   GPS由3部分构成，即空间卫星部分、地面监控部分和用户接收部分；

   - 空间卫星部分(空间段)：由21颗GPS工作卫星和3颗在轨备用卫星构成完整的21+3形式的GPS卫星工作星座；这种构型满足在地球上任意地点、任意时刻均能观测到至少4颗几何关系较好的卫星用于定位；
   - 地面控制部分(地面段)：由分布在全球的一个主控站、3个注入站和若干个监测站组成；
   - 用户接收部分(用户段)：主要接收导航、定位和授时服务，这些服务广泛应用于各个领域；

2. GLONASS

   GLONASS由空间段、地面段、用户段组成；

   - 空间段：由24颗卫星组成，其中21颗为正常工作卫星，3颗备份卫星；如果GLONASS星座完整，则可以满足在地球上任意地点、任意时刻都能收到来自至少4颗卫星的信号，从而获取可靠的导航定位信息；
   - 地面段：包括系统控制中心的跟踪控制站网，这些跟踪控制站网分散在俄罗斯领土上；
   - 用户段：接收卫星导航信号，从而获取需要的位置、速度、时间信息；

3. BDS

   北斗系统由空间段、地面段、用户段组成；

   - 空间段：由5颗地球静止轨道(Geostationary Orbit，GEO)卫星和30颗非地球静止轨道(Nongeostationary Orbit，NON-GEO)卫星组成；北斗二号区域导航系统采用由5颗GEO卫星、3颗倾斜地球同步轨道(Inclined Geosynchronous Orbit，IGSO)卫星和4颗中地球轨道(Medium Earth Orbit，MEO)导航卫星组成的星座方案；北斗三号导航系统由5颗GEO卫星和30颗NON-GEO卫星组成全部35颗卫星；
   - GEO+MEO+IGSO星座构型是北斗卫星导航系统的完整布局，保证了在地球上任意地点、任意时刻均能接收来自4颗及以上导航卫星发射的信号，观测条件良好的地区甚至可以接收10余颗卫星的信号；
   - 地面段：包括监测站、上行注入站、主控站；

4. GALILEO

   GALILEO分为空间段、地面段、用户段；

   - 空间段：由分布在3个轨道上的30颗MEO卫星构成，其中27颗工作卫星、3颗备份卫星；
   - 地面段：由2个地面操控站，29个伽利略传感器站及5个S波段上行站和10个C波段上行站组成，传感器站及上行站均分布于全球；
   - 用户段：提供独立于其他卫星导航系统的5种基本服务；

#### 2.1.2 区域卫星导航系统

- 日本的准天顶卫星系统(Quasi-Zenith Satellite System，QZSS)；
- 印度的区域导航卫星系统(Indian Regional Navigation Satellite System，IRNSS)；

#### 2.1.3 星基增强系统

星基增强系统(Satellite-Based Augmentation System，SBAS)由美国实施选择可用性(Selective Availability，SA)政策发展起来；SBAS主要由空间段、地面段、用户段构成；典型的增强系统：

- 美国的WAAS(Wide Area Augmentation System)；
- 俄罗斯的SDCM(System for Differential Corrections and Monitoring)；
- 日本的MSAS(Multi-functional Satellite Augementation System)；
- 欧洲的EGNOS(European Geostationary Navigation Overlay Service)；
- 印度的GAGAN(GPS Aided Geo Augmented Navigation);

#### 2.1.4 地基增强系统

地基增强系统(Ground-Based Augmentation Systems，GBAS)综合使用各种不同效果的导航增强技术，主要包括：精度增强技术、完好性增强技术、连续性和可用性增强技术，实现增强卫星导航服务性能的功能；

北斗地基增强系统由框架网基准站和加强密度网基准站、通信网络、数据处理系统、运营平台、数据播发系统和用户终端组成，具备在全国范围内为用户提供广域实时米级、分米级、厘米级及后处理毫米级定位精度的能力，具有作用范围广、精度高、野外单机作业等优点；

### 2.2 GNSS定位原理

**要实现GNSS定位，需要解决两个问题：一是观测瞬间卫星的空间位置；二是观测站点和卫星之间的距离，即卫星在某坐标系中的坐标；**

#### 2.2.1 坐标系统与时间系统

- 卫星导航系统中，坐标系用于描述与研究卫星在其轨道上的运动、表达地面观测站的位置及处理定位观测数据；
- 坐标系统大概分为：地理坐标系、惯性坐标系、地球坐标系、地心坐标系、参心坐标系；
- 国内常用坐标系：1954年北京54坐标系(Beijing 54 Coordinate System，P54)、1980年国家大地坐标系(National Geodetic Coordinate System 1980，C80)、1984年世界大地坐标系统(World Geodetic System-1984 Coordinate System，WGS-1984)、2000年国家大地坐标系(China Geodetic Coordinate System 2000，CGCS2000)；
- 时间系统主要包括：世界时、历书时、力学时、原子时、协调世界时、儒略日、卫星导航时间系统；
- GNSS采用一个独立的时间系统作为导航定位计算的依据，称为GNSS时间系统，简称GNSST；GNSST属于原子时系统，其秒长与原子时秒长相同；

#### 2.2.2 定位原理

假设地面测得某点P PP到卫星S 1 S_1S1的距离为r 1 r_1r1，从几何学可知，P PP点所在的空间可能位置集缩到一个球面上，此球面的球心为卫星S 1 S_1S1，半径为r 1 r_1r1；再假设测得P PP点到第二颗卫星S 2 S_2S2的距离为r 2 r_2r2，同样，P PP点处于以第二颗卫星S 2 S_2S2为球心，半径为r 2 r_2r2的球面上；如果同时测得P PP点到第三颗卫星S 3 S_3S3的距离为r 3 r_3r3，即P PP点处于以第三颗卫星S 3 S_3S3为球心，半径为r 3 r_3r3的球面上，这样即可确定P PP点位置，即三个球面的交汇处。
![1](https://img-blog.csdnimg.cn/5daa0a0865d843ab99af2e4930295ae7.png#pic_center)
由于GNSS采用单程测距，难以保证卫星钟与用户接收机钟的严格同步，观测站和卫星之间的距离均受两种时钟不同步的影响；卫星钟差可用导航电文中所给的有关钟差参数进行修正，接收机钟差大多难以精准确定，通常采用的优化方法是将其作为一个未知参数，与观测站坐标一并求解，即一般在一个观测站上需求解4个未知参数(3个点位坐标分量和1个钟差参数)，因此至少需要4个同步伪距观测值，即需要同时观测4颗卫星；

**根据用户站的运动状态将GNSS分为静态定位和动态定位。**

- 静态定位：将待定点固定不变，将接收机安置在待定点上进行大量的重复观测；
- 动态定位：指待定点处于运动状态，测定待定点在各观测时刻运动中的点位坐标，以及运动载体的状态参数，如：速度、时间和方位等；

**根据定位模式分为绝对定位和相对定位。**

- 绝对定位：只用一台接收机来进行定位，称为单点定位，所确定的是接收机天线在坐标系统中的绝对位置；
- 相对定位：指将两台接收机安置于两个固定不变的待定点上，或将一个点固定于已知点上，另一个点作为流动待定点，经过一段时间的同步观测，可以确定两个点之间的相对位置，从而获得高精度的位置坐标；

### 2.3 GNSS数据误差

**卫星导航系统的误差从来源上分为：与信号传播有关的误差、与卫星有关的误差、与接收机有关的误差、与地球转动有关的误差；**

- 与信号传播有关的误差：包括电离层延迟误差、对流层延迟误差及多径效应误差；
- 与卫星有关的误差：包括卫星星历误差、卫星时钟误差、相对论效应等；
- 与接收机有关的误差：包括接收机时钟误差、(接收机天线相位中心相对于测站标识中心的)位置误差和天线相位中心位置的误差；
- 与地球转动有关的误差：包括地球潮汐、地球自转的影响；

![1](https://img-blog.csdnimg.cn/ea975646de104599958ff901cd3f8951.jpeg#pic_center)

- 电离层延迟误差
  - 电离层：处于地球上空50～1000km高度的大气层；
  - 电离层中，电磁波的传输速率与电子密度有关；因此直接将真空中电磁波的传播速度乘以信号的传播时间得到的距离，很大可能与卫星至接收机的真实几何距离不相等，两种距离上的偏差称为电离层延迟误差；
  - 电离层延迟误差是影响卫星定位的主要误差之一，一般在白天可以达到15m的误差，在夜晚达到3m的误差，在天顶方向引起的误差最大可达50m，水平方向引起的误差最大可达150m；
  - 针对电离层延迟误差的改进措施：包括利用双频观测、利用电离层模型辅以修正和利用同步观测值求差；
- 多径效应误差
  - 接收机接收信号时，如果接收机周围物体所反射的信号也进入天线，且与来自卫星的信号通过不同路径传播且于不同时间到达接收端，反射信号和来自卫星的直达信号相互叠加干扰，使原本的信号失真或产生错误，造成衰落，这种由于多径信号传播引起的衰落称为多径效应；
  - 多径效应误差是卫星导航系统中一种主要的误差源，可造成卫星定位精确度的损害，严重时还将引起信号的失锁；
  - 改进措施：包括将接收机天线安置在远离强反射面的环境、选择抗多径天线、适当延长观测时间、降低周期性影响、改进接收机的电路设计、改进抗多径信号处理和自适应抵消技术；
- 卫星星历误差
  - 由星历所给出的卫星位置与卫星实际位置之差称为卫星星历误差；
  - 卫星星历误差主要由钟差、频偏、频漂等产生；
  - 改进措施：包括忽略轨道误差、通过轨道改进法处理观测数据、采用精密星历和同步观测值求差；

### 2.4 差分GNSS定位技术

- **差分GNSS基本原理：在一定地域范围内设置一台或多台接收机，将一台已知精密坐标的接收机作为差分基准站，基准站连续接收GNSS信号，与基准站已知的位置和距离数据进行比较，从而计算出差分校正量，然后，基准站将此差分校正量发送到其范围内的流动站进行数据修正，从而减少甚至消除卫星时钟、卫星星历、电离层延迟与对流层延迟所引起的误差，提高定位精度；**
- 流动站与差分基准站的距离直接影响差分GNSS的效果，流动站与差分基准站的距离越近，两站点之间测量误差相关性越强，差分GNSS系统性能越好；
- 根据差分校正的目标参量不同，差分GNSS主要分为**位置差分、伪距差分和载波相位差分**；

#### 2.4.1 位置差分

![2](https://img-blog.csdnimg.cn/5294803f8ae64df08d441436f7cbe5f3.png#pic_center)

- 通过在已知坐标点的基准站上安装GNSS接收机来对4颗或4颗以上的卫星进行实时观测，即可进行定位，得出当前基准站的坐标测量值；
- 由于误差的存在，通过GNSS接收机接收的消息解算的坐标与基准站的已知坐标是不同的，将坐标测量值与基准站实际坐标值的差值作为差分校正量；基准站利用数据链将所得的差分校正量发送到流动站，流动站利用接收到的差分校正量与自身GNSS接收机接收到的测量值进行坐标修改；
- 位置差分法应用范围受距离限制，通常流动站与基准站间距离不超过100km；

#### 2.4.2 伪距差分

![3](https://img-blog.csdnimg.cn/c9fdf96b45074897947550a646be8999.png#pic_center)

- 伪距差分技术：在一定范围的定位区域内，设置一个或多个安装GNSS接收机的已知点作为基准站，连续跟踪、观测所有在信号接收范围内的GNSS卫星伪距，通过在基准站上利用已知坐标求出卫星到基准站的真实几何距离，将其与观测所得的伪距比较，然后通过滤波器对此差值进行滤波并获得其伪距修正值；然后，基准站将所有伪距修正值发送给流动站，流动站利用这些误差值来改正GNSS卫星传输测量伪距；最后，用户利用修正后的伪距进行定位；
- 在一定区域内，流动站与基准站的距离越小，使用GNSS差分得到的定位精度越高；

#### 2.4.3 载波相位差分

- 载波相位实现差分的方法有修正法和差分法；
  - **修正法：由基准站将载波相位修正量发送给流动站，以改正其载波相位观测值，然后得到自身坐标；**
  - **差分法：将基准站观测的载波相位测量值发送给流动站，使其自身求出差分修正量，从而实现差分定位；**
- 载波相位差分技术中基准站不直接传输关于GNSS测量的差分校正量，而是发送GNSS的测量原始值；流动站收到基准站的数据后，与自身观测卫星的数据组成相位差分观测值，利用组合后的测量值求出基线向量完成相对定位，进而推算出测量点的坐标；
- 在使用载波差分法进行相位测量时，每一个相位的观测值都包含有无法直接观测载波的未知整周期数，称为相位整周模糊度；求解相位整周模糊度分为：初始化方法和无初始化方法；
  - 初始化方法：要求具有初始化过程，即对流动站进行一定时间的固定观测，一般需要15min，利用静态相对测量软件进行求解，得到每颗卫星的相位整周模糊度并固定此值，便于以后的动态测量中将此相位整周模糊度作为已知量进行求解；
  - 无初始化方法：实际上仍需要时间较短的初始化过程，一般只需3～5min，随后快速求解相位整周模糊度；
- RTK：一种利用接收机实时观测卫星信号载波相位的技术，结合了数据通信技术与卫星定位技术，采用实时解算和数据处理的方式，能够实现为流动站提供在指定坐标系中的实时三维坐标点，在极短时间内实现高精度的位置定位；
- 常用的RTK定位技术分为：常规RTK和网络RTK；

**常规RTK技术：**
![4](https://img-blog.csdnimg.cn/4975e240a06440f3931679e079f4487c.png#pic_center)

- 常规RTK定位技术是一种基于GNSS高精度载波相位观测值的实时动态差分定位技术，也可用于快速静态定位；
- 采用常规RTK进行定位工作时，除需配备基准站接收机和流动站接收机外，还需要数据通信设备，基准站通过数据链路将自己所获得的载波相位观测值及站坐标实时播发给其周围工作的动态用户；
- 流动站数据处理模块通过动态差分定位方式，确定流动站相对于基准站的位置，并根据基准站的坐标得到自身的瞬时绝对位置；
- 常规RTK定位技术可以满足很多应用的需求，但流动站与基准站距离不能过远，当距离大于50km时，常规RTK一般只能达到分米级的定位精度；

**网络RTK定位技术：**
![5](https://img-blog.csdnimg.cn/71cdedfc164f4251a9ca6ae23476a973.png#pic_center)

- 网络RTK亦称多基准站RTK；网络RTK属于实时载波相位双差定位；
- **网络RTK原理：指在某一区域内由若干个固定的、连续运行的GNSS基准站形成一个基准站网络，对区域内全方位覆盖，并以这些基准站中的一个或多个为基准，为该地区内的GNSS用户实现实时、高精度定位提供GNSS误差改正信息；**
- 网络RTK主要包括：固定的基准站网、负责数据处理的控制中心部分、数据播发中心、数据链路和用户站；
- **基准站网由若干个基准站组成，每个基准站都配备有双频全波长GNSS接收机、数据通信设备和气象仪器等；通过长时间GNSS静态相对定位等方法可以精确得到基准站的坐标，基准站GNSS接收机按一定采样率进行连续观测，通过数据链路将观测数据实时传送给数据处理中心，数据处理中心先对各个站的数据进行预处理和质量分析，然后对整个基准站的数据进行统一解算，实时估计出网内的各种系统误差的改正项(电离层、对流层、轨道误差)，并建立误差模型；**
- 根据通信方式不同，将网络RTK分为：单向数据通信和双向数据通信；
  - 单向数据通信：数据处理中心直接通过数据播发设备把误差参数广播出去，用户收到这些误差改正参数后，根据自己的坐标和相应的误差改正模型计算出误差改正数，从而进行高精度定位；
  - 双向数据通信：数据处理中心对流动站的服务请求进行实时侦听，并接收来自流动站的近似坐标，根据流动站的近似坐标和误差模型，求出流动站处的误差后，直接将改正数或虚拟观测值播发给用户；

### 2.5 惯性导航定位系统简介

![1](https://img-blog.csdnimg.cn/4cf9e38a92fa4a72bb9850aef97c1f64.jpeg#pic_center)
**惯性导航系统是一种不依赖外部信息，也不向外部辐射能量的自主式导航系统，主要由惯性测量单元、信号预处理和机械力学编排3个模块组成；**

- **一个惯性测量单元包括3个相互正交的单轴加速度计(Accelerometer)和3个相互正交的单轴陀螺仪(Gyroscopes)；**
  ![2](https://img-blog.csdnimg.cn/2b01879907be429f932c224f11c41c18.png#pic_center)
- **信号预处理部分：对惯性测量单元输出信号进行信号调理、误差补偿并检查输出量范围等，以确保惯性测量单元正常工作；**
- **惯性导航系统根据机械力学编排形式不同，分为：平台式惯性导航系统(Gimbaled Inertial Navigation System，GINS)和捷联式惯性导航系统(Strap-down Inertial Navigation System，SINS)；**
- 自动驾驶领域常用捷联式惯性导航系统；

#### 2.5.1 惯性导航定位系统工作原理

- 惯性导航定位系统工作原理基于牛顿第二定律，F = ma；
- 惯性导航定位系统利用载体先前的位置、测量惯性单元测量的加速度和角速度来确定当前位置；
- 其中速度v和偏移量s可以通过对加速度a的积分得到；加速度a经过积分得到速度v，经过二重积分得到偏移量s。

![image-20220722102920312](https://img-blog.csdnimg.cn/img_convert/71eb40abed5fb64258883ae695a85c91.png)

- 汽车的俯仰、偏航、翻滚等姿态信息可以通过对角加速度的积分得到；利用姿态信息把导航参数从惯性坐标系变换到导航坐标系中；
- **惯性导航定位系统是一个由惯性测量单元和积分器组成的积分系统；该系统通过陀螺仪测量载体旋转信息求解载体姿态信息，将加速度计测量得到的载体比力信息转换到导航坐标系进行加速度信息的积分运算，即可推算出汽车的位置和姿态信息；**
- **从一个已知的坐标位置开始，根据载体在该点的航向、航速和航行时间，推算下一时刻该坐标位置的导航过程称为航迹递推；**
- **惯性导航定位被描述为在一个稳定坐标系下且被明确定义的与时间相关的函数，数学描述为：**

![image-20220722102936519](https://img-blog.csdnimg.cn/img_convert/132c533fad6970cde83a8870bafb263a.png)

### 2.6 地图匹配定位技术简介

- 地图匹配定位技术是利用实时道路物理信息与预制高精度地图进行匹配来实现汽车定位的技术；
- 引入地图匹配可以有效消除系统随机误差，校正传感器参数，弥补在城市高楼区、林荫道、立交桥、隧道中长时间GNSS定位失效而惯性导航系统误差急剧增大时的定位真空期；
- **地图匹配定位技术指将自动驾驶汽车行驶轨迹的经纬度采样序列与高精度地图路网匹配的过程；**
- 如下图所示，由于各种原因导致自动驾驶汽车定位信息存在误差，尽管汽车行驶在中间车道上，但定位结果与实际情况存在误差，利用地图匹配定位技术将汽车定位信息纠正回正确车道，提高定位精度；
  ![1](https://img-blog.csdnimg.cn/b099314a12574251a287f215fc8df894.jpeg#pic_center)

#### 2.6.1 地图匹配定位技术原理

![2](https://img-blog.csdnimg.cn/d048c6e0fd64415baaca94052c270664.jpeg#pic_center)

- 地图匹配定位是在已知汽车的位姿信息的条件下进行高精度地图局部搜索的过程；
  - 首先，利用汽车装载的GNSS和INS做出初始位置判断，确定高精度地图局部搜索范围；
  - 然后，将激光雷达实时数据与预先制作好的高精度地图数据变换到同一个坐标系内进行匹配，匹配成功后即可确认汽车定位信息；
- 高精度地图预制是地图匹配的基础，需要包含特征明显的结构化语义特征和具有统计意义的信息；
- 高精度地图中常用于地图匹配的特征包括：车道线、停止线、导流线、路灯、电线杆等特征明显的物体，同时，还包括平均反射值、方差及平均高度值等具有统计意义的信息；

![3](https://img-blog.csdnimg.cn/82cb6956db6c489c963a1e1a5891987c.jpeg#pic_center)
![4](https://img-blog.csdnimg.cn/fc19af0bb0eb47cb8a88dfcebd7f5f83.jpeg#pic_center)

- 根据实时感知数据进行环境特征的检测，主要检测对象是地面上的车道线与杆状物，并从高精地图对应位置范围内提取对应的元素；实际匹配过程中，系统将检测出的车道线、护栏等道路特征与高精地图提供的道路特征进行对比，修正汽车的横纵向定位；
- 图3-19：GNSS将汽车定位在前进方向的左侧车道，自动驾驶汽车利用传感器检测到车道线信息与高精度地图数据进行匹配后，确定汽车位于前进方向中间车道，与GNSS的定位结果存在差异，进而修正横向的位姿误差；
- 图3-20：纵向上修正主要提取传感器所检测到的广告牌、红绿灯、交通标志灯等道路元素与高精度地图进行匹配，可以修正汽车的纵向误差；

#### 2.6.2 地图匹配定位误差分析

**地图匹配定位误差主要由局部搜索范围正确性引起；局部搜索范围正确性即道路选择的正确性，是地图匹配中极大影响因素之一，在选择道路正确情况下，才能继续地图匹配过程；造成道路选择错误的原因主要包括：路况引起的误差、传感器误差、高精度地图误差及算法误差等方面；**

1. 路况引起的误差

   - 车速变化将影响传感器采集数据的质量，车速越快，质量越低，甚至产生运动模糊、失真等情况；
   - 在没有INS定位系统中，各种路况下造成的汽车轮胎的漂移及地面颠簸等情况都可能使激光点云数据存在畸变、抖动和运动模糊等问题；
   - 实际行驶情况中汽车有时会离开道路，将导致道路匹配错误并引起误差；

2. 传感器误差

   进行地图匹配需要利用传感器的量测信息，这些数据存在误差将直接影响定位速度与成功率；

3. 高精度地图误差

   在地图数据本身存在误差时，即使在正确选择道路的情况下也会引入误差；

4. 算法误差

   在地图匹配过程中不可避免地因算法存在的缺点导致发生错误匹配，发生错误匹配会对之后的地图匹配定位结果产生恶劣的影响；

#### 2.6.3 地图匹配常用算法

任何地图匹配算法都涉及两个根本问题：**一是当前汽车在哪一条道路上；二是当前汽车在对应道路的哪一个位置；** 地图匹配算法可用下式进行形式化描述：

![image-20220722103324117](https://img-blog.csdnimg.cn/img_convert/2f7d6318aa554fb722a1fc44871fe38d.png)

##### 2.6.3.1 几何匹配算法

几何匹配算法包括：点到点、点到弧、弧到弧的地图匹配算法；

1. 点到点地图匹配算法
   - 原理：搜索汽车定位点与高精度地图中位置点之间几何距离最近的点作为匹配结果；
   - 该算法匹配精度取决于位置点集的数量，随着位置点集数量的增大，匹配精度更高；
2. 点到弧的地图匹配算法
   - 原理：通过寻找与汽车定位点几何距离最近的路段作为匹配线段，将汽车定位点投影到该线段上作为匹配结果；
   - 对于曲线则做线性化处理后进行投影，该算法只利用部分数据，当两条曲线距离较小或相同时容易造成误匹配，在路网密度大时匹配结果精度锐减，算法缺乏稳定性；
3. 弧到弧地图匹配算法
   - 原理：将连续的汽车定位点组成一条轨迹曲线，寻找与这条曲线最近的匹配弧线作为匹配线段；
   - 若某定位点与非正确匹配线段非常近，将导致严重误差；

##### 2.6.3.2 概率统计算法

**概率统计算法通过在汽车导航定位系统中获得的历史轨迹，建立置信区域来与高精度地图进行匹配；置信区域参考GNSS误差、汽车航迹、汽车速度及道路信息等进行选取，与高精度地图匹配后采取最近距离原则来确定匹配线段；**
![5](https://img-blog.csdnimg.cn/7cd28b4add064956a1670b984d36ad44.jpeg#pic_center)

- 基于概率统计地图匹配算法包括三个主要处理过程：确定误差区域、选取候选路段、计算匹配位置；
- 误差区域：指可能包含汽车真实位置的区域范围，应根据传感器定位结果和误差情况确定；
- 在误差区域内的道路称为候选路段，地图匹配算法认为其中包含了汽车的真实位置；
- 匹配路段的选取方法：从候选路段中挑选最有可能的汽车行驶路段，挑选原则依据具体的算法设计而不同；通常，挑选参考量是高精地图中的道路形状与汽车轨迹的相似程度；
- 确定匹配路段后，计算汽车在该路段中最有可能的位置，并用匹配结果修正原有的定位信息；

##### 2.6.3.3 其他高级算法

- 其他算法：非参数滤波算法和参数滤波算法；
- 非参数滤波算法包括：直方图滤波(Histogram Filter，HF)和粒子滤波(Particlce Filter，PF)等；
- 参数滤波算法包括：卡尔曼滤波、扩展卡尔曼滤波(Extended Kalman Filter，EKF)、信息滤波(Information Filter，IF)、扩展信息滤波(Extended Information Filter，EIF)等；

### 2.7 多传感器融合定位简介

- **多传感器融合：将不同传感器对某一目标或环境特征描述的信息融合成统一的特征表达信息及其处理的过程；**
- 多传感器数据融合实际上是模拟人脑综合处理复杂问题的过程，通过对各种传感器及其观测信息的合理支配与使用，将各种传感器在空间和时间上的互补与冗余信息，依据某种优化准则加以组合，产生对观测环境或对象的一致性解释和描述，实现多个传感器共同或联合操作，提高整个传感器系统的有效性；
- **数据融合的目标：利用各种传感器的独立观测信息，对数据进行多级别、多方位和多层次的处理，产生新的有意义的信息；**
- 自动驾驶汽车定位主要模式：DR、GNSS、GNSS/DR组合定位；引入地图匹配后，组合出新的模式：DR/MM、GNSS/MM、GNSS/DR/MM；多传感器融合定位系统可在6中模式中自动切换以提高整个系统的定位精度和可靠性；

#### 2.7.1 多传感器融合定位系统[体系结构](https://so.csdn.net/so/search?q=体系结构&spm=1001.2101.3001.7020)

**多传感器融合定位系统体系结构主要包括：松耦合(Loose Coupling)、紧耦合(Tight Coupling)、深耦合(Deep Coupling)；**

1. 松耦合
   松耦合系统中，GNSS给INS提供位置信息，二者硬件上相互独立且可随时断开连接，分别输出定位信息与速度信息到融合滤波器，融合滤波器进行优化处理后将结果反馈给惯性导航系统对其修正后进行输出；
   ![1](https://img-blog.csdnimg.cn/1fa3c6528f8543a484a81e2fbaf56aac.jpeg#pic_center)
2. 紧耦合
   紧耦合将由GNSS码环与载波跟踪环解算得到的伪距、伪距率与由惯性导航系统结合自身信息和卫星星历进行计算得到的伪距、伪距率做差，得到伪距与伪距率的测量残差，将其作为融合滤波器的输入观测量，得到惯性导航系统计算误差以完成对惯性导航系统的校正并获得位置与速度的最有估计值；
   ![2](https://img-blog.csdnimg.cn/716f79f08a4d4c25b7dc49d3e0ef56c2.jpeg#pic_center)
3. 深耦合
   深耦合系统相对于紧耦合系统，增加了INS单元对GNSS接收机的辅助；利用INS单元结合星历可以对伪距与载波的多普勒频移进行估计，利用估计结果辅助接收机的捕获与跟踪环路，可以有效地提高GNSS接收机跟踪环路的动态性与灵敏度；

#### 2.7.2 多传感器融合定位系统分层

![3](https://img-blog.csdnimg.cn/9030d9d660cc462c92842dc22f57e3db.jpeg#pic_center)
**多传感器融合定位系统划分为：数据层融合、特征层融合、决策层融合；**

1. 数据层融合(像素级融合)

   - 数据层融合，首先将传感器的观测数据融合，然后从融合的数据中提取特征向量，并进行判断识别；
   - 数据层融合需要传感器是同质的(传感器观测的是同一物理量)，如果多个传感器是异质的(传感器观测的不是同一个物理量)，则数据只能在特征层或决策层融合；

2. 特征层融合

   特征层融合先从每种传感器提供的观测数据中提取有代表性的特征，这些特征融合成单一的特征向量，然后运用模式识别的方法进行处理；

3. 决策层融合

   决策层融合指在每个传感器对目标做出识别后，再将多个传感器的识别结果进行融合，属于高层次融合；

### 2.8 多传感器融合定位系统原理

![4](https://img-blog.csdnimg.cn/df8ab95f1b6f4f7cb414a949fe9afa5f.png#pic_center)

- 多传感器融合定位系统输入主要来自GNSS-RTK、惯性导航系统和地图匹配定位系统；
- 融合定位系统对其数据进行预处理、数据配准和数据融合等处理后，输出汽车自身的速度、位置和姿态等信息；
- 数据预处理可以考虑为传感器初始化及校准，传感器初始化相对于系统坐标系独立地校准每一个传感器；一旦完成传感器初始化，就可以利用各传感器对共同目标采集得到的数据进行数据配准；
- 数据配准：把来自一个或多个传感器的观测或点迹数据与已知或已经确认的事件归并到一起，保证每个事件集合所包含的观测与点迹数据来自同一个实体的概率较大；
- 传感器的配准主要包括：时间配准和空间配准；

#### 2.8.1 时间配准

- 时间配准：将关于同一个目标的各传感器不同步的量测信息同步到同一时刻；
- 时间配准的一般做法：将各传感器数据统一到扫描周期较长的一个传感器数据上；常用的方法：最小二乘法(Least Squares，LS)和内插外推法；

#### 2.8.2 空间配准

- 空间配准：借助于多传感器对空间共同目标的量测结果对传感器的偏差进行估计和补偿；
- 对于同一系统内采用不同坐标系的各传感器的量测值，定位时必须将它们转换成同一坐标系中的数据，对于多个不同子系统，各子系统采用的坐标系是不同的，所以在融合处理各子系统间信息前，需要将它们转换到同一量测坐标系中，处理后需将结果转换成各子系统坐标系的数据，再传送给各子系统；

![5](https://img-blog.csdnimg.cn/5a44be65fb8a47219725a4c45e85ff77.jpeg#pic_center)
![6](https://img-blog.csdnimg.cn/9b0235d8533a4b96a6e2f3b8f1ed20eb.jpeg#pic_center)

### 2.9 多传感器融合误差分析

**多传感器配准误差主要来源：**

- 传感器的误差，即传感器本身因制造误差带来的偏差；
- 各传感器参考坐标系中量测的方位角、高低角和斜距偏差；通常是因量测系统解算传感器数据时造成的误差；
- 相对于公共坐标系的传感器的位置误差和计时误差；位置误差通常由传感器导航系统偏差引起，计时误差通常由传感器时钟偏差所致；
- 各传感器采用的定位算法不同，从而引起单系统内局部定位误差；
- 各传感器本身的位置不确定，为融合处理而进行坐标转换时产生偏差；
- 坐标转换的精度不够，为了减少系统的计算负担而在投影变换时采用了一些近似方法所导致的误差；

### 2.10 多传感器融合算法

**各种融合算法比较：**

| 融合算法     | 运行环境 | 信息类型 | 信息表示   | 不确定性 | 融合技术     | 使用范围    |
| ------------ | -------- | -------- | ---------- | -------- | ------------ | ----------- |
| 综合平均法   | 动态     | 冗余     | 原始读数值 | —        | 加权平均     | 低层融合    |
| 贝叶斯估计法 | 静态     | 冗余     | 概率分布   | 高斯噪声 | 贝叶斯估计   | 高层融合    |
| D-S证据推理  | 静态     | 冗余互补 | 命题       | —        | 逻辑推理     | 高层融合    |
| 卡尔曼滤波   | 动态     | 冗余     | 概率分布   | 高斯噪声 | 系统模型滤波 | 低层融合    |
| 模糊逻辑法   | 静态     | 冗余互补 | 命题       | 隶属度   | 逻辑推理     | 高层融合    |
| 神经网络算法 | 动、静态 | 冗余互补 | 神经元输入 | 学习误差 | 神经元网络   | 低/高层融合 |
| 专家系统     | 静态     | 冗余互补 | 命题       | 置信因子 | 逻辑推理     | 高层融合    |

## 3 无线通信辅助汽车定位

- V2X：Vehicle-To-Everything；
- V2X车联网技术可以使车车和车路更好进行协同；
- 在卫星定位无法正常使用的特定区域，如地下停车场等，可采用Wi-Fi、RFID(射频识别)、超宽带、可见光等专用短程通信技术实现汽车室内定位；

## 4 车联网体系架构及信息共享

**车联网：指利用汽车上的车载单元(On-Board Unit，OBU)和道路附近的路侧单元(Roadside Unit，RSU)等数据传输设备，按照特定的通信协议和数据交换标准，进行V2X间的无线信息交互与共享，建立集交通实时动态管理、信息化服务及汽车控制于一体的网络；**

### 4.1 车联网体系架构

- 根据车联网的系统功能划分，车联网体系架构分为：感知与控制层、网络与传输层、综合应用层；
  - 感知与控制层：功能包括完成汽车自身与道路交通信息的全面感知，通过车与车、车与网络、车与基础设施、车与行人的通信，及车载传感器、汽车定位等信息感知技术，实时采集汽车状态、道路环境及汽车位置等信息，为车联网应用提供全面的信息感知服务；
  - 网络与传输层：通过设计异构网络协同通信所需要的专用网络架构和协议模型，对感知层的数据进行预处理；通过对云计算、大数据、虚拟化等技术的综合应用，充分利用专用短程通信和蜂窝移动通信等现有通信网络资源，为综合应用层提供透明的信息传输服务和应用支撑；
  - 综合应用层：各项服务在现有的网络体系和协议基础上，提供兼容未来可能的网络拓展功能，为车联网用户提供汽车信息收集、存储、处理、共享与发布等各类信息服务，具体应用包括但不限于车联网服务云平台、交通信息管理平台、自动驾驶服务云平台和地图云平台等；
- 最主要的车联网通信技术标准：专用短程通信技术(Dedicated Short Range Communication，DSRC)和基于蜂窝移动通信的车联网技术(Cellular-V2X，C-V2X)，两者均支持汽车连接到所有的事物，包括：基础设施、汽车、人等；
- C-V2X以LTE蜂窝网络作为基础，具有更广的通信距离，一个基站可支持上百辆车的通信需求，能够满足更大的系统容量；DSRC可以实现高速移动目标的双向通信、实时图像、语音和数据信息的传输；

### 4.2 车联网的信息交互与共享技术

![2](https://img-blog.csdnimg.cn/bff6f14dce794193b286e4e856e526cd.jpeg#pic_center)

- V2V(Vehicle-To-Vehicle，车与车)：采用专用短程通信技术和车载组网技术，实现车与车之间的信息交互，具体包括汽车姿态、速度及油门刹车状态等信息；
- V2I(Vehicle-To-Infrastructure，车与基础设施)：指汽车与途径的红绿灯、公交站、道路交通标志、电线杆、大楼、立交桥及隧道等一切基础设施的通信，用于获取必要的且有助于保障汽车安全和高效驾驶的关键信息；
- V2N(Vehicle-To-Network，车与网络)：能够让汽车与云端的服务器相连，实现汽车与车联网服务云平台、交通信息管理云平台、自动驾驶服务云平台、地图云平台等云端的互联互通；V2N可实现汽车获取车联网服务云平台提供的车载信息服务数据和汽车共享数据，交通信息管理云平台共享的汽车数据、运输出行数据和交通运行数据，自动驾驶服务云平台共享的人工智能路况数据等；
- V2P(Vehicle-To-Pedestrain，车与行人)：指汽车与行人随身携带的手机等便携设备进行信息交互；V2P主要用于保障行人的人身安全及非机动车的行驶安全，降低交通事故发生率；

## 5 基于专用短程通信的车联网技术

### 5.1 专用短程通信技术

**DSRC技术主要基于两套标准：一是IEEE 1609.x，即车载环境下的无线接入技术(Wireless Access in Vehicular Environments，WAVE)，其定义了基于DSRC的车联网的架构；二是SAE J2735和SAE J2945，其定义了消息包中携带的信息；**

- WAVE协议栈
  - IEEE 802.11p在IEEE 802.11a标准基础上对物理层和MAC层进行了修改以适应V2X通信环境，其网络接口的物理层与IEEE 802.11a采用相同的帧结构、调制方式和训练序列；
  - 在MAC实体层采用基于信道竞争访问的分布式协调功能(Distributed Coordination Function，DCF)，并加入了IEEE 802.11e中的增强型分布式协调功能(Enhanced Distributed Coordinator Function，EDCF)为不同业务提供相应的发送优先级服务；
- SAE J2735和SAE J2945
  - 该标准由美国汽车工程师协会(Society of Automative Engineers，SAE)发布的，主要是针对采用5.9GHz的DSRC应用，该标准规范了V2X的信息集，及信息集中的数据结构和内容，其中包括来自车上的传感器数据，如：位置、行进方向、速度、刹车信息；

### 5.2 基于专用短程通信的车联网

#### 5.2.1 IEEE 802.11p标准

1. DSRC的IEEE 802.11p频带资源分配
   - 除5MHz保护频段外，其余70MHz的频率资源共划分为7条互不重叠的10MHz信道；
   - 控制信道(Control Channel，CCH)178主要用于广播安全相关的消息或控制信令，传输WAVE服务通告(WAVE Service Announcement，WSA)或WAVE短消息协议(WAVE Short Message Protocol，WSMP)等优先级较高的内容，且严格限制其传输延迟；
   - 车车通信信道172和车路通信信道184专用于传输安全相关应用，信道172用于碰撞避免，信道184用于长距离、大功率的通信；
   - 剩余4条信道(174，176，180，182)均为业务信道(Service Channel，SCH)，可被合并为两条20MHz的信道，用于共享型安全相关应用，SCH既可传输CCH上的信息，也可传输非安全相关的应用层信息，包括基于UDP/IPv6的报文；
2. 汽车高移动性可能产生的负面影响：消息接收不成功或分组丢失、无效；
   - 消息接收不成功：在安全相关消息发送期间，部分接收节点可能已经移动到发送节点的通信范围外；
   - 分组丢失、无效：汽车高移动性引起正交频分复用技术(Orthogonal Frequency Division Multiplex，OFDM)系统中较差的多普勒频移扩展，进而导致较高的分组错误率和较差的信道质量；
3. 车载环境变化导致信号强度变化引起的路径损耗和多径效应引起的衰落等常规无线通信问题需要被最小化；
4. 相较于IEEE 802.11a，IEEE 802.11p减小带宽，增加了通信距离，但牺牲了物理层的数据传输速率；
5. DSRC物理层的调制方案采用OFDM进行信道复用，OFDM将无线信号分割成更小的子载波信号，即输入数据流分成了一组并行的比特流，每一路比特流映射到一组互相交叠的正交子载波以进行数据调制和解调，所有正交子载波将同时发送，而这些子载波在频率上互相交叠，但在设计上保证了彼此间不互相干扰；一方面，子载波彼此正交，另一方面，采用快速傅里叶变换(Fast Fourier Transform，FFT)算法进行信号分离；

#### 5.2.2 IEEE 1609.x标准

**IEEE 1609.x标准针对WAVE定义了适合车联网环境的通信系统架构和系列标准化服务接口，主要目的是规范OBU之间、OBU与RSU之间的无线通信协议，并提供汽车行驶环境下的汽车安全、交通管理、动态地图与导航定位等应用所要求的通信标准；**

- IEEE 1609.1：描述WAVE系统结构中的一些重要组成部分，定义了控制信息格式和数据存储格式，并规定远程应用和资源管理之间的控制流程，为应用的注册、管理及车载设备资源的存取提供标准接口，以便传送数据、命令和状态信息，为综合应用层服务；
- IEEE 1609.2：主要考虑WAVE中安全相关的业务和信息管理，规范签名、数字加密等工作过程，实现安全信息格式，节点认证和信息加密等功能；
- IEEE 1609.3：规范了网络传输层的服务标准，主要设计WAVE的连接设置和管理；设计了两条并列的网络传输通道：用户数据报协议(User Datagram Protocol，UDP)IPv6和WSMP；
- IEEE 1609.4：描述了多信道操作、CCH与SCH相关参数、信道优先接入参数、信道的路由与切换及WAVE模式等；通过信道管理对不同发送优先级的MAC服务数据单元(MAC Service Data Unit，MSDU)进行分类，并进行信道的路由和切换，达到合理利用信道资源的目的；为支持安全和非安全类应用，将消息分为不同的优先级：非安全类消息、高安全类消息；SCH用于传输非安全类应用消息；
- IEEE 1609.0：用于描述IEEE 802.11p/1609标准体系的整体架构和WAVE终端多信道通信服务；

#### 5.2.3 DSRC的应用和发展

![2](https://img-blog.csdnimg.cn/cebdcfe043e74082bab634a8e2540ab6.jpeg#pic_center)

## 6 基于蜂窝移动通信的车联网技术

### 6.1 蜂窝移动通信技术

![1](https://img-blog.csdnimg.cn/70b7923c7b114baf9da7f5f770d08ff2.jpeg#pic_center)

#### 6.1.1 2G/3G

- 2G主要采用TDMA和CDMA数字蜂窝技术；
- 2G从1G模拟调制跨入数字调制，2G具有高度的保密性，且增加了系统容量，2G具有通话功能，还具有短信服务(Short Messaging Service，SMS)功能，手机、笔记本电脑等便携式移动终端也可以连接到互联网；
- 2G的语音通信品质良好，比1G多了数据传输服务，速率达到9.6～14.4kb/s；
- 3G主要采用CDMA技术，传输速率至少为100kb/s，可同时传输语音和数据信息，及包括处理图像、音乐、视频等多种媒体形式，提供网页浏览、电话/视频会议、电子商务等多种交互式信息服务，同时兼容2G系统；
- 早期车联网通过基于GPS、GPRS、GIS三层应用的车载终端与蜂窝基站通信，将汽车行驶状态信息实时上传至服务器端，用户可实时查看汽车状态信息，并对历史数据进行统计与分析；

#### 6.1.2 4G

- 4G是对3G的长期演进技术(Long Term Evolution，LTE)，改进并增强3G空中接入技术，采用OFDM、多入多出(Multiple-Input Multiple-Output，MIMO)、载波聚合(Carrier Aggregation)、多点协作传输(Coordinated Multiple Points Transmission/Reception，CoMP)、中继(Relay)、异构网干扰协调增强(Enhanced Inter-cell Interference Coordination for Heterogeneous Network)等一些新手段和关键技术，以提高无线通信的网络效率和功能，下行峰值信息速率可达100Mb/s；
- LTE标准由第三代合作伙伴(3rd Generation Partnership Project，3GPP)组织全球各大企业及运营商共同制定，主要包括FDD-LTE和TDD-LTE两种制式；
- TDD-LTE亦称TD-LTE，是中国主导的4G标准，中国移动采用的是TD-LTE，TD-LTE是TDD版本的LTE的技术；
- TDD是时分双工(Time Division Duplexing)技术，是蜂窝移动通信使用的双工技术之一；TD-SCDMA采用CDMA技术，TD-LTE使用OFDM技术，两者帧格式、编解码、信令、空口及网络架构都不一样；
- FDD-LTE是FDD版本的LTE技术，FDD是频分双工(Frequency Division Duplex)技术，特点是在分离的两个对称信道上进行消息的传送和接收，以保证信道频段的独立性；
- 4G在提高网络峰值速率、频谱利用效率和小区边界用户性能的同时，整个网络的组网效率得到提升，具有高速率、大容量、低时延、连接稳定等特点；
- 4G可提供车载在线、高带宽和对QoS敏感的车联网信息服务，如车载娱乐信息和基于云平台的行车记录与控制等业务；

#### 6.1.3 5G

- 5G是多种新型无线接入技术和现有蜂窝移动通信技术集成后的解决方案的总称，包括：无线接入网、核心网及相关支撑系统的完整技术体系，具体通过集成多种新型无线接入技术、提供极限速率体验来满足不同应用领域用户的特殊需求；
- 5G将为用户提供超高的网络接入速率、"零时延"的传输体验、千亿设备的海量连接能力、超高流量密度、超高连接数密度和超高移动性等多场景的一致服务；
- 5G无线空口关键技术包括：全频谱接入、先进的调制编码、新型多载波、灵活双工和频谱共享、新型多址、大规模天线、终端直通等关键技术；5G对关键技术提出要求，如：超密集异构网络、自组织网络、信息中心网络、信息中心网络、内容分发网络、移动云计算、情景感知技术、软件定义网络(Software Defined Network，SDN)及网络功能虚拟化(Network Function Virtualization，NFV)等技术；
- 5G关键性能指标包括：数据传输速率、设备连接数密度、端到端时延、数据流量密度、终端的移动性和用户峰值速率等；
- 5G的典型应用场景中，增强现实、虚拟现实、云存储、超高清视频、车联网、远程驾驶、智能家居等业务，结合各场景未来可能的用户分布、业务占比及对数据传输速率、时延等要求，可以获得各种应用场景下的5G性能指标，如用户体验速率(0.1～1Gb/s)、终端连接数密度(百万连接/平方千米)、端到端时延(毫秒级)、流量密度(每平方千米不少于10Tb/s)、移动性(500km/s)、峰值速率(不少于10Gb/s)；

### 6.2 基于蜂窝移动通信的车联网

- C-V2X车联网是基于LTE及5G V2X的车联网技术，即LTE-V2X和5G-V2X，是DSRC技术的有力补充和潜在竞争者；
- 针对车联网应用，LTE-V2X定义了集中式(LTE-V-Cell)和分布式(LTE-V-Direct)两种通信方式；
- 集中式C-V2X需要蜂窝基站作为中心控制节点，其定义汽车与路侧单元及基站设备的通信方式；
- 分布式C-V2X亦称直通式C-V2X，无须基站参与V2X通信，主要定义了汽车之间的通信方式；

#### 6.2.1 C-V2X系统

![1](https://img-blog.csdnimg.cn/da48f85d68324914b0d619aeca1ef155.jpeg#pic_center)

- 当前，C-V2X主要借助LTE网络设施实现V2V、V2N及V2I的信息交互，用于满足超低时延、超高可靠性和高带宽的复杂应用场景；
- LTE-V2X系统针对集中式和分布式的通信方式，分别设计了不同类型的空中接口；一类是Uu接口，是集中式LTE-V2X的空中接口技术，车与车、车与基础设施之间都需要将数据通过基站进行转发实现V2X通信；LTE-V2X的Uu接口是在LTE的Uu接口基础上进行针对性的强化；另一类是PC5接口，用于实现车与车间数据的直接传输，即无须经过基站转发；LTE-V2X的PC5接口是在R12 LTE-D2D基础上进行多项增强设计，用于支持车与车之间动态信息的快速交换，实现汽车与周边节点低时延、高可靠的直接通信；
- 对物理层结构进行多项优化，以便支持终端移动速度高达500km/h的特殊应用场合，且在有蜂窝网络覆盖的场景下，数据传输可以在Uu接口和PC5接口之间进行无缝切换；

#### 6.2.2 C-V2X标准

![2](https://img-blog.csdnimg.cn/fa0895fa2c934cc58a85dd68118d401f.jpeg#pic_center)
**研究的时间节点：**
![3](https://img-blog.csdnimg.cn/f6c79571d75a49c0a7ce1caeb0971a9e.jpeg#pic_center)

#### 6.2.3 C-V2X通信应用与发展

![5](https://img-blog.csdnimg.cn/3c4ada8e3d6a4bd58fe4dbf417b3e157.jpeg#pic_center)

## 7 车联网辅助定位技术

### 7.1 车联网辅助地图数据的采集与发布

![1](https://img-blog.csdnimg.cn/f1824582c5654befbf4afa29f458960a.jpeg#pic_center)

- 高精度地图的数据主要包括：反映道路基础设施的静态数据，反映交通运行情况(交通标志、交通控制、交通状况、道路性能、道路气象等)的准动态数据和反映道路目标物(道路拥堵情况、施工情况、是否有交通事故、交通管制情况、天气情况等动态交通信息等)的高度动态数据；
- 准动态交通运行数据和高度动态的道路目标物数据是实现自动驾驶高精度定位、辅助环境感知、规划与决策等功能的必要条件，且均可通过车辆网进行动态数据的采集、发布与共享；

#### 7.1.1 车联网辅助动态地图数据的采集与发布

- 准动态地图数据主要包括：道路性能、道路气象、临时性交通标志及交通控制等交通相关数据，其更新频次是秒或分钟级；
- 准动态地图数据的采集与发布主体有交通信息管理云平台和地图云平台等；
- 交通信息管理平台采集的数据包括：路侧单元采集的交通状况、道路性能和道路气象等交通运行数据，及临时性交通标志和交通控制等交通管理数据；
- 地图云平台采集的数据包括：通过车载单元采集识别的交通状况、道路性能和道路气象等交通运行数据；
- 准动态地图数据的发布主要通过基于蜂窝移动通信的车联网技术实现，为汽车提供更精准的准动态地图数据支撑，用以更新车载高精度地图动态数据，进一步辅助自动驾驶定位；

#### 7.1.2 车联网辅助高度动态数据的采集与发布

- 高度动态数据主要是实时道路目标物数据，包括：汽车位置、汽车行驶状态及行人等信息，存储在车载单元创建的实时汽车环境感知地图中；
- 高度动态数据可由车载传感器采集道路目标物获得，也可通过V2X采集实时交通动态环境数据；
- 每辆车均可通过V2X将汽车自身位置、状态、操作数据及途径行人位置以广播方式通知周围汽车，车载单元的动态地图不断更新周边汽车的位置和行人位置等信息，并通过与SLAM进行融合，即可创建一张实时更新的汽车环境感知地图，辅助自动驾驶汽车定位；

### 7.2 室内定位技术

**室内定位技术结合GNSS等室外定位技术可为自动驾驶汽车提供从道路到室内行驶场地的全程导航服务，解决大型复杂室内场地的汽车定位难题；**

#### 7.2.1 室内定位技术原理

**室内定位技术：指在GNSS信号受遮挡的室内环境中实现汽车位置定位，包括：采用无线通信、基站定位和惯性定位等多种技术集成，设计一套室内汽车定位体系架构，从而实现汽车等各类待定位目标或流动站在室内空间中的位置感知；常用的室内定位方法：参考标签法、指纹定位法、距离交会定位法、航迹推算等；**

1. 参考标签法

   参考标签法：在指定场景中按照一定方式布置用于定位的参考标签，提前记录标签的位置和标签到阅读器的接收信号强度指示(Received Signal Strength Indication，RSSI)值；

   当阅读器读取到目标标签时，获取其RSSI值并与参考标签的RSSI值进行对比，选取与目标标签RSSI值最接近的若干个参考标签，从而估计出目标标签的位置，实现室内目标的定位；

2. 指纹定位法

   指纹定位法：指通过接收到的待定位目标信息值与已建立的信息库进行匹配，以确定待定位目标的位置；

   该定位方法通常包括：离线采集和定位两个阶段；首先，离线采集阶段是通过实际采集或计算分析建立指纹地图或指纹数据库；然后，定位阶段通过将实时接收到的数据特征与指纹信息库中的特征参数进行对比，进而找到最好的匹配参数，使待定位目标对应的位置坐标即被认为是待定位目标点的位置；

3. 距离交会定位法

距离交互定位法：通过测量流动站到至少三个已知参考点的距离，进而确定流动站的位置；

![image-20220722104236097](https://img-blog.csdnimg.cn/img_convert/9c78c27c56741eb8c9c4904e1fad75af.png)

距离交会定位方法基于不同的测距方式分为：基于RSSI、基于信号到达时间(Time Of Arrival，TOA)、基于信号到达时间差(Time Difference Of Arrival，TDOA)、基于信号到达角度(Angle Of Arrival，AOA)；

- RSSI测量

  RSSI测量是通过推算信号在自由空间的传播损耗，可使用理论或经验模型将传播损耗转化为测量距离；

在自由空间中，距离发射机d dd处的天线接收到的信号强度表示为：

![image-20220722104313792](https://img-blog.csdnimg.cn/img_convert/2e30ba5a0f243ba40ddb7296ff03faf4.png)

- TOA测量

  TOA测量是测量信号在流动站和基站之间的单程传播时延或往返时间；

TOA测量属于多边定位方法，假设电磁波从流动站到基站的传播时延为t，传播速度为c，则该流动站位于以该基站为圆心、半径为ct的圆上；以此类推，流动站也在第二个、第三个基站的圆上，故流动站的位置坐标为三个圆的交点；

![2](https://img-blog.csdnimg.cn/377a6d658543429da37ebb394e0e5040.jpeg#pic_center)

其中：A 、 B 、 C 是三个已知位置信息的基站，P为流动站，R1 、 R2 、 R3分别为流动站到基站A 、 B 、 C 的距离；

- TDOA测量

  TDOA测量是测量信号到达时间，但TDOA使用到达时间差进行定位计算，利用双曲线交点确定流动站位置，不需要基站和流动站的精确同步；通过TDOA测量，可以得到流动站和两个基站的距离之差，即流动站位于以两个基站为焦点的双曲线的交点，再引入第三个基站，可得到两个以上双曲线方程，则双曲线的交点即为流动站的位置；

  ![3](https://img-blog.csdnimg.cn/a6addc952bb34e8b9ff0ef99e2c93756.jpeg#pic_center)

其中：A 、 B 、 C为三个已知位置的基站，P为流动站，R1 、 R2 、 R3分别是流动站到基站A 、 B 、 C 的距离，其中R2 − R1 、 R3 − R1为定值；

- AOA测量

  AOA测量是通过流动站的接收机的天线阵列测出被接收的电磁波的入射角度，具体包括：测量基站信号到流动站的角度或流动站到达基站的角度；

![4](https://img-blog.csdnimg.cn/db055ee7f3644e8e83f75d92f07db6ce.jpeg#pic_center)

两个基站A 、 B，可以得到两条方向线，其交点即为流动站位置；

其中：θ1为流动站P PP的信号到达基站A的角度；θ2为流动站P的信号到达基站B的角度；

#### 4.2.2 室内定位关键技术

1. Wi-Fi定位
   - 基于Wi-Fi室内定位系统主要利用RSSI的指纹数据库定位及通过RSSI距离交会方法进行定位；
2. RFID定位
   - RFID是一种利用电感和电磁耦合的传输特性，实现对目标物体的自动检测与识别；
   - RFID定位系统通常由电子标签、射频阅读器及后台计算机数据库组成，常用的定位方法是邻近检测法，即利用RSSI实现多边定位算法可在一定程度上实现范围估计，进而实现物体定位；
   - 根据电子标签是否有源分为：无源RFID系统和有源RFID系统；无源RFID系统利用电感耦合实现对被识别物体的检测，相比有源RFID，体积更小，耐用性更高，成本更低，多使用邻近检测实现定位；有源RFID系统的电子标签含电池，因此电子标签的射频信号传输范围相比无源RFID更大，达到30m以上，可用于实现基于RSSI测量的指纹定位；
3. 超宽带定位
   - 超宽带(Ultra Wide Band，UWB)定位系统通常包括UWB接收器、参考标签及其他标签；
   - UWB技术通过发送纳秒级超窄脉冲来传输数据，可获得吉赫兹级的带宽，发射功率低且无载波；
   - 在室内定位应用场景下，UWB信号在传播中容易受到多径和非视距的影响，导致定位精度受到很大的影响；
4. 可见光定位
   - 可见光定位：将LED光源安装在室内的天花板或室内其他顶部位置，通过将编码调制信号加载到光电模块上，LED光源就可以向外发送明暗闪烁的光信号；在流动站配备光检测器，用于接收光信号，通过对光信号进行光电转换、信号调理等方式，提取出光信号中包含的数据信息，并在现有数据信息的基础上，采用相应的定位算法推算出流动站的坐标信息；
5. 地磁地位
   - 地磁匹配导航：将预先选定区域的地磁异常值制成参考地磁图并存储在流动站中；
   - 当载体通过预先选定区域时，地磁传感器实时测量地磁场强度，进而转化成地磁异常值，并构成实时地磁图；
   - 在惯性导航系统标注位置的基础上把实时地磁图与预存的参考地磁图进行匹配，确定实时地磁图在参考地磁图中的最佳相关点，从而确定出载体的精确位置；
   - 地磁定位技术是一种采用地磁地图进行定位的方案，且通常采用指纹定位的方法；