- [汽车以太网 – 引领汽车IVN向多速以太网过渡 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/173846046)

## **1、概述**

汽车行业已经成功地基于开放IEEE标准引入了用于车载网络（IVN）的以太网。 在OPEN联盟SIG和IEEE 802.3工作组的推动下，这些标准旨在开发一种更简单但功能更强大的汽车电气/电子架构。 通过支持从10Mbps到10Gbps的以太网速度等级，可以实现更加同质的基于以太网的车载网络（IVN）。

此外，对确定性和高性能带宽功能的需求正在加速基于以太网的车载网络。 用于IVN的以太网通过使用重量较轻的单对非屏蔽双绞线电缆提供了成本最低的布线解决方案。

## **2、适用于汽车应用的10G / 2.5G / 1G多速以太网控制器IP**

为了构建高度集成的基于以太网的片上系统（SoC），Cadence提供了用于汽车应用的10G / 2.5G / 1G多速以太网控制器，该控制器是高度可定制的软控制器IP，并且已通过ISO 26262 ASIL-B认证（ 如下图所示）

![img](https://pic3.zhimg.com/80/v2-c5aeefbe42755834109c0e9ac45a75fe_720w.jpg)

图1：带以太网控制器IP的SoC框图

**以太网的典型应用场景 – 自动驾驶**

1）传感器数据传输：推动自动驾驶需要实时传输和处理来自摄像头、毫米波雷达以及激光雷达等多种异构传感器的数据流。

2）关键任务控制系统：为了满足关键任务控制系统（如制动，转向等）的低延迟和安全性要求，需要时间敏感网络（TSN）。 TSN支持鲁棒性，低延迟和确定性的同步数据包传输，并且是音频视频桥接传输（AVB）协议标准的超集（父集）。

为了支持一系列以太网应用，控制器IP具有集成1000BASE-X和USXGMII PCS模块、具有高级AXI加载功能的高性能DMA、描述符缓存、QoS和IEEE 1588支持（图2）。IP支持时间同步，例如通过时间戳单元（TSU）的IEEE 1588/802.1AS精确时间协议（PTP）。

![img](https://pic1.zhimg.com/80/v2-50acea447420542ab116eba38fb15028_720w.jpg)

图2：控制器IP的IP级框图

IP的主要特点

— 10G / 2.5G / 1G多速以太网控制器

— 100M和10M速度等级

— TSN / AVB硬件支持，包括优先级排队，流量整形和时间感知调度

— 时间同步协议IEEE 1588 / 802.1AS

— 嵌入式实时时钟和时间戳单元

— 全双工流控制

— 缺陷加权循环（DWRR）和严格优先级

— 符合ISO 26262 ASIL-B

— 增强的主动功能安全功能

— TCP/IP卸载功能和IEEE 1588支持

— 与Arm®AMBA®3 AXI和AMBA 4 AXI和AHB互连的无缝DMA接口

— MII, RMII, GMII, RGMII, USXGMII, 和 SGMII 接口

— 集成 1000BASE-X PCS 和USXGMII PCS

— 与100Mbps，1Gbps和10Gbps以太网PHYs的无缝互操作性

— 符合IEEE 802.3并经过UNH测试

— 参考驱动程序，包括Linux支持

— 功能安全性，包括安全手册和ISO 26262 ASIL-B准备就绪证书

**功能安全特征和文件**

以太网MAC具有针对汽车应用的附加功能安全功能。这包括使用ECC的内存保护、数据路径和地址奇偶校验保护、致命故障检测、报告和恢复机制。交付物还包括安全手册和ISO 26262 ASIL-B准备就绪证书。

支持IEEE 802.1标准：

1）IEEE 802.1AS-Rev — 时间敏感应用的定时和同步

2）IEEE 802.1Qbu/IEEE 802.3br — 帧优先权

3）IEEE 802.1Qbv — 预定流量的增强

4）IEEE 802.1Qcc — 流预留协议增强（SRP）和性能提升

5）IEEE 802.1CB — 帧复制和消除以提高可靠性

6）IEEE 802.1Qav — 时间敏感流的转发和排队增强

7）IEEE 802.1Qci — 每流过滤和接收流量监管

8）IEEE 802.1Qaz — 增强传输选择（ETS）

## **3、以太网Verification IP （VIP），最高支持100G**

结合最新的协议更新，成熟和全面的Cadence Verification IP（VIP）为以太网提供了一个完整的总线功能模型（BFM），包括错误插入、集成的自动协议检查程序和覆盖模型。专为IP、SoC和系统级别的测试台轻松集成而设计，高达100G的以太网VIP可帮助您缩短测试时间，加快验证关闭，并确保最终产品质量。

最高可达100G的以太网VIP可在所有主要仿真器上运行，并支持SystemVerilog和e验证语言以及相关方法，包括通用验证方法（UVM）和开放验证方法（OVM）

高达100G的以太网VIP支持在独立、部分堆栈和全堆栈模式下验证以太网接口，速度从10Mbps到100Gbps：

1）XMII级别：介于MAC和PHY之间

2）PHY子层：PCS、FEC、PMA和PMD之间

3）链路伙伴：发送站和接收站之间

高达100G的以太网VIP符合IEEE 802.3以太网标准和规范草案。它支持其他广泛应用的以太网接口，这些接口是专有的且基于IEEE 802.3标准。因此，VIP支持不同的配置，如图3和图4所示:

![img](https://pic4.zhimg.com/80/v2-44f79bd5789b51f92103774a883b7333_720w.jpg)

图3.带有MAC + PHY DUT的以太网VIP使用情况

![img](https://pic1.zhimg.com/80/v2-0ac3e42f37391d4ff50fb4552390aa08_720w.jpg)

图4.带有MAC DUT和PHY DUT的以太网VIP使用情况

## **4、用于TSN以太网的VIP**

于时间敏感网络（TSN）的Cadence VIP为TSN协议栈提供了成熟的，功能强大的合规性验证解决方案，并结合了BFM，包括错误插入，集成的自动协议检查器和覆盖模型。

以太网TSN的VIP设计用于轻松集成到IP，SoC和系统级别的测试平台中，从而有助于减少测试时间，加快验证结束并确保最终产品质量。

以下一组协议是TSN以太网VIP的一部分：

— IEEE 802.1AS PTP

— IEEE 802.1Qbu

— IEEE 802.3br

— IEEE 802.1Qav

— IEEE 802.1Qbv

— IEEE 802.1Qat

— IEEE 802.1AE

— IEEE 1722

TSN协议通常设计为在以太网MAC层和PHY层的框架上工作，其工作速度为1Gbps或更低。

**5、符合标准接口的VIP**

汽车SoC中接口数量的增加和复杂性的增加使得难以彻底验证设计。 Cadence VIP通过提供VIP组件来提高质量，这些组件可以检查是否符合标准接口规范，例如CAN，LIN，以太网，DDR，Flash，USB等；

Benefits：

• 久经考验的VIP提供者，超过500个客户选择

• VIP可用于100多种接口和内存标准

• 符合关键任务设计的标准接口规范

## **6、Sigrity SystemSI汽车以太网通道仿真**

实施汽车以太网网络，并使用Cadence Sigrity™SystemSI™技术通过物理以太网通道分析ECU到ECU的通信性能，来自动进行芯片到芯片的信号完整性分析。

模拟完整的物理通道以确保以太网合规性：

\- 测试不同的PHY、连接器和电缆组合

\- 支持电缆分段（不同电缆长度）

\- 带或不带护套、屏蔽

\- 从ECU到ECU的基于仿真的电磁干扰验证和优化

\- 分析电缆老化效应

\- 在PCB上运行电源完整性分析

\- 支持100Base-T1和1000Base-T1 PHY的汽车以太网合规性检查

**7、100Base-T1 PHY和1000Base-T1 PHY的汽车以太网符合性测试**

• 适用于任何电缆拓扑的PHY的IBIS AMI模型

– TX和RX型号

• 采用Sigrity SystemSI技术模拟的物理信道

• 支持符合性测试：

– 发射器输出下降

– 发射器功率谱密度

– 发射器抖动（主/从）

– 发射器时钟频率（PAM3）

– 发射器失真

– 回波损耗测量

![img](https://pic4.zhimg.com/80/v2-6ee14eea0cd745f79a962d0a7305d48b_720w.jpg)

图5：100Base-T1发射器输出下降

**8、以太网快速协议**

对于基于FPGA的快速原型开发，Cadence开发了BroadR-Reach PHY接口卡，该接口卡可以插入基于Cadence Protium™ FPGA的原型开发平台中。 这样，外部硬件如以太网摄像机、影音娱乐主机单元以及其他设备可以通过非屏蔽双绞线直接与FPGA系统连接。

这样，最初作为FPGA原型实现的SoC也可以运行软件，以利用Protium解决方案对系统进行早期的硬件/软件验证。 此设置还有助于分析使用不同的电缆，连接器和其他硬件配置对整体系统性能的影响。

以太网快速原型的一个相关应用是使用停车辅助系统内的摄像机应用在顶视或后视配置中。 利用硬件/软件协同设计方法，工程师可以在硬件（包括SoC）可用之前就开发和测试驱动它们的汽车以太网应用程序（硬件/软件）。

Cadence BroadR-Reach接口卡可以通过Cadence汽车以太网MAC将任何外部以太网设备与ECU或其他控制单元连接。

![img](https://pic1.zhimg.com/80/v2-6e8c3cb3ba042271eb3a57163aedbefc_720w.jpg)

图6：物理以太网通道的关键组件



参考资料：

1. Automotive Ethernet - Leading the transition to multi-speed Ethernet in Automotive