- [C-V2x与5G的车路协同解决方案为汽车开启上帝视角 (qq.com)](https://mp.weixin.qq.com/s/888Y-gQ2rViYfUnW5xUvtA)

5G 有望为汽车行业带来新的创新和应用，但它并非指日可待，而汽车行业将出现连接性“创新鸿沟”，最好用 LTE-V 来填补——这是一种灵活且专用的未来车辆通信解决方案。

**在实践中，C-V2x性能最佳的解决方案可能是结合传感器和摄像头的通信系统，辅以高清地图系统，该系统反过来通过蜂窝网络接收实时更新，以及直接的车对车与自组织网络功能的通信。**（由于与移动性相关的因素，例如行驶速度和信道特性，对直接车对车通信的要求因设备而异。如果由于协议的原因，跳数变得很大，Ad hoc 网络将变得非常低效。一个实际的限制是五跳。如果在汽车的前后都有一个有源天线系统，跳数可以增加一倍。）

![图片](https://mmbiz.qpic.cn/mmbiz_png/dgmES0HFW0uKmKQ4wBHic0a0MP31ZZxicU65ib5f1x2Y3ZcP2W3qupVApS4qMGAmjY9NsYZsoulSNkiaico8eNeN13g/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

V2X 技术提供的信息对于让未来的联网和自动驾驶汽车高效、安全地导航到预定目的地至关重要。了解联网汽车将传输和接收的大量数据非常重要，因为这对网络容量提出了非常高的要求。一些估计表明，到 2020 年，每辆联网汽车每天将产生超过 4,000GB 的数据。尽管联网汽车正迅速成为主流，但仍然存在一些问题比如关于在哪里、做什么和需要什么连接的问题。

## **车路协同的自动驾驶场景应用提升**

### **1-基础场景自动驾驶能力提升**

基于C-V2x的车路协同策略对于整体自动驾驶功能提升项如下图所示：

| **序号** | **功能**           | **功能描述**                                                 | **自动驾驶级别**   |
| -------- | ------------------ | ------------------------------------------------------------ | ------------------ |
| 1        | 左转辅助           | 当驾驶员试图在未受保护的情况下左转穿越交通时，会向他们发出警报，以帮助他们避免在相反方向的交通中发生碰撞 | L4城市自动驾驶     |
| 2        | 十字路口移动辅助   | 当进入十字路口不安全时通知驾驶员，例如，当有东西挡住驾驶员对对面或交叉路口的视线时。 | L4城市自动驾驶     |
| 3        | 队列警告           | 旨在提前参与任何潜在的碰撞情况，向驾驶员提供消息和信息，以最大程度地减少他以后需要采取避免或缓解碰撞措施的可能性。 该基础设施将向车辆广播排队警告，以尽量减少或防止追尾或其他二次碰撞。 | L4高速市自动驾驶   |
| 4        | 速度协调           | 根据交通状况和天气信息确定速度建议。它检测可能需要对上游交通进行速度调整的正在发展的道路或拥堵状况，并在车辆到达受影响区域之前很久就将此类建议广播给车辆。 | 自动驾驶/辅助·驾驶 |
| 5        | 实时态势感知       | 为车辆提供机制，以接收有关城市/道路项目、车道关闭、交通和其他可能需要调整驾驶模式的条件的实时信息。 | 自动驾驶/辅助·驾驶 |
| 6        | 弱势道路使用者识别 | 能够识别由于行人或骑自行车者等易受伤害的道路使用者的存在而导致的潜在安全状况 | 自动驾驶/辅助·驾驶 |
| 7        | 软件更新           | 为车辆提供机制以接收确保其安全运行所需的最新软件更新和安全凭证 | 自动驾驶/辅助·驾驶 |
| 8        | 远程车辆健康诊断   | 提供远程诊断车辆问题的机制。 随着驾驶变得更加自主，这成为远程监控车辆功能及其健康状况的关键机制。 | 自动驾驶/辅助·驾驶 |
| 9        | 实时高精地图识别   | 在路况变化的情况下为关键路段的自动驾驶汽车提供态势感知（例如，前一段时间另一辆车检测到新的交通锥） | L3以上自动驾驶     |
| 10       | 共享高清传感器     | 为车辆提供共享高清传感器数据（激光雷达、摄像头等）的机制，以实现更好的驾驶协调，以实现队列和交叉路口管理 | L3以上自动驾驶     |
| 11       | 透视               | 使卡车、小型货车、排中的汽车等车辆能够将前方路况的摄像头图像分享给后方车辆 | L4园区自动驾驶     |
| 12       | 发现弱势道路使用者 | 能够识别由于行人或骑自行车者等易受伤害的道路使用者的存在而导致的潜在安全状况 | 自动驾驶/辅助·驾驶 |

 自动驾驶开发方面可以通过多种方式进行合作。一个典型的测试案例是自动车道合并以最大化道路容量。为了让超车车辆在交通拥挤时最有效地重新进入较慢的车道，最理想的做法是让前方的任何车辆稍微加速，并让后面的车辆减速，以便为合并的车辆腾出足够的空间。当车辆进入密集的高速公路时，同样的过程也是可取的。对于紧急轨迹规划，每辆车都会广播其身份、位置、速度和方向，并使用这些数据来构建自己的地图并确定是否有其他车辆处于潜在的碰撞轨迹上。

![图片](https://mmbiz.qpic.cn/mmbiz_png/dgmES0HFW0uKmKQ4wBHic0a0MP31ZZxicU5ZcxRXlcT43TwInaDO7K9eyeofXu2ibh3XKTS0d1NFUGJjMYtROb69Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)



### **2-基于5G的编队行驶**

将卡车、货车或汽车自动连接到比人类驾驶员更安全的车队中，以节省燃料并提高货物运输效率。其在高速公路上建立灵活的编排，然后在车辆离开高速公路时分解。可以使用传感器和直接邻居之间的直接通信建立 2 或 3 辆车的车队。对于更长的横排队伍，消息的传播需要很长时间。制动必须是同步的，需要低延迟的网络通信。对于超过 3 辆汽车的编排，将会对5G有更高的要求。相关联的汽车需要以非常低的延迟进行通信，并确认收到任何消息。

**远程驾驶中，主要是远程状态下超控汽车如何避障。**障碍物包括由于近期事故而被阻塞的车道、双车停放的汽车在不越过入口/出口黄线的情况下不允许车辆通行，确保未经历的车辆在无法确定安全行动或不知道前方情况如何时盲目前进的情况。当车辆遇到这种情况时，它会停下来或找到一个最小的风险位置，然后请求遥控操作员的协助来控制并绕过障碍物。为了让遥控器了解障碍物并确定车辆必须走的路径，控制器将利用暂时提供给他或她的流式传感器信息（例如，视频、激光雷达、雷达）。一旦清除障碍物，流向控制器的流将停止，性能要求：

车辆将完全控制向其目的地。该解决方案将需要精确度，并且需要进行限制以确保高客户满意度，并限制停止自动驾驶将导致的交通障碍。

以下是支持队列的一些关键 V2V 通信要求：

• 25 ms 的一组车辆之间的端到端通信延迟（最高为 10 ms自动化）

•  90% 的消息可靠性和 99.99% 的最高自动化程度

•  相对纵向位置精度小于0.5 m

•  每秒 10 到 30 条消息的广播速率

•  动态通信范围控制，以在不同排规模的情况下提高资源效率，并出于隐私原因限制消息分发

编队的几个方面必须通过可靠的 V2V 通信来支持：

• 加入和离开车队：允许车辆在排活动时随时发出加入或离开排的信号，并支持附加信号以完成加入/离开操作

• 公告和警告：指示排的形成和存在，以便附近的车辆可以选择加入排或避免对排的干扰

• 稳态车队群通讯：支持排管信息的交换，也可以指示刹车、加速、走哪条路、换排长等。

鉴于车辆在相对高速行驶时目标车距较小，V2V 通信必须能够支持可靠、高占空比和安全的消息交换，以确保有效和安全的队列运行。

### **3-基于5G的远程驾驶**

车辆由位于偏远地区的行驶，车辆仍然由人驾驶——车内不存在实际驾驶员。这可能被用于提供高级礼宾服务，使某人能够参加会议或在旅途中工作，或支持出租车服务，或帮助没有驾驶执照的人，或在他们生病时， 醉酒，或以其他方式不适合驾驶。此过程总体需要具有足够快的低于 10 ms 的完整往返延迟的高可靠性无线电链路。以至于系统可以像人眼感知变化一样快地接收和执行指令。

**性能要求：**

允许人类操作员或基于云的应用程序通过 V2N 通信对车辆进行远程控制。有多种场景可以利用远程驾驶，包括：

• 为自动驾驶汽车提供备份解决方案。例如，在最初的自动驾驶车辆部署期间，当车辆处于不熟悉的环境并且难以导航时，远程操作员可以进行控制。

• 为没有驾照或无法驾驶的青少年、老年人和其他人提供远程驾驶服务。

• 使车队所有者能够远程控制他们的车辆。示例包括将卡车从一个地点移动到另一个地点、向客户提供租车服务以及提供远程驾驶出租车服务。

• 启用云驱动的公共交通和私人班车，所有这些都特别适用于具有预定义站点和路线的服务。

由于较低的技术要求（例如，较少的车载传感器数量和复杂算法的计算要求较少），远程驾驶可用于降低某些用例的完全自动驾驶成本。以下是支持远程驾驶的一些潜在 V2X 要求：

• 下行链路的数据速率高达 1 Mbps，上行链路的数据速率高达 25 Mbps（假设两个 H.265/HEVC HD 流各高达 10 Mb/s）

• 99.999% 或更高的超高可靠性 (URLLC)

• V2X 应用服务器和车辆之间的端到端延迟为 5 毫秒

• 车速高达 250 公里/小时

当障碍物阻挡 4 级或 5 级自动驾驶汽车时，将需要远程控制/驾驶，使其无法决定安全导航的路径或方法。

### **4-基于5G的环境数据处理**

#### **a. 透视、传感器共享/相机共享**

在车辆之间共享传感器数据和摄像头图像，使汽车能够有效地“看穿”前方的其他车辆。驾驶员挡风玻璃上的平视显示器 (HUD) 或增强现实显示器将驾驶员可以看到的内容与前方车辆可以看到的内容结合起来。此过程要求高清视频流完美同步，且时间对齐至关重要，因此需要非常低延迟的网络。

![图片](https://mmbiz.qpic.cn/mmbiz_png/dgmES0HFW0uKmKQ4wBHic0a0MP31ZZxicU7ROIePWZrmuoF0EqjpYFrpdj2tx3WvMicuBpGKEHtibqQrI4GIlhoBPg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

支持扩展传感器的两个 V2X 节点之间的潜在通信要求包括：

•  高带宽，支持大量数据的突发传输

•  延迟小于 10 毫秒

•  95% 的高消息可靠性

•  高连接密度以支持拥堵区域（例如，每英里 15,000 辆汽车）

#### **b. 环境数据处理——增强现实映射**

相机信息将覆盖在现有的周围环境数字模型上来构建高清 3D 地图。来自多辆汽车的立体摄像头的将图像上传到云端，并以协同过采样的方式叠加多张图像，以创建非常清晰的 3D 风景图像。3D 图像还可以包括红外细节，这种增强现实映射方法有望产生比现有服务更好的地图，汽车可以将 3D 模型与现实进行比较，以识别存储模型和实时图像之间的差异（识别行人、动物、汽车、摩托车和像街道变化的表面这样的细节）。

此过程中，需要实时、不间断地从汽车传输视频，并在汽车上及时接收集中地图数据以进行比较。过程中，将需要高吞吐量网络，例如启用图像的时间同步时间尽量少。

自动驾驶汽车每天通过雷达、激光雷达和摄像头等各种传感器产生超过 4 TB34 的数据。这些数据集用于车辆系统开发和消费者的各个阶段算法。在开发/试验阶段，大部分传感器数据存储在车载存储中，并传输到数据中心平台以开发各种深度学习模型，然后部署在车辆中进行灵活的检测和分类。车辆售出后，这些模型会定期使用来自实时驾驶的新数据集进行调整。根据传感器数据、车辆诊断、定位数据和实时情况数据等特定数据模式，将需要各种无线数据上行链路方法。

#### **c. 基于云端运算的应用实例——远程信息处理、移动配置文件、保险和防盗**

有许多方法可以利用车辆移动性数据（即使是匿名形式）。例如，通过使用其设备报告的有关移动速度的数据来扩充其交通地图。通过分析速度明显低于当地限速的地方，它可以识别交通拥堵。保险公司还可以收集移动数据，并提供安装远程信息处理设备的选项，该设备可以报告驾驶方式、速度和位置。数据在云端收集和分析，用于确定为每位司机投保的风险以及个人的保险费。对于防盗，可以直接跟踪车辆的位置和驾驶人，并将这些信息传递到云端进行分析。在允许的情况下，这些应用程序只需一小步即可关联数据并确定人们在哪里工作、生活和购物，并使用该信息向他们出售适当的服务。

这些应用对网络的要求因特定应用而异，但在许多情况下，这些用例可以通过当今的蜂窝网络实现，因为没有非常苛刻的延迟或吞吐量要求。车辆与其他车辆、交通基础设施、基于云的和其他应用程序甚至行人或骑自行车的人之间需要不同类型的通信。

**性能要求：**

采用先进驾驶通信的两辆车之间的潜在通信要求是：

•  高带宽，支持大量数据的突发传输；

•  10 毫秒延迟，实现最高程度的自动化；

•  99.99% 的消息可靠性，实现最高程度的自动化；

#### **d. 实时高清制图**

尽管技术实施策略各不相同，但实时高清地图是自动驾驶的关键要素。在“地图灯”方法中，高清地图主要用于导航目的，并将与实时情况数据（例如，事故通知、道路建设）重叠。在“重地图”方法中，高清地图在路径规划中发挥着更为关键的作用——甚至达到厘米级的细节。此类场景将需要单个城市/社区的最大 1 TB 大小的地图。这些地图不仅需要在没有直接用户交互的情况下定期更新，它们甚至可能需要随着车辆跨地域移动而按需更新。利用路边基础设施和边缘云解决方案提供这些地图更新的部署策略对于降低成本至关重要。

# **C-V2x的路侧通信原理**

本文需要重点讲一下另一个V2x中比较典型的通信原理和过程，并重点说明其如何应用于自动驾驶系统。其中包括典型的路端数据流移动原理。

在通信过程中，需要涉及多个典型的汽车终端和路测终端。其中包括车载单元OBU（ On Board Unit ）、路侧单元RSU（Road Side Unit） 、车与车通信V2V（Vehicle to Vehicle） 、车连万物V2X（Vehicle to Everything）。

如上各硬件设备的传输数据类型如下：

| **节点设备** | **输入**                                                     | **输出**                                                     |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| OBU          | 路侧单元RSU数据（交通灯、交通标志、障碍物等）                | 整合RSU数据输入及其他车obu发来的车辆数据，通过udp发送给本车HPC的v2x节点 |
|              | 其他车obu发来的其他车数据（驾驶状态、底盘、车身、定位信息等） | 本车HPC的v2x发来的本车数据，通过本车和其他车的obu之间的通信，发给其他车obu |
|              | 本车域控的v2x节点发来的本车数据（驾驶状态、底盘、车身、定位信息等） |                                                              |

为了理清V2X、OBU、RSU、V2V之间的协作关系，我们以车车之间的通信为例说明整体工作关系及数据流传输走向。

![图片](https://mmbiz.qpic.cn/mmbiz_png/dgmES0HFW0uKmKQ4wBHic0a0MP31ZZxicU0H8gicdGgmwDg49OgdVRIoZxJHLTiavJe0q2SlpibJ5AvFgyl9xiagLaibA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)



假设有两辆智能驾驶汽车A和B，两车分别具备自动驾驶高性能计算平台HPC。该平台连接自动驾驶的各个节点，包括转发OBU设备发来的数据的V2X节点。

V2X设备OBU。智能驾驶道路路侧安装有: 路测单元RS（主要用来发送交通灯、交通标志和道路上障碍物的数据给车身上的OBU）。其中，路测单元RSU 和 V2X设备OBU也是通过无线电波进行通信。那么着多辆主要是通过何种方式进行车车通信和车路通信呢？

假设以A车为主视角，分别看待其与B、C两车的数据交互。那么整个过程如下：

### **1）A车各ECU单元订阅B、C车及路侧端数据**

首先，假设有辆A车HPC上的v2x节点收到B、C两车OBU通过UDP协议发来的Message，该Message主要包括路端RSU数据（主要指路端环境数据）及车端B、C两车辆信息（包括车身、底盘及定位信息等）。然后A车HPC上的v2x节点将OBU消息解析后打包成Autosar的AP消息发送出去供A车HPC控制器所连接的所有其他节点，此过程中，可以通过部分广播及部分消息订阅方式供HPC相关联的所有节点做消息订阅。车内节点之间的消息传输采用之前提到的SomeIP协议格式进行，当然期间存在封装UDP协议的过程（该过程主要需要SomeIP以自身的协议标准加入包头Header，通过包头类似 0x88,0x89标识来确认是否是开发中想要的数据）。

### **2）A车整合自车数据包**

其次，A车HPC相关联的ECU如果需要传输自车的底盘、车身或定位信息，则可以直接把这些AP消息打包成proto格式，然后将SomeIP协议格式以UDP协议形式进行数据包封装，然后通过v2x节点将打包好的UDP协议包发送给A车OBU（通过包头类似 "obuxxx"等做标识来确认是否是想要的数据）。

### **3）A车发出自车数据给B、C车**

A车OBU 将A车自身信息（车身、底盘、定位信息等）通过无线电波发送给B、C两车OBU，实现A车B车车辆信息共享。该过程的数据流向是双向OBU发送的，并且本车obu接收到其他车的obu数据后，直接和RSU过来的数据一起打包后透传给HPC的v2x节点。