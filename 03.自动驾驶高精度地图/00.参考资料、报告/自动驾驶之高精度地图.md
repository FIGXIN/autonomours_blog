- [自动驾驶之高精度地图_冷暖从容的博客-CSDN博客_自动驾驶 高精度地图](https://blog.csdn.net/qq_40664711/article/details/122770696)

# 前言

  高精度地图被认为是未来自动驾驶、无人驾驶出行的关键一环，是交通资源全时空实时感知的载体和交通工具全过程运行管控的依据。
  本文是笔者在进入自动驾驶行业后，对于高精度地图认知上的笔记，供诸位参考。

# 高[精度](https://so.csdn.net/so/search?q=精度&spm=1001.2101.3001.7020)地图概括

## 定义

  高精度地图也称为高分辨率地图（High Definition Map，HD Map）或高度自动驾驶地图（Highly Automated Driving Map，HAD Map）。高精度地图与普通导航地图不同，主要面向自动驾驶车辆，它以精细化描述道路及其车道线、路沿护栏、交通标志牌、动态信息为主要内容，通过一套特有的定位导航体系，为自动驾驶车辆的定位、规划、决策、控制等应用提供安全保障，是自动驾驶解决方案的核心和基础。

## 特点

  高精度地图作为普通导航地图的延伸，在精度、数据维度、时效性以及使用对象等方面与普通导航地图有着很大不同。
  在精度方面，普通导航地图一般为米级，高精度地图可达到厘米级。
  在使用对象方面，普通导航地图面向的是人类驾驶员，高精度地图面向的是机器。
  在时效性方面，普通导航地图要求静态数据的更新为月度或季度级别，动态数据不做要求；高精度地图要求静态数据为周级或天级更新，动态数据则要求实时更新。
  在数据维度方面，普通导航记录道路级别数据，高精度地图则更为详细，需要达到车道级别，比如记录车道、车道线类型、宽度等。

## 作用

### 需求

![在这里插入图片描述](https://img-blog.csdnimg.cn/3dab8cdec4434881902508553bacd1b5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5Ya35pqW5LuO5a65,size_20,color_FFFFFF,t_70,g_se,x_16)

  对于自动驾驶分级的详细介绍，可以查看我写的

[自动驾驶初识—自动驾驶分级](https://blog.csdn.net/qq_40664711/article/details/122745273)
  系统作用域指的是高精度地图使用时对环境是否有要求限制；例如：L3级系统作用域为场景相对简单的限定环境（如高速公路、封闭园区等）。

### 作用价值

  高精度地图作为自动驾驶的稀缺资源和必备构件，能够满足自动驾驶汽车在行驶过程中地图精度计算匹配、实时路径规划导航、辅助环境感知、驾驶决策辅助和智能汽车控制的需求，并在每个环节都发挥着至关重要的作用。
  辅助环境感知方面。传感器作为自动驾驶的“眼睛”，有其局限性，如易受恶劣天气的影像等。高精度地图可以对传感器无法探测或探测精度不够的部分进行补充，实现实时状况的检测及外部信息的反馈，进而获取当前位置精准的交通状况。
  辅助定位方面。由于存在各种定位误差，地图上的移动汽车并不能与周围环境始终保持正确的位置关系，在汽车行驶过程中，利用地图匹配可精确定位汽车在车道上的具体位置，从而提高汽车定位的精度。相较于更多地依赖于GNSS提供定位信息的普通导航地图，高精度地图更多地依靠其准确且丰富的地图要素（如车道形状、曲率和标志牌等），通过结合高维度的数据与高效率的匹配算法，能够实现更高精度的匹配与定位。
  辅助路径规划方面。普通导航地图仅能够给出道路级的路径规划，而高精度地图的路径规划导航能力则提高到了车道级，例如高精度地图可以确定车道的中心线，可以保证汽车尽可能地靠近车道中心行驶。在人行横道、低速限制或减速带等区域，高精度地图可使汽车能够提前查看并预先减速。对于汽车行驶附近的障碍物，高精度地图可帮助自动驾驶车辆缩小路径选择范围，以便选择最佳避障方案。
  辅助控制方面。高精度地图是对物理环境道路信息的精准还原，可为汽车加减速、并道和转弯等驾驶决策提供关键道路信息。而且，高精度地图能给汽车提供超视距的信息，并与其他传感器形成互补，辅助系统对车辆进行控制。

## 前景

  根据《智能网联汽车技术路线图2.0》规划，2025年L2/L3级自动驾驶新车渗透率将达到50%。2021年，L3级自动驾驶汽车进入量产元年，高精度地图作为L3及以上自动驾驶感知层核心技术之一，因此，随着L3级别自动驾驶的量产落地，其市场规模不断扩大，预计2025年高精度地图市场规模将达到89.6亿美元。
  国内高精度地图行业正在稳步向前发展，但是高精度地图的商业模式仍未完全成型，按照3亿辆汽车保有量计算，保守预估中国高精地图市场规模将由2021年的10.2亿美元增长至2025年的32亿美元。

# 高精度地图组成

  高精度地图由多层数据组合而成，其数据逻辑结构应能准确反映道路环境，实现地图数据的多尺度标定和高效存储，支持定位、路径规划、决策控制，并能满足导航中基于空间索引的需求。
  根据高精度地图数据逻辑结构的分层特点，将其划分为4层：静态地图层、实时数据层、动态数据层、用户模型层。其中，静态地图层用于精准刻画静态驾驶环境，提供丰富的道路语义信息约束与控制车辆行为，主要包含道路网、车道网、交通设施网与定位图层；实时图层用于动态路径规划和车辆控制，主要包含交通限制信息、交通流量信息、服务区信息等更新频率较高的实时路况信息；动态图层用于弥补在能见度低的交叉盲点上车载传感器的视野盲区，保证行驶安全，主要包含车辆、行人、交通信号灯等高度动态信息；用户模型层提供行车经验信息，用以辅助车辆实现特定约束条件下的最优行驶策略，主要包含驾驶记录数据集和驾驶经验数据集。

![在这里插入图片描述](https://img-blog.csdnimg.cn/711d09cfa754476cb002ac013a43c888.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5Ya35pqW5LuO5a65,size_20,color_FFFFFF,t_70,g_se,x_16)
上述图片信息来源于测绘学报第48卷第8期《智能高精地图数据逻辑结构与关键技术》。

# 高精度地图数据生产

## 生产制作流程

![高精度地图制作流程](https://img-blog.csdnimg.cn/b755699ffa704e9ea0458a89d089c96b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5Ya35pqW5LuO5a65,size_20,color_FFFFFF,t_70,g_se,x_16)

## 采集模式

  高精度地图为了保持周期性数据更新，需要大范围内足量且实时的有效道路数据作为支撑。高精度地图数据的海量性与数据精准性要求，仅依靠专业测绘难以实现对道路的全时空实时覆盖，所以针对传统专业测绘采集模式下的不足，衍生出专包采集和众包采集两种方式。下面就三种高精度地图采集模式进行详细介绍。
  专业测绘主要包含移动测绘车生产、无人机航测和大比例尺地形图测绘。其中，移动测绘车生产是最为常用的生产方式，需要搭载激光雷达、GNSS/IMU位姿传感器、全景相机、车轮测距器设备，移动测绘车以三维点云数据为主，主要解决点云地图构建和目标检测问题。它的优点是精度高、适应性强、技术成熟、道路信息采集全面，缺点是成本高（一台测绘车成本往往高达几十万甚至几百万）、数据量大、专业人员需求、鲜度维系不易。

![专业测绘车](https://img-blog.csdnimg.cn/539b5501d2544cd9abcb5b9e976c4a89.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5Ya35pqW5LuO5a65,size_20,color_FFFFFF,t_70,g_se,x_16)

  专包采集指的是图商通过与车辆运营商（例如出租车公司、客运公司或货运公司）合作，将测绘工具（激光雷达、全景相机等）搭载在车身上，进行道路数据测绘采集，定期进行测绘工具维护和测绘数据回收。它的优点是成本相对来说较少,缺点是精度不够、鲜度维护不易。
  众包采集指的是用户通过自动驾驶车辆自身的传感器（视觉和雷达等传感器），或其他低成本的传感器硬件，收集的道路数据传到云端进行数据融合，并通过数据聚合的方式提高数据精度，来完成高精地图的制作；它的优点是相对成本低、数据来源非常丰富、实时性高，缺点是传感器数据来源和标准不一、精度不够、政府门槛、技术门槛高。

# 相关技术

  高精度地图的生产过程中，涉及的关键技术主要集中在图像识别与处理、激光点云处理、同步定位与地图构建以及基于OTA技术的地图数据更新和传感器数据回传等。

## 道路元素图像处理

  高精度地图的制作需要运用图像处理将道路上的各种道路元素进行识别，并以此进行语义标注，如车道线检测、众包图像数据采集等。通常，道路元素包括如交通标志牌、红绿灯、车道线和隔离带等。在进行图像识别之前，由于光线、雨水、车速等环境影响，可能引入噪声或使图像失真，因此，首先需要对图像进行降噪和增强等提高图像质量的预处理。然后，利用这些道路元素的颜色、位置和大小等信息通过深度学习模型提取特征，再基于这些特征进行识别并分类，完成语义的标注。
  目前主流的基于深度学习的图像识别算法有Fast R-CNN、Faster-RCNN、R-CNN、OHEM、Mask R-CNN、SqueezeNet、Yolov 3。

## 激光点云处理

  在自动驾驶车辆使用的高精度地图的制作中，激光点云处理的通常做法是：利用激光雷达扫描获取激光点云数据，重建三维的道路环境，并利用重建好的三维环境进行道路要素特征的提取与识别，准确地反映道路环境并描述其道路环境特征，得到高精度点云地图。同时，其处理后的激光点云数据能够与图像数据进行映射或融合处理，得到信息更加丰富的彩色激光点云地图，为人工检测与修订提供充分的数据基础。
  常用的激光点云处理技术有激光点云特征提取、激光点云法向量、激光点云配准、激光点云分割等。激光点云特征提取的作用是对采集得到的点集数据特征提取，提取得到的点特征所表示的特征向量应具有平移旋转不变性、抗密度干扰性以及抗噪声稳定性等特点；激光点云法向量的作用是建立各采样点坐标间的关联关系，并进行有效的描述；激光点云配准的作用是将各个视角下采集到的含有误差的激光点云通过旋转平移，消除误差并统一到同一坐标系下，还原道路的三维环境；激光点云切割的作用是根据激光点云表现出的几何形状、特征等方面进行有效分割，提取物体的激光点云，接下来，利用算法进行分类和识别，并对道路元素添加其语义信息。

## 同步定位与地图构建

  在GNSS信号薄弱或丢失的情况下，无法使用常规手段进行高精度地图的构建以及自动驾驶汽车的定位。作为不依赖GNSS信号的技术，同步定位与地图构建（Simultaneous Localization And Mapping，SLAM）可在这些特殊场景下辅助开展工作。SLAM是指汽车从未知环境的未知地点出发，在运动过程中通过反复观测到环境特征定位自身位置和姿态，再根据自身位置构建周围环境的地图，从而达到同时定位和地图构建的目的（扫地机器人就是此原理）。
  SLAM有两种实现形式：一种是以激光雷达为主的激光SLAM；另一种是以摄像头为主的视觉SLAM。激光SLAM主要通过激光雷达获取自动驾驶汽车周围环境的激光点云数据，激光雷达能以很高的精度测量出汽车周围物体的角度和距离，从而很方便地实现SLAM及避障等功能。视觉SLAM主要是通过摄像头采集的数据进行同步定位与地图构建。视觉传感器采集的图像数据要比激光雷达得到的信息丰富，所以更加利于后期的处理。

## OTA服务

  空中下载技术（OTA,Over The Air Technology）是通过移动通信（GSM,CDMA等）网络空中接口对数据及应用进行远程管理的技术。对于汽车行业来说，OTA分为三类：固件在线升级（FOTA，Firmware Over the Air），指的是通过空中接口给电子控制单元（ECU）等车载设备下载完整的固件镜像，或修补现有固件、更新闪存；应用软件在线升级（SOTA，Software Over the Air），指的是通过空中接口来更新升级应用程序（车载APP）；应用数据在线升级（DOTA，Data Over the Air），指的是通过空中接口来更新应用程序中的基础数据（例如地图数据）。

## 传感器数据回传及更新

  基于OTA衍生出的传感器数据回传与更新技术可将终端采集的数据（包括车端状态、道路、路面标志灯）回传到云端，在云端进行数据预处理、数据规格化、数据生产加工和数据发布。通过该技术，地图的更新过程形成云端到终端的数据闭环，提升了高精度地图数据的准度和鲜度。
  传感器数据回传的内容包括APP运行数据、汽车状态数据、车身传感器数据以及地图采集数据四大类。具体来说，APP运行数据是指APP的运行日志、崩溃日志、API调用日志等信息；汽车状态数据是指汽车的定位数据、速度、航向和数据置信度等信息；车身传感器数据是指通过传感器获取的雨刷速度、电量、胎压和车内温度等数据；地图采集数据是指传感器结合高精度地图所采集到的图像、视频以及识别出的结构化数据等。