- [基于封闭办公园区的自动驾驶场景分析 - 科学猫 (scicat.cn)](http://www.scicat.cn/mm/20220317/187871.html)

![img](http://img.scicat.cn/d/file/20220317/19383950615c2bbeac7530f038b7441a.jpg)

![img](http://img.scicat.cn/d/file/20220317/47917f12a1aacf7eb8c7c27c82b1df92.jpg)

摘 要：目前，自动驾驶汽车逐渐商用于封闭办公园区，如物流车、观光车。自动驾驶汽车的开发验证需要大量的实车道路测试，实车道路测试存在成本高、周期长、无法复现极端场景，因此基于封闭办公园区场景的仿真测试是解决自动驾驶开发验证的主要途径。为真实还原物流车、观光车等自动驾驶汽车的行驶环境，本文基于封闭办公园区的道路特征，并结合相关标准整理并分析得出适用于封闭办公园区的自动驾驶汽车功能，梳理出适用于封闭办公园区的测试用例，并通过控制器在环方式验证。试验表明该测试用例能够基本满足自动驾驶控制器的测试需求。

关键词：封闭办公园区;道路特征;自动驾驶

中图分类号：U463.5   文献标识码：A   文章编号：1005-2550（2021）05-0059-07

Analysis of Autonomous Driving Scenarios Based on

Closed Office Parks

WANG Shi-kun， SU Rui-qi， ZHANG Jun-ying， HUANG Bo

（ Xiangyang Motor Automobile Testing Center CO.LTD， Xiangyang 441004， China）

Abstract： At present， Autonomous vehicles are gradually being used in closed office parks， such as logistics vehicles and sightseeing vehicles. The development and verification of autonomous vehicles requires a large number of real-vehicle road tests. Real-vehicle road tests have high costs， long cycles， and extreme scenarios that cannot be reproduced. Therefore， simulation testing based on closed office park scenarios is the main way to solve autonomous driving development verification. In order to truly restore the driving environment of autonomous vehicles such as logistics vehicles and sightseeing vehicles， this article is based on the road characteristics of closed office parks， and combined with relevant standards to sort out and analyze the functions of autonomous vehicles suitable for closed office parks. The test cases of the office park are verified by the controller-in-the-loop method. The test shows that the test case can basically meet the test requirements of the autopilot controller unit.

自動驾驶汽车成为行业的新热点，如何提升测试效率、精进技术，成为行业内迫切需要解决的问题。此时，虚拟仿真测试的重要性就体现出来了，成为了自动驾驶汽车商业化应用前不可缺少的环节。仿真测试与实车道路测试相比具有测试效率高、成本低、周期短等优点。目前，逐渐商用的自动驾驶汽车主要应用于封闭园区，因此通过搭建典型的封闭办公园区场景，高度还原真实中典型场景、极端场景，对自动驾驶汽车的开发测试具有现实意义。本研究立足于国内自动驾驶的主要测试标准，并以中国封闭办公园区的典型场景作为研究对象，在仿真环境中高度还原中国典型封闭办公场景，梳理出适用于封闭办公园区的测试用例，为应用于封闭办公园区的物流车、观光车等自动驾驶汽车开发设计验证提供参考和支撑。

## 1  自动驾驶汽车仿真测试

随着自动驾驶技术的不断发展，自动驾驶汽车逐渐商业化，如物流车、无人售卖车、观光车等。由于自动驾驶汽车复杂多样的功能直接关系到用户生命与财产安全，在投入使用之前，如何测试和验证其功能和性能是整车厂极其关注的。传统的实车测试在试验成本、试验周期、安全性等方面满足不了自动驾驶汽车复杂功能的开发验证需求。

2020年2月24日，发改委、工信部等11个国家部委联合出台了《智能汽车创新发展战略》（以下简称《战略》），建立健全智能汽车测试评价体系重点研发虚拟仿真、软硬件结合仿真等测评技术，开展特定区域智能汽车测试运行及示范应用等。可见，仿真测试验证已成为智能网联汽车功能开发、技术验证以及认知提升中不可或缺的环节，可以有效加速技术研发进场与产业化步伐。

在2019年世界智能网联汽车大会中发布的《北京市自动驾驶模拟仿真测试平台要求》，主要用于指导智能网联汽车以及自动驾驶车辆模拟测试平台进行规范化建设。标准的目的是引导智能网联仿真测试行业进行规范化建设，完善仿真测试能力，能够更加合理准确地对车辆或者自动驾驶系统的能力进行检测评估，推动自动驾驶技术加快示范运行和商业落地。智能网联仿真已成为智能网联汽车评价的基准之一，是智能网联汽车测试验证中不可缺失的一环。

仿真测试，建立静态道路场景、动态交通场景，可以将真实传感器、控制器深度集成在仿真环境中，让自动驾驶汽车在虚拟的道路场景中进行测试。仿真测试的具有持续性和可回归性的特点，可以对某些测试场景进行重复性测试，这样更容易发现与定位问题，问题解决后的回归性测试，能大大提高自动驾驶汽车开发验证效率等。

## 2  封闭办公园区的道路特征

遍布全国的测试场，为自动驾驶汽车的大规模测试提供了有利条件，但随着测试场规模的扩大，测试场规划设计的同质性也逐渐显露，且不适用主要应用于封闭园区的自动驾驶汽车，如终端物流车、观光车等。在满足基本测试要求的基础上，真实还原典型的封闭办公园区场景，扩大适用于封闭办公园区场景覆盖范围，以适应更加复杂多变的国内办公园区的道路交通环境。

封闭办公园区的道路总体特征是：基础道路环境简单、道路结构化程度高、路口的曲率半径较小。应用于封闭办公园区的自动驾驶汽车，一般为观光车、物流车等，行驶路线固定，速度一般在30km/h以内。

### 2.1  典型横断面

封闭办公园区的横断面比较单一，几乎都是单幅路，以简单图示的方式表示易于理解，同时总结该典型断面形式的特点以及该断面形式在实际情况中存在的问题，具体情况如下：

特点：

（1）无非动车道，非动车利用机动车道或人行道（若有）通行;

（2）相向机动车流存在对向干扰，机动车的行驶速度较低;

在封闭办公园区中，一般都为双向两车道，单向车道宽为3.2米以内，部分主干道可能存在3.75～4米路宽;封闭办公园区车辆构成有小汽车、自行车、电动车、三轮电动车，各种车辆混行在机动车道，同时存在行人在机动车道上与各种车辆混行;因此在设置封闭办公园区的场景时，应结合实际情况，充分考虑可能出现的情况，将相关元素加入到场景中去，如对向车道行驶在本车道上、多个行人行走在机动车道上、自行车/电动车/行人混合交通流。

有些双向两车道还设有路面停车位，那么停车位处车辆的行驶情况也会对测试车辆产生影响，所以也应该考虑将这一情况的测试场景。

### 2.2  弯道

在弯道行驶中，只能看到一部分弯道线形;受弯道周围景观等因素影响，驾驶员难以看到障碍物遮挡的弯道线形。由于车辆需要继续向前行驶，因而可能产生安全隐患造成事故的发生;封闭办公园区的弯道一般为双向两车道，同时存在单向弯道。弯道曲率半径较小。多为40～90米。弯道旁边的植物繁茂，降低自动驾驶汽车探测目标的能力，无法预先识别前方行人、障碍物等。在实际情况中应考虑在弯道行驶中行人横穿马路，车辆紧急制动的场景。

### 2.3  平面交叉口

平面交叉路口时一个具有很大挑战性的交通场景，也是非常容易发生交通事故的地方，因此车辆通行平面交叉口的测试也是相当值得关注的一个点。 封闭办公园区平面交叉路口的形式较为固定，主要有十字形、X形、T形，同时也存在一些错位交叉路口。路口的曲率半径较小，多为5～9米。具体形式如下简图所示：

#### 2.3.1 有信号灯控制的交叉口

对于有交通信号灯的平面交叉口来说，自动驾驶汽车在经过路口，作出驾驶行为时，一定要遵守的就是交通规则，那么自动驾驶汽车首先要识别的就是交通灯，根据交通灯的显示来选择下一步动作。对于封闭办公园区的交叉路口来说，一般都为双向两车道。交叉口的交通灯时序简单，当前车道的交通灯可同时控制当前车道和对向车道车辆的左转和直行，这就会存在冲突点，例如，当前车道车辆直行，对向车辆左转;封闭办公园区中存在交叉口无人行横道灯或有人行横道灯但行人闯红灯。道路中应考虑人车路三要素，在实际情况中考虑自动驾驶车辆与其他车辆/行人存在的冲突点。

#### 2.3.2 无信号灯控制的交叉口

面临无交通信号灯的交叉口时，人开车都需要小心翼翼地试探。对于自动驾驶车辆来说，交叉口可能存在建筑物或植物等遮挡，感知系统可能无法检测到其他车辆，因此自动驾驶汽车在无信号灯路口的通行更是仿真测试关注的一个点。因此在搭建场景时，更应考虑自动驾驶汽车与周围车辆/行人的冲突点，甚至多个车辆/行人存在冲突。

### 2.4  交通设施

结合《道路交通标志和标线》（GB 5768）进行标志标线的分析，有助构建适用于封闭办公园区场景的设施要素。

#### 2.4.1 交通标志

GB 5768中规定共包含7类主标志和1类辅助标志，包括禁令标志、旅游标志、指路标志、警告标志、作业标志、指示标志和告示标志，其中具备法理性的主要是禁令和指示标志。禁止和指示标志主要是禁止或限制、指示车辆交通行为的标志。由于封闭办公园区的道路特征有外部道路有明显区别，因此GB 5768标准中并非所有的禁令和指示标志适用于封闭办公园区。例如，封闭办公园区的车速一般在30km/h以内，因此仅需30 km/h限速牌即可，同时指示标识中的路面指示箭头，如左转、直行、右转箭头等，其尺寸应按照标准中0-40km/h的尺寸规范。结合封闭办公园区的道路特征，分析整理出适用于封闭办公园区的交通标志，具体见下表：

#### 2.4.2 交通标线

同理，结合封闭办公园区的典型道路特征，分析整理出适用于封闭办公园区的交通标志。详见表2：

对于自动驾驶汽车，必须识别和理解交通标志和标线，从而遵守交通法规。交通标识自动检测和有效识别能力是开发人员所关注的。在真实的封闭办公园区中，交通标识和标线会出现褪色、遮挡、破损等，因此在仿真环境应该覆盖该工况，并尽可能地包含實车测试难以达到的工况。虚拟场景中仿真自动驾驶汽车检测和识别交通标识和标识，以及在恶劣天气下（雨、雪、雾等）的识别具有非常重要的现实意义。

根据封闭办公园区的典型道路特征，在场景仿真软件搭建虚拟道路场景，部分如下图所示：

## 3  适用于办公园区的自动驾驶功能

应用于封闭办公园区的自动驾驶车辆在行驶在指定场景下，能够全方位的掌控周围环境，遵守交通规则，及时有效地对交通环境作出反应。参考汽标委发布的《智能网联汽车自动驾驶功能测试规程（试行）》，并结合封闭办公园区的典型特点，如车速较低、同向仅单车道等特点，整理出适用于封闭办公园区的自动驾驶功能。见表3：

## 4  测试用例大类

将以上整理出的封闭办公园区道路特征和交通标识作为测试用例的静态元素，车辆和行人的动作作为测试用例的动态元素。结合已梳理出的自动驾驶功能，整理出适用于封闭办公园区的测试用例，如下表4所示。

## 5  控制器验证

为验证上述测试用例，本文选用HIL的自动驾驶软硬件平台，并基于封闭办公园区的道路场景，以控制器在环的方式进行控制器的功能验证，测试自动驾驶控制器目标感知、目标响应、ODD范围识别、遵守道路交通规则，软硬件平台如图7所示。其中，HIL平台集成了实时处理系统、程控电源、以太网交换机，运行仿真模型搭建工具MATLAB/Simulink、车辆动力软件Vedyna、试验管理软件Veristand。自动化测试平台运行自动化测试管理软件TAE，实现测试序列的自动化执行。交通场景仿真软件VTD运行虚拟交通场景，并根据真实传感器的参数搭建虚拟传感器模型，并将场景中的目标数据传输至待测控制器中，待测控制器进行决策后将加速、减速、转向等控制器指令发送到车辆动力学Vedyna来控制车辆在交通仿真软件VTD中的运动轨迹，从而实现对控制器在环测试。

本文以行人横穿为例，仿真环境中，虚拟车辆以20km/h的匀速行驶，前方行人以设定的轨迹、速度进行横穿。主要测试步骤如下：

首先，自动驾驶控制器的功能验证需要场景作为支撑，根据上述章节梳理的封闭办公园区场景，在交通环境仿真软件VTD进行搭建，添加气象条件、动态要素（如车辆、行人等）和触发条件等，形成可用来测试的用例;

在交通仿真软件VTD中搭建虚拟传感器物理仿真模型，可根据真实传感器的参数设定。通过设定传感器的识别范围，可作为虚拟毫米波雷达;通过设定虚拟传感器的识别类型、畸变、FOV等可作为虚拟摄像头传感器;设置虚拟传感器的探测距离可作为虚拟超声波雷达传感器;采用激光雷达点云注入方式实现对激光雷达的仿真;最后根据真实传感器在实车上位置，在仿真环境中完成安装和标定。

Vedyna是专门针对实时仿真测试和离线研究使用的快速车辆动力学软件。根据控制器所在实车的整车参数，完成车辆动力学模型。如，通过设置迎风面积、环境车速、空气密度等完成空气阻力仿真;通过设置方向盘向角、转向比进行转向系统仿真等。

Veristand是HIL仿真测试系统的实时试验管理管理，通过仿真模型加载、加载通信协议DBC、将实时仿真模型下发到实时仿真处理系统，完成对试验的配置和监测。其试验结果如下：

根据场景动画及虚拟车辆的速度曲线图可以看出，车辆在靠近行人时，会减速至0m/s，待行人安全通过后，再启动并正常行驶。

## 6  总结

传统的基于里程和规则的测试方法需要向基于场景的测试验证方法转变。为提高自动驾驶汽车的开发验证效率，本文分析封闭办公园区的典型道路特征，并结合相关自动驾驶汽车测试标准，整理出应用于封闭办公园区自动驾驶汽车的测试用例。试验表明：该测试用例具有典型性、真实性，能够较好满足自动驾驶控制器仿真测试需求。

本文仅对单个测试用例（行人横穿）进行测试，未考虑恶劣天气状况。后续将用更多的测试用例测试该控制器。对智能网联汽车来说，最真实有效、最直接的测试车辆自动驾驶功能、性能的方法依旧是实车道路测试。虽已搭建典型的封闭办公园区场景，但道路的测试场景较复杂，不能全部列举出来，且真实道路测试不仅仅与单一交通车或行人进行交互，自动驾驶汽车应考虑多个测试用例组合起来，进行连续性场景测试。

参考文献：

[1]王平，李秋霞，王志刚，李秋晨.园区自动驾驶车辆测试方案设计与应用[J].时代汽车，2020：4-6.

[2]解瀚光，朱红儒，王阳，黄武陵.自动駕驶物流汽车技术及标准需求研究[J].中国汽车，2020：57-62.

[3]金楠.封闭园区自动驾驶横向控制系统设计与实现[D].西南交通大学，2019.

[4]陈套，蔡博，回春.基于场景元素的智能网联汽车场景构建研究[J].公路与汽运，2019，195：9-12.

[5]罗传东.基于HIL台架的LDW测试研究[J].汽车实用技术，2019，24：52-54.

[6]中国汽车标准委员会.《智能网联汽车自动驾驶功能测试规程（试行）》[S].