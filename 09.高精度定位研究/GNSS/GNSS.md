# 1 GNSS概述

根据后方交会定位原理，要实现 GNSS定位，需要解决两个问题:一是观测瞬间卫星的 空间位置；二是观测站点和卫星之间的距离，即卫星在某坐标系中的坐标。

为此首先要建 立适当的坐标系来表征卫星的参考位置[8]，而坐标又往往与时间联系在一起[9]，因此， GNSS定位是基于坐标系统和时间系统进行的。

# 2 坐标系统与时间系统 

卫星导航系统中，坐标系用于描述与研究卫星在其轨道上的运动、表达地面观测站的位 置以及处理定位观测数据。根据应用场合的不同，选用的坐标系也不相同。

坐标系统大概 分为以下几类:地理坐标系、惯性坐标系、地球坐标系、地心坐标系和参心坐标系。

国内常 用的坐标系统有:1954年北京54坐标系(Beijing54CoordinateSystem，P54)、1980年国家 大地坐标系(NationalGeodeticCoordinateSystem1980，C80)、1984年世界大地坐标系统 (WorldGeodeticSystem-1984CoordinateSystem，WGS-84)、2000国家大地坐标系(China GeodeticCoordinateSystem2000，CGCS2000)。 

时间系统在卫星导航中是最重要、最基本的物理量之一。

首先，高精度的原子钟控制卫 星发送的所有信号。

其次，在大多数卫星导航系统中，距离的测量都是通过精确测定信号传 播的时间来实现的。

时间系统主要包括世界时、历书时、力学时、原子时、协调世界时、儒略 日、卫星导航时间系统。

其中 GNSS采用了一个独立的时间系统作为导航定位计算的依 据，称为 GNSS时间系统，简称 GNSST。GNSST 属于原子时系统，其秒长与原子时秒长 相同。

# 3 定位原理 

GNSS的设计思想是将空间的人造卫星作为参照点，确定一个物体的空间位置。根据 几何学理论可以证明，通过精确测量地球上某个点到三颗人造卫星之间的距离，能对此点的 位置进行三角形的测定，这就是 GNSS最基本的设计思路及定位功能。 

![image-20220901110717376](https://www.lovebetterworld.com:8443/uploads/2022/09/01/63102244e2f8e.png)

假设地面测得某点P 到卫星S1 的距离为r1，那么从几何学可知，P 点所在的空间可能 位置集缩到这样一个球面上，此球面的球心为卫星S1，半径为r1。再假设测得P 点到第二 颗卫星S2 的距离为r2，同样意味着 P 点处于以第二颗卫星S2 为球心、半径为r2 的球面 上。

如果同时测得P 点到第三颗卫星S3 的距离为r3，意味着P 点也处于以第三颗卫星S3 为球心、半径为r3 的球面上，这样就可以确定 P 点的位置，也就是三个球面的交汇处，如图3-2所示。 从 GNSS进行定位的基本原理可以看出，GNSS定 位方法的实质，即测量学的空间后方交会。由于 GNSS 采用单程测距，且难以保证卫星钟与用户接收机钟的 严格同步，因此观测站和卫星之间的距离均受两种时 钟不同步的影响。卫星钟差可用导航电文中所给的有 关钟差参数进行修正，而接收机的钟差大多难以精准 确定，通常采用的优化做法是将其作为一个未知参数， 与观测站的坐标一并求解，即一般在一个观测站上需 求解4个未知参数(3 个点位坐标分量和一个钟差参 数)，因此至少需要4个同步伪距观测值，即需要同时观测4颗卫星。

根据用户站的运动状态可将 GNSS分为静态定位和动态定位。静态定位是将待定点 固定不变，将接收机安置在待定点上进行大量的重复观测。动态定位是指待定点处于运动 状态，测定待定点在各观测时刻运动中的点位坐标，以及运动载体的状态参数，如速度、时间 和方位等。此外，还可以根据定位模式分为绝对定位和相对定位。绝对定位只用一台接收 机来进行定位，又称作单点定位，它所确定的是接收机天线在坐标系统中的绝对位置。相对 定位是指将两台接收机安置于两个固定不变的待定点上，或将一个点固定于已知点上，另一 个点作为流动待定点，经过一段时间的同步观测，可以确定两个点之间的相对位置，从而获 得高精度的位置坐标。

# 4 GNSS数据误差 

卫星导航系统的误差从来源上可以分为4类:与信号传播有关的误差、与卫星有关的 误差、与接收机有关的误差以及与地球转动有关的误差[11]。 

与信号传播有关的误差包括电离层延迟误差、对流层延迟误差及多径效应误差。与卫 星有关的误差包括卫星星历误差、卫星时钟误差、相对论效应等。与接收机有关的误差包括 接收机时钟误差、(接收机天线相位中心相对于测站标识中心的)位置误差和天线相位中心 位置的偏差。与地球转动有关的误差包括来自地球潮汐、地球自转的影响。

误差分类如 表3-1所示，下面列举几种常见误差进行说明。

![image-20220901110418753](https://www.lovebetterworld.com:8443/uploads/2022/09/01/6310224752e85.png)

## 4.1 电离层延迟误差 

电离层是处于地球上空50~1000km 高度的大气层。该大气层中的中性分子受太阳辐 射的影响发生电离，产生大量的正离子与电子。在电离层中，电磁波的传输速率与电子密度 有关。因此直接将真空中电磁波的传播速度乘以信号的传播时间得到的距离，很大可能与 卫星至接收机间的真实几何距离不相等，这两种距离上的偏差叫电离层延迟误差。

电离层 延迟误差是影响卫星定位的主要误差源之一，它引起的距离误差较大，一般在白天可以达到 15m 的误差，在夜晚则可以达到3m 的误差；并且在天顶方向引起的误差最大可达50m，水 平方向引起的误差最大可达150m。

针对电离层延迟误差的改进措施通常包括利用双频观测、利用电离层模型辅以修正和利用同步观测值求差。

## 4.2 多径效应误差 

接收机接收信号时，如果接收机周围物体所反射的信号也进入天线，并且与来自卫星的信号通过不同路径传播且于不同时间到达接收端，反射信号和来自卫星的直达信号相互叠 加干扰，使原本的信号失真或者产生错误，造成衰落[12]。这种由于多径信号传播所引起的 衰落被称作多径效应，也称多路径效应。

多径效应误差是卫星导航系统中一种主要的误差源，可造成卫星定位精确度的损害，严重时还将引起信号的失锁。改进措施通常包括将接收机天线安置在远离强发射面的环境、选择抗多径天线、适当延长观测时间、降低周期性影响、 改进接收机的电路设计、改进抗多径信号处理和自适应抵消技术。 

## 4.3 卫星星历误差 

由星历所给出的卫星位置与卫星实际位置之差称为卫星星历误差。卫星星历误差主要 由钟差、频偏、频漂等产生。针对卫星在运动中受到的多种摄动力的综合影响，对于目前的 技术来说，要求地面监测站实现准确、可靠地测出这些作用力，并掌握其作用规律是比较困 难的，因此卫星星历误差的估计和处理尤为关键。

改进措施通常包括忽略轨道误差、通过轨 道改进法处理观测数据、采用精密星历和同步观测值求差。

# 5 差分 GNSS定位技术 

减少甚至消除3.1.3节所提到的误差是提高定位精度的措施之一，而差分GNSS可有效利用已知位置的基准站将公共误差估算出来，通过相关的补偿算法削弱或消除部分误差， 从而提高定位精度。 

差分 GNSS的基本原理主要是在一定地域范围内设置一台或多台接收机，将一台已知精密坐标的接收机作为差分基准站，基准站连续接收 GNSS信号，与基准站已知的位置和距离数据进行比较，从而计算出差分校正量。然后，基准站就会将此差分校正量发送到其范 围内的流动站进行数据修正，从而减少甚至消除卫星时钟、卫星星历、电离层延迟与对流层 延迟所引起的误差，提高定位精度。 

流动站与差分基准站的距离直接影响差分 GNSS的效果，流动站与差分基准站的距离越近，两站点之间测量误差的相关性就越强，差分 GNSS系统性能就越好。 

根据差分校正的目标参量的不同，差分 GNSS主要分为位置差分、伪距差分和载波相 位差分。下面将简要介绍位置差分、伪距差分、载波相位差分。

## 5.1 位置差分 

位置差分系统如图3-3所示。

通过在已知坐标点的基准站上安装 GNSS接收机来对4 颗或4颗以上的卫星进行实时观测，便可以进行定位，得出当前基准站的坐标测量值。实际 上由于误差的存在，通过 GNSS接收机接收的消息解算(Solve)出来的坐标与基准站的已知坐标是不同的。

然后将坐标测量值与基准站实际坐标值的差值作为差分校正量。基准站利用数据链将所得的差分校正量发送给流动站，流动站利用接收到的差分校正量与自身GNSS接收机接收到的测量值进行坐标修改。位置差分是一种最简单的差分方法，其传输 的差分改正数少，计算简单，并且任何一种 GNSS接收机均可改装和组成这种差分系统。 

但由于流动站与基准站必须观测同一组卫星，因此位置差分法的应用范围受到距离上的限 制，通常流动站与基准站间距离不超过100km。

![image-20220901110525865](https://www.lovebetterworld.com:8443/uploads/2022/09/01/6310224a3ece2.png)

## 5.2 伪距差分 

如图3-4所示，伪距差分技术是在一定范围的定位区域内，设置一个或多个安装 GNSS 接收机的已知点作为基准站，连续跟踪、观测所有在信号接收范围内的 GNSS卫星伪距，通过在基准站上利用已知坐标求出卫星到基准站的真实几何距离，并将其与观测所得的伪距 比较，然后通过滤波器对此差值进行滤波并获得其伪距修正值。

接下来，基准站将所有的伪 距修正值发送给流动站，流动站利用这些误差值来改正 GNSS卫星传输测量伪距。

最后， 用户利用修正后的伪距进行定位。

伪距差分的基准站与流动站的测量误差与距离存在很强的相关性，故在一定区域范围内，流动站与基准站的距离越小，其使用 GNSS差分得到的定位精度就会越高。

![image-20220901110546969](https://www.lovebetterworld.com:8443/uploads/2022/09/01/6310224d0779a.png)

## 5.3 载波相位差分 

GNSS位置差分技术与伪距差分技术都能基本满足定位导航等的定位精度需求[13]，但应用在自动驾驶中还远远不够，因此需要更加精准的 GNSS差分技术，即载波相位差分技术。

载波相位实现差分的方法有修正法和差分法。

修正法与伪距差分类似，由基准站将载 波相位修正量发送给流动站，以改正其载波相位观测值，然后得到自身的坐标。

差分法是将基准站观测的载波相位测量值发送给流动站，使其自身求出差分修正量，从而实现差分定位。 

载波差分技术的根本是实时处理两个测站的载波相位。与其他差分技术相比，载波相位差分技术中基准站不直接传输关于 GNSS测量的差分校正量，而是发送 GNSS的测量原始值。流动站收到基准站的数据后，与自身观测卫星的数据组成相位差分观测值，利用组合后的测量值求出基线向量完成相对定位，进而推算出测量点的坐标。 

然而，在使用载波差分法进行相位测量时，每一个相位的观测值都包含有无法直接观测载波的未知整周期数，称为相位整周模糊度。如何正确确定相位整周模糊度是载波相位测量求解中最重要，也是最棘手的问题。求解相位整周模糊度分为有初始化方法和无初始化方法。前者要求具有初始化过程，即对流动站进行一定时间的固定观测，一般需要15min， 利用静态相对测量软件进行求解，得到每颗卫星的相位整周模糊度并固定此值，便于在以后的动态测量中将此相位整周模糊度作为已知量进行求解。后者虽然称作无初始化，但实际上仍需要时间较短的初始化过程，一般只需3~5min，随后快速求解相位整周模糊度。

因此两种求解相位整周模糊度的方法都需要具备初始化过程，并且在初始化后必须保持卫星信号不失锁，否则，就要回到起算点重新进行捕捉和锁定。 

RTK 是一种利用接收机实时观测卫星信号载波相位的技术，结合了数据通信技术与卫 星定位技术，采用实时解算和数据处理的方式，能够实现为流动站提供在指定坐标系中的实时三维坐标点，在极短的时间内实现高精度的位置定位。常用的 RTK 定位技术分为常规 RTK 和网络 RTK。 

### 5.3.1 常规 RTK 

常规 RTK 定位技术是一种基于 GNSS高精度载波相位观测值的实时动态差分定位技术，也可用于快速静态定位。

采用常规 RTK 进行定位工作时，除需配备基准站接收机和流动站接收机外，还需要数据通信设备，基准站通过数据链路将自己所获得的载波相位观测值及站坐标实时播发给在其周围工作的动态用户。

流动站数据处理模块则通过动态差分定位的方式，确定流动站相对于基准站的位置，并根据基准站的坐标得到自身的瞬时绝对位置。 常规 RTK 系统如图3-5所示。

![image-20220901110609289](https://www.lovebetterworld.com:8443/uploads/2022/09/01/6310224fc1dc8.png)

显然，常规 RTK 定位技术虽然可以满足很多应用的要求，但流动站与基准站的距离不能过远，当距离大于50km 时，常规 RTK 一般只能达到分米级的定位精度。

因此，常规 RTK 并不能完全满足自动驾驶系统对汽车、车道及障碍物的厘米级定位需求。 

### 5.3.1 网络 RTK 

#### 5.3.1.1 网络 RTK 原理

网络 RTK 也称多基准站 RTK。

网络 RTK 属于实时载波相位双差定位，是近年来一种基于常规 RTK 和差分 GNSS技术等发展起来的实时动态定位新技术。

网络 RTK 是指 在某一区域内由若干个固定的、连续运行的 GNSS基准站形成一个基准站网络，对区域内全方位覆盖，并以这些基准站中的一个或多个为基准，为该地区内的 GNSS用户实现实时、 高精度定位提供 GNSS误差改正信息。

网络 RTK 技术与常规 RTK 技术相比，覆盖范围更广，作业成本更低，定位精度更高，用户定位的初始化时间更短。

#### 5.3.1.2 网络 RTK 系统

网络 RTK 系统如图3-6所示。它是网络 RTK 技术的应用实例，主要包括固定的基准 站网、负责数据处理的控制中心部分、数据播发中心、数据链路和用户站。

其中基准站网由 若干个基准站组成，每个基准站都配备有双频全波长 GNSS接收机、数据通信设备和气象 仪器等。

通过长时间 GNSS 静态相对定位等方法可以精确得到基准站的坐标，基准站 GNSS接收机按一定采样率进行连续观测，通过数据链路将观测数据实时传送给数据处理中心，数据处理中心首先对各个站的数据进行预处理和质量分析，然后对整个基准站网的数据进行统一解算，实时估计出网内的各种系统误差的改正项(电离层、对流层和轨道误差)， 并建立误差模型。

![image-20220901110633284](https://www.lovebetterworld.com:8443/uploads/2022/09/01/63102251f1e7a.png)

根据通信方式的不同，可将网络 RTK 系统分为单向数据通信和双向数据通信。

在单向数据通信中，数据处理中心直接通过数据播发设备把误差参数广播出去，用户收到这些误 差改正参数后，根据自己的坐标和相应的误差改正模型计算出误差改正数，从而进行高精度定位。在双向数据通信中，数据处理中心对流动站的服务请求进行实时侦听，并接收来自流 动站的近似坐标，根据流动站的近似坐标和误差模型，求出流动站处的误差后，直接将改正数或者虚拟观测值播发给用户。基准站与数据处理中心间的数据通信可采用无线通信等方法进行。流动站和数据处理中心间的双向数据通信则可通过 V2X等车联网通信技术实现。