- [知乎盐选 | 车路协同 RSU 软件系统的设计与实现 (zhihu.com)](https://www.zhihu.com/market/paid_magazine/1488077202260992000/section/1488077322594549760?origin_label=search)

摘要：提出了一种车路协同路侧单元（RSU）软件系统的设计方案，论述了 RSU 在车路协同系统中的位置及功能，提出功能架构设计、系统架构设计、安全服务设计等若干需要解决的核心问题。详细阐述了解决这些问题用到的关键技术和设计方案，对车路协同系统进行测试，并在实际工程项目进行应用和功能验证，证明了该系统设计的可行性和合理性。

关键词：智能交通系统；车路协同；路侧单元；V2X

## 0 引言

在现实交通中，机动车保有量和道路交通量不断增加，路况随机性强，车辆、行人众多，亟需通过智能交通系统（ITS）建设提升道路交通系统的安全性和通行效率。车路协同系统作为智能交通的重要组成部分，在实时、可靠的全时空交通信息的基础上，实现车辆与道路设施的智能化和信息共享，保证交通安全、提高通行效率，在高速公路等领域具备广泛的应用前景[1]。车路协同技术正成为各国智能交通系统技术研发和落地应用的热点[2]。

车路协同是采用先进的无线通信和新一代互联网等技术，全方位实施车-车（V2V）、车-路（V2I）动态实时信息交互[3]。并在全时空动态交通信息采集与融合的基础上开展车辆主动安全控制和道路协同管理，充分实现人、车、路的有效协同，保证交通安全，提高通行效率，从而形成安全、高效和环保的道路交通系统。RSU 部署在路侧，实现路侧信息与车侧信息的实时交互，是车路协同系统的重要组成部分。

## 1 总体设计

车路协同通过 V2V、V2I、车-人（V2P）、车-网（V2N）等信息交互、共享[4]，使车和周围环境协同与配合，实现智能交通管理控制、车辆智能化控制和智能动态信息服务的一体化网络。

车路协同系统分为车载设备、路侧设备、平台层和业务层四部分。OBU 安装在车辆上，用于实现 V2X 通信，可实现本车与其他车辆 OBU、RSU、行人和车路协同平台的通信；RSU 利用摄像机、激光雷达、毫米波雷达、环境感知设备等多传感器信息融合数据，实现道路信息汇聚，并实现平台层与车载设备信息交互；平台层通过边缘计算和云平台实现信息实时处理和流程管理；业务层实现各种具体的应用功能。4 个部分共同合作实现车路协同系统功能，RSU 在车路协同系统中的位置如图 1 所示。

![img](https://pic1.zhimg.com/v2-32cbbca3789e050db6dda967573f4e9b.webp)

为了更好地为公众出行服务，车路协同重点关注提升出行安全和提高交通效率。中国汽车工程学会 T/CSAE 53-2017 发布的 17 种应用场景标准，包括碰撞预警、变道辅助等主动安全类场景，车速引导、限速预警等交通效率类场景，以及近场支付、信息回传等信息服务类场景[5]。

为实现车路协同各种场景服务，在路侧部署各种形态的通信设备 RSU，汇集路侧交通设施和道路交通参与者的信息，上传至车路协同平台，并将车路协同消息广播给道路交通参与者。RSU 需要具备多种通信方式，通过不同的传输方式进行消息传递，包括 LTE-V2X PC5 通信、LTE Uu 通信、5G Uu 通信，以及正在制定中的 5G-V2X PC5 通信等[6]，满足车路协同不同的应用场景对消息传递在传输时延、数据量等方面的需求。

## 2 需解决的问题

为了高效地完成车路协同 RSU 软件系统的设计与实现，需要解决以下几个问题：

① 功能架构：RSU 软件系统功能丰富，包括业务功能、管理功能、安全功能等，其中业务功能主要包括数据上传与下发、消息协议转换等。能否对系统功能进行详细分解，做到系统功能完备性、功能架构合理性，实现系统运行效率最大化，是 RSU 软件系统设计的重点。

② 系统结构：RSU 系统结构复杂，如何确定软件的总体结构和模块组成，并明确每个模块的逻辑结构、模块间的调用关系，以及每个模块的输入和输出，在保证模块独立性的同时，做到高内聚、低耦合，是设计时需要解决的一个重要问题。

③ 安全服务：车路协同作为国家智能汽车发展战略以及国家新基建的重要组成部分，涉及个人安全、公共安全乃至国家安全。如何保证车路协同不同厂家、不同设备之间的互通互认，保障车路协同通信安全，是设计时需要解决的又一重要问题。

## 3 设计实现

### 3.1 功能架构设计

为了实现车路协同系统整体功能支撑，RSU 结合功能需求和特点，对系统功能进行了分类定义，在大的功能模块基础上又细分为小的功能模块，多层次进行划分，保证了系统功能的完备性和功能架构的合理性。RSU 软件功能架构如图 2 所示。

RSU 软件系统划分为 6 个功能模块：

①MQTT 功能：包括订阅客户端和发布客户端，负责接收云平台的配置操作，并完成设备心跳及环境数据的上报。

② 操作管理：负责云端数据格式解析功能及消息中转，负责告警信息、状态信息、统计信息的收集及上报，负责配置管理维护。

③ 消息下发：按照平台配置的管理策略触发 RSI、MAP 消息定时下发功能，负责 RSM、SPAT 消息接口转换及实时下发；负责 BSM 消息的封装及平台上报。

④V2X 协议栈：实现消息层数据的 ASN.1 编解码、网络层协议格式的封装解封装、网络层 DME 管理功能，以及 V2X 模组的无线数据收发功能。

⑤ 安全功能：包括证书的管理维护功能、数据的签名验签、数据加解密以及其他系统安全功能。

⑥ 单元测试：实现 RSU 软件的单元测试功能。

![img](https://pica.zhimg.com/v2-af4ab915cf7325c32f97e15abdcd4f09.webp)

通过上述功能架构设计，对 RSU 系统功能进行模块划分和定义，保证 RSU 系统功能架构的合理性和完整性。

### 3.2 系统结构设计

RSU 系统软件需要实现数据传输、消息适配、业务应用等功能，其中每部分功能实现需要多个模块共同完成。为了适应上述要求，在明确每个功能模块的逻辑结构、相互间调用关系的基础上，RSU 软件系统建立了如图 3 所示的 RSU 系统结构。

![img](https://pica.zhimg.com/v2-7d07b82ed99f3dcbc2bc240a4f2047f5.webp)

RSU 系统结构分为应用层、消息层、网络层和设备驱动层 4 个部分。

① 应用层：负责处理业务逻辑，实现消息的收发、对接云端管理接口、定时逻辑及实时下发，故障信息、状态信息、统计信息和环境信息的收集上报，以及应用层数据的安全，与车路协同系统平台层通过 MQTT 协议进行通信，与消息层通过函数调用的方式进行通信。

② 消息层：负责数据编解码，依赖网络层数据实现应用消息的 ANS.1 编解码，与网络层通过消息队列的方式进行通信。

③ 网络层：遵循直连通信短消息协议实现网络层数据收发，与设备驱动层通过 UDP 套接字进行通信。

④ 设备驱动层：通过 C-V2X 蜂窝移动通信技术、短距离无线通信技术、有线网络传输实现 UU/PC5/有线的网络通信底层驱动功能，可直接操作底层硬件设备。

通过上述系统结构设计，成功将 RSU 系统进行分层，可以保证上层控制和路侧终端消息的传输，不论空口或有线传输的消息，都能快速、准确地进行适配和转发，从而进行相应的处理，保证信息处理的实时性和有效性。

### 3.3 安全服务设计

车路协同面临着假冒网络、信息窃取、假冒终端、虚假信息及隐私泄露等安全风险。鉴于车路协同通信安全的重要性，以及空口数据传输的不稳定性，车路协同系统需要具备设备认证、信息完整校验、隐私保护、机密保护等安全能力。

车路协同是相互没有关系的设备之间进行随机通信，RSU 安全通信采用业界共识的基于 PKI 的安全机制实现车路协同设备之间的认证和通信安全。相关设备需要根据实际场景对接收到的信息提供安全服务，保证车路协同通信安全。

RSU 安全通信服务架构如图 4 所示，由安全数据处理功能、安全凭证管理功能、安全服务功能等构成[7]。

![img](https://pica.zhimg.com/v2-9d705b0e4341d7d7c97917015ee041d5.webp)

① 安全数据处理功能（SDPF）

SDPF 位于 RSU 的车路协同应用服务实体中，负责基于特定的车路协同应用逻辑生成与处理安全消息，包括明文消息、签名消息、加密消息等。SDPF 根据需要调用安全服务功能提供的基本安全服务。

② 安全凭证管理功能（SCMF）

SCMF 负责与车路协同 SCME 交互获得相关的公钥证书和安全凭证、数据。SCMF 需要与安全服务功能交互完成安全凭证和数据（例如公钥证书和 CRL）的导入和导出，以及密钥的生成和导出等处理。

③ 安全服务功能（SSF）

SSF 负责提供安全凭证和安全数据的存储和密码运算服务，通过 API 对外提供安全服务。SSF 负责处理安全协议数据单元（SPDUs），并通过生成和处理 SPDU 为 RSU 设备提供签名、验签、加密和解密等安全服务。

通过上述设计，RSU 设备能够实现对假冒终端、虚假信息的丢弃，保证信息传递机密性性，避免信息泄露，实现车路协同设备间的通信安全。

## 4 设计验证

RSU 通过将车路协同系统作为一个整体进行系统集成测试完成实验室功能验证。经过实验室验证测试后，在新元高速 5 km 车路协同示范路段安装部署 RSU 并进行了实际工程项目的测试验证。新元高速车路协同系统拓扑如图 5 所示。

通过测试，RSU 在安装高度为 7 m，数据包为 400 byte，发送频率为 10 Hz，零丢包率情况下实际覆盖半径大于 500 m，时延小于 25 ms，能够正确、实时处理 OBU 发送的车辆信息，路侧摄像机、激光雷达、毫米波雷达、环境感知设备等发送的传感器信息，以及平台层发送的信息实时处理和流程管理信息，未出现异常，满足标准及设计要求，行驶场景提醒准确，可辅助车辆驾驶和交通管理，提升出行的安全性。测试和应用证明 RSU 能够实现设计所需的功能及车路协同系统要求，其设计及实现是正确的。

![img](https://pic3.zhimg.com/v2-52d7f815a4ff16ff695e3417e7a06b7e.webp)

## 5 结束语

参考其他通信系统设备的设计思想，并充分结合车路协同系统的特点，实现了车路协同 RSU 软件系统的功能架构、系统结构、安全服务等设计，结构合理、思路清晰，测试结果真实地反映了其在实际环境下的性能，可以满足系统部署的需要。目前，该设计实现已被应用于实践开发，对于同类开发或研究都具有参考价值。

参考文献

[1]孟永帅.高速公路车路协同技术应用探讨[J].交通世界，2021（13）：7-8，12.

[2]宋蒙，刘琪，许幸荣，等.C-V2X 技术在智能网联行业中应用探讨[J].中兴通讯技术，2020，26 （1）：60-63.

[3]汪林，李赵，詹鹏宇.基于 IEEE802.11p 的车路协同系统设计[J].工业控制计算机.2017，30（8）：1-2.

[4]和福建，田晓笛，王长园.车联网发展现状及趋势研究[J].中国汽车，2019（4）：55-58.

[5]南洋，董馨，陈博，等.C-V2X 技术在智能网联汽车上的应用场景研究[J].汽车文摘，2019 （9）：8-12.

[6]中国信息通信研究院.车联网白皮书： C-V2X 分册[EB/OL].（2019-12-26） [2020-03-11].http：//www.caict.ac.cn/kxyj/qwfb/bps/202001/t20200102_273007.html.

[7]周巍，朱雪田，夏旭.面向 5G 的车联网安全业务研究[J].电子技术应用，2019，45（12）：34-37.